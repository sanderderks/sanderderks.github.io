import{_ as H,a as ne}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-C6J-GyL9.js";import{D as v}from"./c-DateField-CWvNIfkF.js";import{_ as ie}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-DbzAxtwG.js";import{_ as x}from"./c-SelectField.vue_vue_type_script_setup_true_lang-BanvuRMQ.js";import{_ as y}from"./c-TextField.vue_vue_type_script_setup_true_lang-aj-wueri.js";import{e as Y,r as o,c as D,l as F,m as de,n as l,k as i,p as m,h as se,av as ue,s as J,a as me,M as ve,q as P,D as u,aw as ge,ax as fe,t as Q,ay as Ve,y as De,H as we,az as be,aF as pe,b as ce}from"../bundle.js";import{R as U}from"./c-validation-DokkLKHB.js";import{s as c,a as X}from"./c-accordiontab.esm-CX-DBziB.js";import{_ as Z}from"./c-Bubble.vue_vue_type_script_setup_true_lang-BShtm6_i.js";import{D as ye}from"./c-vuedraggable.umd-CzRFyTns.js";const Fe={class:"md:px-5"},Ue={class:"mt-3 flex justify-evenly font-bold"},ke=Y({__name:"PetLogDialogSection",props:{id:{},log:{}},emits:["error","delete"],setup(B,{expose:k,emit:s}){const w=s,b=o(),g=o(),f=o(),V=o(),h=D(()=>[f.value,V.value].some(e=>!!e));return k({test:async()=>{var e,n;await Promise.all([(e=b.value)==null?void 0:e.test(),(n=g.value)==null?void 0:n.test()]),w("error",h.value)}}),(e,n)=>(F(),de("div",Fe,[l(v,{ref_key:"dateField",ref:b,id:e.id,name:"logDate",label:"Date",modelValue:e.log.date,"onUpdate:modelValue":n[0]||(n[0]=d=>e.log.date=d),error:f.value,"onUpdate:error":n[1]||(n[1]=d=>f.value=d),"without-time":""},null,8,["id","modelValue","error"]),l(y,{ref_key:"weightField",ref:g,id:e.id,name:"logWeight",label:"Weight (kg)","model-value":`${e.log.weight}`,"onUpdate:modelValue":n[2]||(n[2]=d=>e.log.weight=Number(d)),error:V.value,"onUpdate:error":n[3]||(n[3]=d=>V.value=d),rules:[i(U).Required,i(U).Numeric],"min-value":0,"input-props":{type:"number"}},null,8,["id","model-value","error","rules"]),m("div",Ue,[l(Z,{class:"w-full sm:w-2/3 md:w-1/2 xl:w-2/3",type:"danger",outlined:"",label:"Delete",onClick:n[4]||(n[4]=d=>e.$emit("delete"))})])]))}}),he={class:"pt-6 mb-4 xl:px-16"},Ce={class:"flex gap-5"},Se={class:"mt-3 flex justify-center"},xe={class:"basis-full lg:basis-1/2"},je=Y({__name:"PetDialog",props:{isOpen:{type:Boolean},originalPet:{}},emits:["close"],setup(B,{emit:k}){const s=B,w=k,b=se(),g=ue(),{isMutationLoading:f}=J(g),{firebaseUser:V}=J(b),{mutatePet:h}=g,C=r=>({name:{value:(r==null?void 0:r.name)??"",error:""},avatar:{value:(r==null?void 0:r.avatar)??"",error:""},dateOfBirth:{value:r!=null&&r.dateOfBirth?new Date(r.dateOfBirth):null,error:""},type:{value:(r==null?void 0:r.type)??"cat",error:""},breed:{value:(r==null?void 0:r.breed)??"",error:""},breedSize:{value:(r==null?void 0:r.breedSize)??"medium",error:""},gender:{value:(r==null?void 0:r.gender)??"male",error:""},weight:{value:r!=null&&r.weight?r.weight.toString():"",error:""},insideCat:{value:(r==null?void 0:r.insideCat)??!1,error:""},castrated:{value:(r==null?void 0:r.castrated)??!1,error:""},dewormingDate:{value:r!=null&&r.dewormingDate?new Date(r.dewormingDate):null,error:""},vetDate:{value:r!=null&&r.vetDate?new Date(r.vetDate):null,error:""},lastVaccinationDate:{value:r!=null&&r.lastVaccinationDate?new Date(r.lastVaccinationDate):null,error:""},nextVaccinationDate:{value:r!=null&&r.nextVaccinationDate?new Date(r.nextVaccinationDate):null,error:""},weightLog:{value:r!=null&&r.weightLog?r.weightLog.map(a=>({...a,date:new Date(a.date)})):[],error:{}}}),e=me(C(s.originalPet)),n=D(()=>{var r,a;return{name:e.name.value,userId:((r=s.originalPet)==null?void 0:r.userId)??((a=V.value)==null?void 0:a.uid)??"",avatar:e.avatar.value,dateOfBirth:e.dateOfBirth.value??null,type:e.type.value,breed:e.breed.value,breedSize:e.breedSize.value,gender:e.gender.value,weight:isNaN(+e.weight.value)?null:+e.weight.value,insideCat:e.type.value==="cat"?e.insideCat.value:null,castrated:e.castrated.value,dewormingDate:e.dewormingDate.value??null,vetDate:e.vetDate.value??null,lastVaccinationDate:e.lastVaccinationDate.value??null,nextVaccinationDate:e.nextVaccinationDate.value??null,weightLog:e.weightLog.value}}),d=o(),O=o(),L=o(),z=o(),$=o(),N=o(),E=o(),I=o(),R=o(),j=o(),q=o(),M=o(),A=o(),G=o(),_=o([]),S=D(()=>s.originalPet?pe.convert(s.originalPet):null),K=D(()=>!ce(S.value,n.value)),T=D(()=>{if(e.name.value)return e.name.value;switch(e.type.value){case"cat":return"Cat";case"dog":return"Dog";default:return"Pet"}}),ee=async()=>{var r,a,t;await Promise.all([d.value.test(),O.value.test(),L.value.test(),z.value.test(),$.value.test(),(r=N.value)==null?void 0:r.test(),E.value.test(),I.value.test(),(a=R.value)==null?void 0:a.test(),j.value.test(),q.value.test(),A.value.test(),G.value.test(),M.value.test()]),!(e.name.error||e.avatar.error||e.dateOfBirth.error||e.type.error||e.breed.error||e.breedSize.error||e.gender.error||e.weight.error||e.insideCat.error||e.castrated.error||e.dewormingDate.error||e.vetDate.error||e.lastVaccinationDate.error||e.nextVaccinationDate.error)&&(await h(n.value,(t=s.originalPet)==null?void 0:t.id),w("close"))},ae=()=>{e.weightLog.value.push({date:new Date,weight:0})},W=r=>e.weightLog.value.findIndex(a=>a.date.toString()===r),re=r=>{e.weightLog.value.splice(W(r),1)},te=(r,a)=>{e.weightLog.error[W(a)]=r},le=()=>{w("close")};return ve(()=>[s.isOpen,s.originalPet],()=>{Object.assign(e,C(s.originalPet))}),(r,a)=>(F(),P(ne,{isOpen:r.isOpen,title:S.value?"Update Pet":"Create Pet",description:"Keep in mind that pet data is visible to all authenticated users.","confirm-text":S.value?K.value?"Update":"Nothing changed":"Create","confirm-loading":i(f),"confirm-props":{disabled:!K.value},onConfirm:ee,onCancel:le},{default:u(()=>[m("form",he,[l(y,{ref_key:"nameField",ref:d,id:"name",name:"name",label:"Name",placeholder:"Mogu",modelValue:e.name.value,"onUpdate:modelValue":a[0]||(a[0]=t=>e.name.value=t),error:e.name.error,"onUpdate:error":a[1]||(a[1]=t=>e.name.error=t),rules:[i(U).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),l(i(X),null,{default:u(()=>[l(i(c),{header:`${T.value}'s Details`},{default:u(()=>[l(v,{ref_key:"dateOfBirthField",ref:L,name:"dateOfBirth",label:"Date of birth",modelValue:e.dateOfBirth.value,"onUpdate:modelValue":a[2]||(a[2]=t=>e.dateOfBirth.value=t),error:e.dateOfBirth.error,"onUpdate:error":a[3]||(a[3]=t=>e.dateOfBirth.error=t),"without-time":""},null,8,["modelValue","error"]),l(x,{ref_key:"typeField",ref:z,name:"type",label:"Type",modelValue:e.type.value,"onUpdate:modelValue":a[4]||(a[4]=t=>e.type.value=t),error:e.type.error,"onUpdate:error":a[5]||(a[5]=t=>e.type.error=t),options:i(ge)},null,8,["modelValue","error","options"]),l(y,{ref_key:"breedField",ref:$,id:"breed",name:"breed",label:"Breed",placeholder:e.type.value==="dog"?"Golden Retriever":"Maine Coone",modelValue:e.breed.value,"onUpdate:modelValue":a[6]||(a[6]=t=>e.breed.value=t),error:e.breed.error,"onUpdate:error":a[7]||(a[7]=t=>e.breed.error=t),"min-length":3,"max-length":50},null,8,["placeholder","modelValue","error"]),e.type.value==="dog"?(F(),P(x,{key:0,ref_key:"breedSizeField",ref:N,name:"breedSize",label:"Breed Size",modelValue:e.breedSize.value,"onUpdate:modelValue":a[8]||(a[8]=t=>e.breedSize.value=t),error:e.breedSize.error,"onUpdate:error":a[9]||(a[9]=t=>e.breedSize.error=t),options:i(fe)},null,8,["modelValue","error","options"])):Q("",!0),l(x,{ref_key:"genderField",ref:E,name:"gender",label:"Gender",modelValue:e.gender.value,"onUpdate:modelValue":a[10]||(a[10]=t=>e.gender.value=t),error:e.gender.error,"onUpdate:error":a[11]||(a[11]=t=>e.gender.error=t),options:i(Ve)},null,8,["modelValue","error","options"])]),_:1},8,["header"]),l(i(c),{header:`${T.value}'s Health`},{default:u(()=>[l(y,De({ref_key:"weightField",ref:I,name:"weight",label:"Weight (kg)",modelValue:e.weight.value,"onUpdate:modelValue":a[12]||(a[12]=t=>e.weight.value=t),error:e.weight.error,"onUpdate:error":a[13]||(a[13]=t=>e.weight.error=t)},e.weight.value?{rules:[i(U).Numeric],minValue:0}:void 0,{"input-props":{type:"number"}}),null,16,["modelValue","error"]),e.type.value==="cat"?(F(),P(H,{key:0,ref_key:"insideCatField",ref:R,name:"insideCat",label:"Inside Cat",modelValue:e.insideCat.value,"onUpdate:modelValue":a[14]||(a[14]=t=>e.insideCat.value=t)},null,8,["modelValue"])):Q("",!0),l(H,{ref_key:"castratedField",ref:j,name:"castrated",label:"Castrated or Sterilized",modelValue:e.castrated.value,"onUpdate:modelValue":a[15]||(a[15]=t=>e.castrated.value=t)},null,8,["modelValue"]),l(v,{ref_key:"vetDateField",ref:M,name:"vetDate",label:"Last vet visit",modelValue:e.vetDate.value,"onUpdate:modelValue":a[16]||(a[16]=t=>e.vetDate.value=t),error:e.vetDate.error,"onUpdate:error":a[17]||(a[17]=t=>e.vetDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(v,{ref_key:"lastVaccinationDateField",ref:A,name:"lastVaccinationDate",label:"Last vaccination",modelValue:e.lastVaccinationDate.value,"onUpdate:modelValue":a[18]||(a[18]=t=>e.lastVaccinationDate.value=t),error:e.lastVaccinationDate.error,"onUpdate:error":a[19]||(a[19]=t=>e.lastVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(v,{ref_key:"nextVaccinationDateField",ref:G,name:"nextVaccinationDate",label:"Next vaccination",modelValue:e.nextVaccinationDate.value,"onUpdate:modelValue":a[20]||(a[20]=t=>e.nextVaccinationDate.value=t),error:e.nextVaccinationDate.error,"onUpdate:error":a[21]||(a[21]=t=>e.nextVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(v,{ref_key:"dewormingDateField",ref:q,name:"dewormingDate",label:"Last deworming date",modelValue:e.dewormingDate.value,"onUpdate:modelValue":a[22]||(a[22]=t=>e.dewormingDate.value=t),error:e.dewormingDate.error,"onUpdate:error":a[23]||(a[23]=t=>e.dewormingDate.error=t),"without-time":""},null,8,["modelValue","error"])]),_:1},8,["header"]),l(i(c),{header:"Log"},{default:u(()=>[l(i(ye),{ref:"draggable",modelValue:e.weightLog.value,"onUpdate:modelValue":a[24]||(a[24]=t=>e.weightLog.value=t),itemKey:t=>t.date.toString(),handle:".drag-handle"},{item:u(({element:t,index:oe})=>[l(i(X),null,{default:u(()=>[l(i(c),{pt:{header:{class:"drag-handle"},toggleableContent:{class:"background-gray-dark rounded-t-primary rounded-b-primary pt-3 my-3"}}},{header:u(()=>[m("div",Ce,[a[27]||(a[27]=m("i",{class:"pi pi-arrows-v place-self-center hover:cursor-pointer"},null,-1)),m("p",null,we(i(be)(t.date)),1)])]),default:u(()=>[l(ke,{ref:p=>{_.value[oe]=p},id:t.date.toString(),log:t,"is-open":r.isOpen,onDelete:p=>re(t.date.toString()),onError:p=>te(p,t.date.toString())},null,8,["id","log","is-open","onDelete","onError"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","itemKey"]),m("div",Se,[l(Z,{class:"w-1/2",type:"green",label:"Add Log",onClick:ae})])]),_:1})]),_:1}),m("div",xe,[l(ie,{ref_key:"avatarField",ref:O,id:"avatar",name:"avatar",label:"Avatar",modelValue:e.avatar.value,"onUpdate:modelValue":a[25]||(a[25]=t=>e.avatar.value=t),error:e.avatar.error,"onUpdate:error":a[26]||(a[26]=t=>e.avatar.error=t),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["modelValue","error"])])])]),_:1},8,["isOpen","title","confirm-text","confirm-loading","confirm-props"]))}});export{je as _};
