import{e as J,f as ne,h as ie,g as de,A as me,a8 as ve,s as U,r as d,a as pe,c as v,b as S,a9 as fe,aa as we,a2 as ce,ab as Pe,l as o,q as t,D as G,k as l,p as m,ac as be,n as u,t as n,ad as z,m as Ne,R as k}from"../bundle.js";import{u as ye,b as ge,a as Ve,_ as p}from"./c-Bubble.vue_vue_type_script_setup_true_lang-CRLPsZ54.js";import{_ as H,a as Ue}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-WcqNwfk4.js";import{_ as ke,a as x,b as xe}from"./c-PasswordField.vue_vue_type_script_setup_true_lang-eebcY4mP.js";import{_ as _e}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-BOFCZQc6.js";import{_}from"./c-TextField.vue_vue_type_script_setup_true_lang-C7FWOWw0.js";import{_ as Ee}from"./c-Page.vue_vue_type_script_setup_true_lang-fYAt-wnj.js";import{R as f}from"./c-validation-DokkLKHB.js";const Re={class:"flex flex-wrap pt-6 pb-8 mb-4"},Se={class:"basis-full lg:basis-1/2"},$e={class:"flex gap-3 mt-10 flex-wrap"},Ce={class:"basis-full lg:basis-1/2"},De={key:0,class:"basis-full lg:basis-1/2 flex gap-3 mt-10 flex-wrap"},Oe={class:"flex flex-col items-center content-center"},Ae={class:"flex flex-col gap-3 items-center content-center"},Te=J({__name:"Dashboard",setup(K){const $=ne(),X=ye(ge).greaterOrEqual("md"),c=ie(),C=de(),D=me(),Z=ve(),{isOnline:E,debug:R}=U(Z),{content:h,routeLoading:O}=U(C),{currentUser:i,publicUser:P,isMutationLoading:A}=U(D),{firebaseUser:b,isOwner:w,isLogoutLoading:ee}=U(c),{fetchAll:ae}=C,{updateUser:re,updatePublicUser:le}=D,N=d(!1),T=d(),q=d(),L=d(),I=d(),B=d(),y=d(),M=d(),se=d(),e=pe({firstName:{value:"",error:""},lastName:{value:"",error:""},displayName:{value:"",error:""},email:{value:"",error:""},newPassword:{value:"",error:""},currentPassword:{value:"",error:""},repeatPassword:{value:"",error:""},avatar:{value:"",error:""}}),F=v(()=>({firstName:e.firstName.value,lastName:e.lastName.value})),oe=v(()=>({displayName:e.displayName.value,avatar:e.avatar.value})),te=v(()=>!!i.value&&!S(fe.convert(i.value),F.value)),W=v(()=>!!P.value&&!S(we.convert(P.value),oe.value)),g=v(()=>{var s;return e.email.value!==((s=b.value)==null?void 0:s.email)}),V=v(()=>{const s=[];return te.value&&s.push("Details"),W.value&&s.push("Public Profile"),g.value&&s.push("E-mail"),e.newPassword.value&&s.push("Password"),s.length?"Save "+ce(s):void 0}),ue=async()=>{var s;Object.keys(e).forEach(a=>e[a].error=""),e.newPassword.value&&(await Promise.all([B.value.test(),y.value.test(),M.value.test()]),!e.newPassword.error&&!e.currentPassword.error&&!e.repeatPassword.error&&(await c.updatePassword(e.newPassword.value,e.currentPassword.value),e.newPassword.value="",e.currentPassword.value="")),W.value&&(await L.value.test(),!e.displayName.error&&!e.avatar.error&&le({displayName:e.displayName.value,avatar:e.avatar.value})),g.value&&(await Promise.all([I.value.test(),y.value.test()]),!e.email.error&&!e.currentPassword.error&&(await c.updateMail(e.email.value,e.currentPassword.value),e.currentPassword.value="")),S(i.value,F.value)||(await Promise.all([T.value.test(),q.value.test()]),!e.firstName.error&&!e.lastName.error&&re({firstName:e.firstName.value,lastName:e.lastName.value})),await ae((s=b.value)==null?void 0:s.uid,!0)};return Pe(()=>{var s,a,r,j,Y;e.firstName.value=((s=i.value)==null?void 0:s.firstName)||"",e.lastName.value=((a=i.value)==null?void 0:a.lastName)||"",e.displayName.value=((r=P.value)==null?void 0:r.displayName)||"",e.email.value=((j=b.value)==null?void 0:j.email)||"",e.avatar.value=((Y=P.value)==null?void 0:Y.avatar)||""}),(s,a)=>(o(),t(Ee,null,{content:G(()=>[l(i)&&l(b)?(o(),t(Ve,{key:0,class:"!bg-secondary-500 !bg-opacity-35 my-5",title:"Welcome "+l(i).firstName+(l(i).lastName?" "+l(i).lastName:""),description:l(h).dashboardDescription},{default:G(()=>[m("div",Re,[m("div",Se,[m("form",{id:"accountForm",onSubmit:a[19]||(a[19]=be(r=>ue(),["prevent"]))},[u(_,{name:"accountType",label:"Account Type","model-value":l(w)?"Owner":"Member","input-props":{disabled:!0}},null,8,["model-value"]),u(_,{ref_key:"firstName",ref:T,name:"firstName",label:"First Name",placeholder:"Someone",modelValue:e.firstName.value,"onUpdate:modelValue":a[0]||(a[0]=r=>e.firstName.value=r),error:e.firstName.error,"onUpdate:error":a[1]||(a[1]=r=>e.firstName.error=r),rules:[l(f).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),u(_,{ref_key:"lastName",ref:q,name:"lastName",label:"Last Name",modelValue:e.lastName.value,"onUpdate:modelValue":a[2]||(a[2]=r=>e.lastName.value=r),error:e.lastName.error,"onUpdate:error":a[3]||(a[3]=r=>e.lastName.error=r),"min-length":3,"max-length":50},null,8,["modelValue","error"]),u(_,{ref_key:"displayName",ref:L,name:"displayName",label:"Public Username",modelValue:e.displayName.value,"onUpdate:modelValue":a[4]||(a[4]=r=>e.displayName.value=r),error:e.displayName.error,"onUpdate:error":a[5]||(a[5]=r=>e.displayName.error=r),rules:[l(f).MinLength],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),u(ke,{ref_key:"email",ref:I,name:"email",label:"E-mail",modelValue:e.email.value,"onUpdate:modelValue":a[6]||(a[6]=r=>e.email.value=r),error:e.email.error,"onUpdate:error":a[7]||(a[7]=r=>e.email.error=r),rules:[l(f).Required]},null,8,["modelValue","error","rules"]),g.value?(o(),t(x,{key:0,ref_key:"currentPassword",ref:y,name:"currentPassword",label:"Current Password",modelValue:e.currentPassword.value,"onUpdate:modelValue":a[8]||(a[8]=r=>e.currentPassword.value=r),error:e.currentPassword.error,"onUpdate:error":a[9]||(a[9]=r=>e.currentPassword.error=r),rules:[l(f).Required]},null,8,["modelValue","error","rules"])):n("",!0),u(x,{ref_key:"newPassword",ref:B,name:"newPassword",label:"New Password",modelValue:e.newPassword.value,"onUpdate:modelValue":a[10]||(a[10]=r=>e.newPassword.value=r),error:e.newPassword.error,"onUpdate:error":a[11]||(a[11]=r=>e.newPassword.error=r),min:6,max:50},null,8,["modelValue","error"]),e.newPassword.value?(o(),t(x,{key:1,ref_key:"repeatPassword",ref:M,name:"repeatPassword",label:"Repeat New Password",modelValue:e.repeatPassword.value,"onUpdate:modelValue":a[12]||(a[12]=r=>e.repeatPassword.value=r),error:e.repeatPassword.error,"onUpdate:error":a[13]||(a[13]=r=>e.repeatPassword.error=r),rules:[l(f).Required],compare:{value:e.newPassword.value,name:"New Password"}},null,8,["modelValue","error","rules","compare"])):n("",!0),e.newPassword.value&&!g.value?(o(),t(x,{key:2,ref_key:"currentPassword",ref:y,name:"currentPassword",label:"Current Password",modelValue:e.currentPassword.value,"onUpdate:modelValue":a[14]||(a[14]=r=>e.currentPassword.value=r),error:e.currentPassword.error,"onUpdate:error":a[15]||(a[15]=r=>e.currentPassword.error=r),rules:[l(f).Required]},null,8,["modelValue","error","rules"])):n("",!0),m("div",$e,[V.value?(o(),t(p,{key:0,class:"w-full",action:"submit",loading:l(A),label:V.value},null,8,["loading","label"])):n("",!0),l(w)?n("",!0):(o(),t(p,{key:1,class:"w-full",type:"danger",outlined:"",label:"Delete account",onClick:a[16]||(a[16]=r=>N.value=!0)}))]),l(w)?(o(),t(H,{key:3,name:"isOnline",label:"Online",modelValue:l(E),"onUpdate:modelValue":a[17]||(a[17]=r=>z(E)?E.value=r:null)},null,8,["modelValue"])):n("",!0),l(w)?(o(),t(H,{key:4,name:"debug",label:"Debug",modelValue:l(R),"onUpdate:modelValue":a[18]||(a[18]=r=>z(R)?R.value=r:null)},null,8,["modelValue"])):n("",!0)],32)]),m("div",Ce,[u(_e,{ref_key:"avatar",ref:se,id:"avatar",name:"avatar",label:"Public Avatar",modelValue:e.avatar.value,"onUpdate:modelValue":a[20]||(a[20]=r=>e.avatar.value=r),error:e.avatar.error,"onUpdate:error":a[21]||(a[21]=r=>e.avatar.error=r),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["modelValue","error"])]),l(X)?n("",!0):(o(),Ne("div",De,[V.value?(o(),t(p,{key:0,class:"w-full",action:"submit",form:"accountForm",loading:l(A),label:V.value},null,8,["loading","label"])):n("",!0),l(w)?n("",!0):(o(),t(p,{key:1,class:"w-full",type:"danger",outlined:"",label:"Delete account",onClick:a[22]||(a[22]=r=>N.value=!0)}))]))]),m("div",Oe,[u(xe)]),m("div",Ae,[u(p,{class:"w-full md:w-1/2",label:"View Your Profile",type:"purple",loading:l(O)===l(k).USER_DETAILS,onClick:a[23]||(a[23]=r=>l($).push({name:l(k).USER_DETAILS,params:{userId:l(i).id}}))},null,8,["loading"]),u(p,{class:"w-full md:w-1/2",label:"View Your Pets",loading:l(O)===l(k).PET_OVERVIEW,route:l(k).PET_OVERVIEW},null,8,["loading","route"])])]),_:1},8,["title","description"])):n("",!0),u(Ue,{title:"Delete Account",isOpen:N.value,description:["Are you sure you want to delete your account?","This cannot be undone."],"confirm-text":"Confirm","confirm-props":{type:"danger",outlined:!0},"confirm-loading":l(ee),onConfirm:a[24]||(a[24]=r=>l(c).deleteAccount()),onCancel:a[25]||(a[25]=r=>N.value=!1)},null,8,["isOpen","confirm-loading"])]),_:1}))}}),Ye=J({__name:"Dashboard",setup(K){return($,Q)=>(o(),t(Te))}});export{Ye as default};
