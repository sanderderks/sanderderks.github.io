import{_ as ie}from"./c-Dialog.vue_vue_type_script_setup_true_lang-DTvaJL_v.js";import{f as ee,r as o,c as w,l as de,n as c,p as l,q as v,aN as g,V as p,m as i,W as h,_ as re,i as se,aG as ue,s as Q,a as me,aO as ve,b as ge,S as fe,t as F,H as m,a7 as k,w as O,Y as L,aJ as Ve,aK as De,aL as we,z as ce,Z as X,aP as pe,a5 as _,M as be,aM as ye,an as Ue}from"../bundle.js";const Fe={class:"md:px-5"},ke={class:"mt-3 flex justify-evenly font-bold"},he=ee({__name:"PetLogDialogSection",props:{id:{},log:{}},emits:["error","delete"],setup(B,{expose:S,emit:s}){const b=s,y=o(),f=o(),V=o(),D=o(),C=w(()=>[V.value,D.value].some(e=>!!e));return S({test:async()=>{var e,n;await Promise.all([(e=y.value)==null?void 0:e.test(),(n=f.value)==null?void 0:n.test()]),b("error",C.value)}}),(e,n)=>(c(),de("div",Fe,[l(g,{ref_key:"dateField",ref:y,id:e.id,name:"logDate",label:"Date",modelValue:e.log.date,"onUpdate:modelValue":n[0]||(n[0]=d=>e.log.date=d),error:V.value,"onUpdate:error":n[1]||(n[1]=d=>V.value=d),"without-time":""},null,8,["id","modelValue","error"]),l(p,{ref_key:"weightField",ref:f,id:e.id,name:"logWeight",label:"Weight (kg)","model-value":`${e.log.weight}`,"onUpdate:modelValue":n[2]||(n[2]=d=>e.log.weight=Number(d)),error:D.value,"onUpdate:error":n[3]||(n[3]=d=>D.value=d),rules:[i(h).Required,i(h).Numeric],"min-value":0,"input-props":{type:"number"}},null,8,["id","model-value","error","rules"]),v("div",ke,[l(re,{class:"w-full sm:w-2/3 md:w-1/2 xl:w-2/3",type:"danger",outlined:"",label:"Delete",onClick:n[4]||(n[4]=d=>e.$emit("delete"))})])]))}}),Se={class:"pt-6 mb-4 xl:px-16"},Ce={class:"flex gap-5"},xe={class:"mt-3 flex justify-center"},Pe={class:"basis-full lg:basis-1/2"},Be=ee({__name:"PetDialog",props:{isOpen:{type:Boolean},originalPet:{}},emits:["close"],setup(B,{emit:S}){const s=B,b=S,y=se(),f=ue(),{isMutationLoading:V}=Q(f),{firebaseUser:D}=Q(y),{mutatePet:C}=f,x=a=>({name:{value:(a==null?void 0:a.name)??"",error:""},description:{value:(a==null?void 0:a.description)??"",error:""},avatar:{value:(a==null?void 0:a.avatar)??"",error:""},dateOfBirth:{value:a!=null&&a.dateOfBirth?new Date(a.dateOfBirth):null,error:""},type:{value:(a==null?void 0:a.type)??"cat",error:""},breed:{value:(a==null?void 0:a.breed)??"",error:""},breedSize:{value:(a==null?void 0:a.breedSize)??"medium",error:""},gender:{value:(a==null?void 0:a.gender)??"male",error:""},weight:{value:a!=null&&a.weight?a.weight.toString():"",error:""},insideCat:{value:(a==null?void 0:a.insideCat)??!1,error:""},castrated:{value:(a==null?void 0:a.castrated)??!1,error:""},dewormingDate:{value:a!=null&&a.dewormingDate?new Date(a.dewormingDate):null,error:""},vetDate:{value:a!=null&&a.vetDate?new Date(a.vetDate):null,error:""},lastVaccinationDate:{value:a!=null&&a.lastVaccinationDate?new Date(a.lastVaccinationDate):null,error:""},nextVaccinationDate:{value:a!=null&&a.nextVaccinationDate?new Date(a.nextVaccinationDate):null,error:""},weightLog:{value:a!=null&&a.weightLog?a.weightLog.map(r=>({...r,date:new Date(r.date)})):[],error:{}}}),e=me(x(s.originalPet)),n=w(()=>{var a,r;return{name:e.name.value,description:e.description.value,userId:((a=s.originalPet)==null?void 0:a.userId)??((r=D.value)==null?void 0:r.uid)??"",avatar:e.avatar.value,dateOfBirth:e.dateOfBirth.value??null,type:e.type.value,breed:e.breed.value,breedSize:e.breedSize.value,gender:e.gender.value,weight:isNaN(+e.weight.value)?null:+e.weight.value,insideCat:e.type.value==="cat"?e.insideCat.value:null,castrated:e.castrated.value,dewormingDate:e.dewormingDate.value??null,vetDate:e.vetDate.value??null,lastVaccinationDate:e.lastVaccinationDate.value??null,nextVaccinationDate:e.nextVaccinationDate.value??null,weightLog:e.weightLog.value}}),d=o(),z=o(),$=o(),N=o(),E=o(),I=o(),M=o(),j=o(),R=o(),W=o(),q=o(),G=o(),K=o(),A=o(),T=o(),H=o([]),P=w(()=>s.originalPet?ve.convert(s.originalPet):null),J=w(()=>!ge(P.value,n.value)),Y=w(()=>{if(e.name.value)return e.name.value;switch(e.type.value){case"cat":return"Cat";case"dog":return"Dog";default:return"Pet"}}),ae=async()=>{var a,r,t,U;await Promise.all([d.value.test(),z.value.test(),$.value.test(),N.value.test(),E.value.test(),I.value.test(),(a=M.value)==null?void 0:a.test(),j.value.test(),(r=R.value)==null?void 0:r.test(),(t=W.value)==null?void 0:t.test(),q.value.test(),G.value.test(),A.value.test(),T.value.test(),K.value.test()]);for(const u of H.value)await(u==null?void 0:u.test());e.name.error||e.description.error||e.avatar.error||e.dateOfBirth.error||e.type.error||e.breed.error||e.breedSize.error||e.gender.error||e.weight.error||e.insideCat.error||e.castrated.error||e.dewormingDate.error||e.vetDate.error||e.lastVaccinationDate.error||e.nextVaccinationDate.error||Object.values(e.weightLog.error).some(u=>!!u)||(await C(n.value,(U=s.originalPet)==null?void 0:U.id),b("close"))},te=()=>{e.weightLog.value.push({date:new Date,weight:0})},Z=a=>e.weightLog.value.findIndex(r=>r.date.toString()===a),le=a=>{e.weightLog.value.splice(Z(a),1)},oe=(a,r)=>{e.weightLog.error[Z(r)]=a},ne=()=>{b("close")};return fe(()=>[s.isOpen,s.originalPet],()=>{Object.assign(e,x(s.originalPet))}),(a,r)=>(c(),F(ie,{isOpen:a.isOpen,title:P.value?"Update Pet":"Create Pet",description:"Keep in mind that pet data is visible to all authenticated users.","confirm-text":P.value?J.value?"Update":"Nothing changed":"Create","confirm-loading":i(V),"confirm-props":{disabled:!J.value},onConfirm:ae,onCancel:ne},{default:m(()=>[v("form",Se,[l(p,{ref_key:"nameField",ref:d,id:"name",name:"name",label:"Name",placeholder:"Mogu",modelValue:e.name.value,"onUpdate:modelValue":r[0]||(r[0]=t=>e.name.value=t),error:e.name.error,"onUpdate:error":r[1]||(r[1]=t=>e.name.error=t),rules:[i(h).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),l(p,{ref_key:"descriptionField",ref:z,id:"description",name:"description",label:"Description",placeholder:"My cute pet.",modelValue:e.description.value,"onUpdate:modelValue":r[2]||(r[2]=t=>e.description.value=t),error:e.description.error,"onUpdate:error":r[3]||(r[3]=t=>e.description.error=t),"max-length":100},null,8,["modelValue","error"]),l(i(_),null,{default:m(()=>[l(i(k),{header:`${Y.value}'s Details`},{default:m(()=>[l(g,{ref_key:"dateOfBirthField",ref:N,name:"dateOfBirth",label:"Date of birth",modelValue:e.dateOfBirth.value,"onUpdate:modelValue":r[4]||(r[4]=t=>e.dateOfBirth.value=t),error:e.dateOfBirth.error,"onUpdate:error":r[5]||(r[5]=t=>e.dateOfBirth.error=t),"without-time":""},null,8,["modelValue","error"]),l(L,{ref_key:"typeField",ref:E,name:"type",label:"Type",modelValue:e.type.value,"onUpdate:modelValue":r[6]||(r[6]=t=>e.type.value=t),error:e.type.error,"onUpdate:error":r[7]||(r[7]=t=>e.type.error=t),options:i(Ve)},null,8,["modelValue","error","options"]),l(p,{ref_key:"breedField",ref:I,id:"breed",name:"breed",label:"Breed",placeholder:e.type.value==="dog"?"Golden Retriever":"Maine Coone",modelValue:e.breed.value,"onUpdate:modelValue":r[8]||(r[8]=t=>e.breed.value=t),error:e.breed.error,"onUpdate:error":r[9]||(r[9]=t=>e.breed.error=t),"min-length":3,"max-length":50},null,8,["placeholder","modelValue","error"]),e.type.value==="dog"?(c(),F(L,{key:0,ref_key:"breedSizeField",ref:M,name:"breedSize",label:"Breed Size",modelValue:e.breedSize.value,"onUpdate:modelValue":r[10]||(r[10]=t=>e.breedSize.value=t),error:e.breedSize.error,"onUpdate:error":r[11]||(r[11]=t=>e.breedSize.error=t),options:i(De)},null,8,["modelValue","error","options"])):O("",!0),l(L,{ref_key:"genderField",ref:j,name:"gender",label:"Gender",modelValue:e.gender.value,"onUpdate:modelValue":r[12]||(r[12]=t=>e.gender.value=t),error:e.gender.error,"onUpdate:error":r[13]||(r[13]=t=>e.gender.error=t),options:i(we)},null,8,["modelValue","error","options"])]),_:1},8,["header"]),l(i(k),{header:`${Y.value}'s Health`},{default:m(()=>[e.weightLog.value.length?O("",!0):(c(),F(p,ce({key:0,ref_key:"weightField",ref:R,name:"weight",label:"Weight (kg)",modelValue:e.weight.value,"onUpdate:modelValue":r[14]||(r[14]=t=>e.weight.value=t),error:e.weight.error,"onUpdate:error":r[15]||(r[15]=t=>e.weight.error=t)},e.weight.value?{rules:[i(h).Numeric],minValue:0}:void 0,{"input-props":{type:"number"}}),null,16,["modelValue","error"])),e.type.value==="cat"?(c(),F(X,{key:1,ref_key:"insideCatField",ref:W,name:"insideCat",label:"Inside Cat",modelValue:e.insideCat.value,"onUpdate:modelValue":r[16]||(r[16]=t=>e.insideCat.value=t)},null,8,["modelValue"])):O("",!0),l(X,{ref_key:"castratedField",ref:q,name:"castrated",label:"Castrated or Sterilized",modelValue:e.castrated.value,"onUpdate:modelValue":r[17]||(r[17]=t=>e.castrated.value=t)},null,8,["modelValue"]),l(g,{ref_key:"vetDateField",ref:K,name:"vetDate",label:"Last vet visit",modelValue:e.vetDate.value,"onUpdate:modelValue":r[18]||(r[18]=t=>e.vetDate.value=t),error:e.vetDate.error,"onUpdate:error":r[19]||(r[19]=t=>e.vetDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"lastVaccinationDateField",ref:A,name:"lastVaccinationDate",label:"Last vaccination",modelValue:e.lastVaccinationDate.value,"onUpdate:modelValue":r[20]||(r[20]=t=>e.lastVaccinationDate.value=t),error:e.lastVaccinationDate.error,"onUpdate:error":r[21]||(r[21]=t=>e.lastVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"nextVaccinationDateField",ref:T,name:"nextVaccinationDate",label:"Next vaccination",modelValue:e.nextVaccinationDate.value,"onUpdate:modelValue":r[22]||(r[22]=t=>e.nextVaccinationDate.value=t),error:e.nextVaccinationDate.error,"onUpdate:error":r[23]||(r[23]=t=>e.nextVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"dewormingDateField",ref:G,name:"dewormingDate",label:"Last deworming date",modelValue:e.dewormingDate.value,"onUpdate:modelValue":r[24]||(r[24]=t=>e.dewormingDate.value=t),error:e.dewormingDate.error,"onUpdate:error":r[25]||(r[25]=t=>e.dewormingDate.error=t),"without-time":""},null,8,["modelValue","error"])]),_:1},8,["header"]),l(i(k),{header:"Weight Log"},{default:m(()=>[l(i(pe),{ref:"draggable",modelValue:e.weightLog.value,"onUpdate:modelValue":r[26]||(r[26]=t=>e.weightLog.value=t),itemKey:t=>t.date.toString(),handle:".drag-handle"},{item:m(({element:t,index:U})=>[l(i(_),null,{default:m(()=>[l(i(k),{pt:{header:{class:"drag-handle"},toggleableContent:{class:"background-gray-dark rounded-t-primary rounded-b-primary pt-3 my-3"}}},{header:m(()=>[v("div",Ce,[r[29]||(r[29]=v("i",{class:"pi pi-arrows-v place-self-center hover:cursor-pointer"},null,-1)),v("p",null,be(i(ye)(t.date)),1)])]),default:m(()=>[l(he,{ref:u=>{H.value[U]=u},id:t.date.toString(),log:t,"is-open":a.isOpen,onDelete:u=>le(t.date.toString()),onError:u=>oe(u,t.date.toString())},null,8,["id","log","is-open","onDelete","onError"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","itemKey"]),v("div",xe,[l(re,{class:"w-1/2",type:"green",label:"Add Log",onClick:te})])]),_:1})]),_:1}),v("div",Pe,[l(Ue,{ref_key:"avatarField",ref:$,id:"avatar",name:"avatar",label:"Avatar",modelValue:e.avatar.value,"onUpdate:modelValue":r[27]||(r[27]=t=>e.avatar.value=t),error:e.avatar.error,"onUpdate:error":r[28]||(r[28]=t=>e.avatar.error=t),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["modelValue","error"])])])]),_:1},8,["isOpen","title","confirm-text","confirm-loading","confirm-props"]))}});export{Be as _};
