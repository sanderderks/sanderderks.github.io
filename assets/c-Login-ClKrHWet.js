import{d as y,u as U,a as B,b as I,c as M,s as v,a8 as N,o as T,ad as j,g as L,k as S,y as m,j as o,w as G,q as c,ai as O,f as r,P as w,_ as p,R,v as b,m as A}from"../bundle.js";import{_ as F,a as J,b as h}from"./c-PasswordField.vue_vue_type_script_setup_true_lang-7kLuHWVj.js";import{_ as z}from"./c-Page.vue_vue_type_script_setup_true_lang-BOUnK2cH.js";const D={class:"flex flex-col items-center content-center"},H={class:"grid grid-cols-4 mt-10 gap-3"},K=y({__name:"Login",setup(k){const t=U(),l=B(),x=I(),n=M(),{routeLoading:V}=v(x),{isLoggedIn:$,isLoginLoading:P}=v(n),{initEmail:i,initPassword:u}=l.currentRoute.value.query,d=b(),f=b(),e=N({email:{value:(i==null?void 0:i.toString())||"",error:""},password:{value:(u==null?void 0:u.toString())||"",error:""}}),_=A(()=>t.params.redirect?JSON.parse(t.params.redirect):void 0),q=async()=>{Object.keys(e).forEach(g=>e[g].error=""),await Promise.all([d.value.test(),f.value.test()]),!e.email.error&&!e.password.error&&(await n.login(e.email.value,e.password.value),$.value&&_.value&&l.push(_.value))},E=async()=>{await d.value.test(),e.email.error||n.resetPassword(e.email.value)};return T(()=>{l.replace({query:void 0})}),(g,a)=>{const C=j("RouterLink");return L(),S(z,null,{content:m(()=>[o(G,{class:"!bg-primary-800 !bg-opacity-50 my-5",title:"Login",description:"Please login using your e-mail and password."},{default:m(()=>[c("div",D,[c("form",{class:"w-full lg:w-1/2 xl:w-2/3 px-8 pt-6 pb-8 mb-4",onSubmit:a[4]||(a[4]=O(s=>q(),["prevent"]))},[o(F,{ref_key:"email",ref:d,name:"email",label:"E-mail",modelValue:e.email.value,"onUpdate:modelValue":a[0]||(a[0]=s=>e.email.value=s),error:e.email.error,"onUpdate:error":a[1]||(a[1]=s=>e.email.error=s),rules:[r(w).Required]},null,8,["modelValue","error","rules"]),o(J,{ref_key:"password",ref:f,name:"password",label:"Password",modelValue:e.password.value,"onUpdate:modelValue":a[2]||(a[2]=s=>e.password.value=s),error:e.password.error,"onUpdate:error":a[3]||(a[3]=s=>e.password.error=s),rules:[r(w).Required]},null,8,["modelValue","error","rules"]),c("div",H,[o(p,{class:"col-span-full md:col-span-2",type:"submit",label:"Login",loading:r(P)},null,8,["loading"]),o(C,{class:"col-span-full md:col-span-2",to:{name:r(R).REGISTER,query:{initEmail:e.email.value,initPassword:e.password.value}}},{default:m(()=>[o(p,{class:"w-full",outlined:"",label:"Register",loading:r(V)===r(R).REGISTER},null,8,["loading"])]),_:1},8,["to"]),o(p,{class:"col-span-full md:col-span-2 md:col-start-3",outlined:"",variant:"neutral",label:"Forgot Password",onClick:E})])],32),o(h)])]),_:1})]),_:1})}}}),Y=y({__name:"Login",setup(k){return(t,l)=>(L(),S(K))}});export{Y as default};
