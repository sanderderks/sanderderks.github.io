import{_ as X,a as ne}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-R6e5xvIM.js";import{D as g}from"./c-DateField-CWvNIfkF.js";import{_ as ie}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-B2_K8Vcb.js";import{_ as O}from"./c-SelectField.vue_vue_type_script_setup_true_lang-DIKuGEia.js";import{_ as h}from"./c-TextField.vue_vue_type_script_setup_true_lang-DeJvJEAf.js";import{e as _,r as o,c as w,l as b,m as de,n as l,k as i,p as v,h as se,av as ue,s as Y,a as me,aG as ve,b as ge,M as fe,q as U,D as m,ax as Ve,ay as De,t as B,az as we,y as be,H as ce,aA as pe}from"../bundle.js";import{R as k}from"./c-validation-DokkLKHB.js";import{a as Z,s as F}from"./c-accordiontab.esm-CrO3SYCY.js";import{_ as ee}from"./c-Bubble.vue_vue_type_script_setup_true_lang-BLfz40U2.js";import{D as ye}from"./c-vuedraggable.umd-6GGnRdAM.js";const Ue={class:"md:px-5"},Fe={class:"mt-3 flex justify-evenly font-bold"},he=_({__name:"PetLogDialogSection",props:{id:{},log:{}},emits:["error","delete"],setup(L,{expose:C,emit:s}){const c=s,p=o(),f=o(),V=o(),D=o(),S=w(()=>[V.value,D.value].some(e=>!!e));return C({test:async()=>{var e,n;await Promise.all([(e=p.value)==null?void 0:e.test(),(n=f.value)==null?void 0:n.test()]),c("error",S.value)}}),(e,n)=>(b(),de("div",Ue,[l(g,{ref_key:"dateField",ref:p,id:e.id,name:"logDate",label:"Date",modelValue:e.log.date,"onUpdate:modelValue":n[0]||(n[0]=d=>e.log.date=d),error:V.value,"onUpdate:error":n[1]||(n[1]=d=>V.value=d),"without-time":""},null,8,["id","modelValue","error"]),l(h,{ref_key:"weightField",ref:f,id:e.id,name:"logWeight",label:"Weight (kg)","model-value":`${e.log.weight}`,"onUpdate:modelValue":n[2]||(n[2]=d=>e.log.weight=Number(d)),error:D.value,"onUpdate:error":n[3]||(n[3]=d=>D.value=d),rules:[i(k).Required,i(k).Numeric],"min-value":0,"input-props":{type:"number"}},null,8,["id","model-value","error","rules"]),v("div",Fe,[l(ee,{class:"w-full sm:w-2/3 md:w-1/2 xl:w-2/3",type:"danger",outlined:"",label:"Delete",onClick:n[4]||(n[4]=d=>e.$emit("delete"))})])]))}}),ke={class:"pt-6 mb-4 xl:px-16"},Ce={class:"flex gap-5"},Se={class:"mt-3 flex justify-center"},xe={class:"basis-full lg:basis-1/2"},je=_({__name:"PetDialog",props:{isOpen:{type:Boolean},originalPet:{}},emits:["close"],setup(L,{emit:C}){const s=L,c=C,p=se(),f=ue(),{isMutationLoading:V}=Y(f),{firebaseUser:D}=Y(p),{mutatePet:S}=f,x=r=>({name:{value:(r==null?void 0:r.name)??"",error:""},avatar:{value:(r==null?void 0:r.avatar)??"",error:""},dateOfBirth:{value:r!=null&&r.dateOfBirth?new Date(r.dateOfBirth):null,error:""},type:{value:(r==null?void 0:r.type)??"cat",error:""},breed:{value:(r==null?void 0:r.breed)??"",error:""},breedSize:{value:(r==null?void 0:r.breedSize)??"medium",error:""},gender:{value:(r==null?void 0:r.gender)??"male",error:""},weight:{value:r!=null&&r.weight?r.weight.toString():"",error:""},insideCat:{value:(r==null?void 0:r.insideCat)??!1,error:""},castrated:{value:(r==null?void 0:r.castrated)??!1,error:""},dewormingDate:{value:r!=null&&r.dewormingDate?new Date(r.dewormingDate):null,error:""},vetDate:{value:r!=null&&r.vetDate?new Date(r.vetDate):null,error:""},lastVaccinationDate:{value:r!=null&&r.lastVaccinationDate?new Date(r.lastVaccinationDate):null,error:""},nextVaccinationDate:{value:r!=null&&r.nextVaccinationDate?new Date(r.nextVaccinationDate):null,error:""},weightLog:{value:r!=null&&r.weightLog?r.weightLog.map(a=>({...a,date:new Date(a.date)})):[],error:{}}}),e=me(x(s.originalPet)),n=w(()=>{var r,a;return{name:e.name.value,userId:((r=s.originalPet)==null?void 0:r.userId)??((a=D.value)==null?void 0:a.uid)??"",avatar:e.avatar.value,dateOfBirth:e.dateOfBirth.value??null,type:e.type.value,breed:e.breed.value,breedSize:e.breedSize.value,gender:e.gender.value,weight:isNaN(+e.weight.value)?null:+e.weight.value,insideCat:e.type.value==="cat"?e.insideCat.value:null,castrated:e.castrated.value,dewormingDate:e.dewormingDate.value??null,vetDate:e.vetDate.value??null,lastVaccinationDate:e.lastVaccinationDate.value??null,nextVaccinationDate:e.nextVaccinationDate.value??null,weightLog:e.weightLog.value}}),d=o(),z=o(),$=o(),N=o(),E=o(),I=o(),R=o(),j=o(),q=o(),A=o(),G=o(),M=o(),W=o(),K=o(),T=o([]),P=w(()=>s.originalPet?ve.convert(s.originalPet):null),H=w(()=>!ge(P.value,n.value)),J=w(()=>{if(e.name.value)return e.name.value;switch(e.type.value){case"cat":return"Cat";case"dog":return"Dog";default:return"Pet"}}),ae=async()=>{var r,a,t,y;await Promise.all([d.value.test(),z.value.test(),$.value.test(),N.value.test(),E.value.test(),(r=I.value)==null?void 0:r.test(),R.value.test(),(a=j.value)==null?void 0:a.test(),(t=q.value)==null?void 0:t.test(),A.value.test(),G.value.test(),W.value.test(),K.value.test(),M.value.test()]);for(const u of T.value)await(u==null?void 0:u.test());e.name.error||e.avatar.error||e.dateOfBirth.error||e.type.error||e.breed.error||e.breedSize.error||e.gender.error||e.weight.error||e.insideCat.error||e.castrated.error||e.dewormingDate.error||e.vetDate.error||e.lastVaccinationDate.error||e.nextVaccinationDate.error||Object.values(e.weightLog.error).some(u=>!!u)||(await S(n.value,(y=s.originalPet)==null?void 0:y.id),c("close"))},re=()=>{e.weightLog.value.push({date:new Date,weight:0})},Q=r=>e.weightLog.value.findIndex(a=>a.date.toString()===r),te=r=>{e.weightLog.value.splice(Q(r),1)},le=(r,a)=>{e.weightLog.error[Q(a)]=r},oe=()=>{c("close")};return fe(()=>[s.isOpen,s.originalPet],()=>{Object.assign(e,x(s.originalPet))}),(r,a)=>(b(),U(ne,{isOpen:r.isOpen,title:P.value?"Update Pet":"Create Pet",description:"Keep in mind that pet data is visible to all authenticated users.","confirm-text":P.value?H.value?"Update":"Nothing changed":"Create","confirm-loading":i(V),"confirm-props":{disabled:!H.value},onConfirm:ae,onCancel:oe},{default:m(()=>[v("form",ke,[l(h,{ref_key:"nameField",ref:d,id:"name",name:"name",label:"Name",placeholder:"Mogu",modelValue:e.name.value,"onUpdate:modelValue":a[0]||(a[0]=t=>e.name.value=t),error:e.name.error,"onUpdate:error":a[1]||(a[1]=t=>e.name.error=t),rules:[i(k).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),l(i(Z),null,{default:m(()=>[l(i(F),{header:`${J.value}'s Details`},{default:m(()=>[l(g,{ref_key:"dateOfBirthField",ref:$,name:"dateOfBirth",label:"Date of birth",modelValue:e.dateOfBirth.value,"onUpdate:modelValue":a[2]||(a[2]=t=>e.dateOfBirth.value=t),error:e.dateOfBirth.error,"onUpdate:error":a[3]||(a[3]=t=>e.dateOfBirth.error=t),"without-time":""},null,8,["modelValue","error"]),l(O,{ref_key:"typeField",ref:N,name:"type",label:"Type",modelValue:e.type.value,"onUpdate:modelValue":a[4]||(a[4]=t=>e.type.value=t),error:e.type.error,"onUpdate:error":a[5]||(a[5]=t=>e.type.error=t),options:i(Ve)},null,8,["modelValue","error","options"]),l(h,{ref_key:"breedField",ref:E,id:"breed",name:"breed",label:"Breed",placeholder:e.type.value==="dog"?"Golden Retriever":"Maine Coone",modelValue:e.breed.value,"onUpdate:modelValue":a[6]||(a[6]=t=>e.breed.value=t),error:e.breed.error,"onUpdate:error":a[7]||(a[7]=t=>e.breed.error=t),"min-length":3,"max-length":50},null,8,["placeholder","modelValue","error"]),e.type.value==="dog"?(b(),U(O,{key:0,ref_key:"breedSizeField",ref:I,name:"breedSize",label:"Breed Size",modelValue:e.breedSize.value,"onUpdate:modelValue":a[8]||(a[8]=t=>e.breedSize.value=t),error:e.breedSize.error,"onUpdate:error":a[9]||(a[9]=t=>e.breedSize.error=t),options:i(De)},null,8,["modelValue","error","options"])):B("",!0),l(O,{ref_key:"genderField",ref:R,name:"gender",label:"Gender",modelValue:e.gender.value,"onUpdate:modelValue":a[10]||(a[10]=t=>e.gender.value=t),error:e.gender.error,"onUpdate:error":a[11]||(a[11]=t=>e.gender.error=t),options:i(we)},null,8,["modelValue","error","options"])]),_:1},8,["header"]),l(i(F),{header:`${J.value}'s Health`},{default:m(()=>[e.weightLog.value.length?B("",!0):(b(),U(h,be({key:0,ref_key:"weightField",ref:j,name:"weight",label:"Weight (kg)",modelValue:e.weight.value,"onUpdate:modelValue":a[12]||(a[12]=t=>e.weight.value=t),error:e.weight.error,"onUpdate:error":a[13]||(a[13]=t=>e.weight.error=t)},e.weight.value?{rules:[i(k).Numeric],minValue:0}:void 0,{"input-props":{type:"number"}}),null,16,["modelValue","error"])),e.type.value==="cat"?(b(),U(X,{key:1,ref_key:"insideCatField",ref:q,name:"insideCat",label:"Inside Cat",modelValue:e.insideCat.value,"onUpdate:modelValue":a[14]||(a[14]=t=>e.insideCat.value=t)},null,8,["modelValue"])):B("",!0),l(X,{ref_key:"castratedField",ref:A,name:"castrated",label:"Castrated or Sterilized",modelValue:e.castrated.value,"onUpdate:modelValue":a[15]||(a[15]=t=>e.castrated.value=t)},null,8,["modelValue"]),l(g,{ref_key:"vetDateField",ref:M,name:"vetDate",label:"Last vet visit",modelValue:e.vetDate.value,"onUpdate:modelValue":a[16]||(a[16]=t=>e.vetDate.value=t),error:e.vetDate.error,"onUpdate:error":a[17]||(a[17]=t=>e.vetDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"lastVaccinationDateField",ref:W,name:"lastVaccinationDate",label:"Last vaccination",modelValue:e.lastVaccinationDate.value,"onUpdate:modelValue":a[18]||(a[18]=t=>e.lastVaccinationDate.value=t),error:e.lastVaccinationDate.error,"onUpdate:error":a[19]||(a[19]=t=>e.lastVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"nextVaccinationDateField",ref:K,name:"nextVaccinationDate",label:"Next vaccination",modelValue:e.nextVaccinationDate.value,"onUpdate:modelValue":a[20]||(a[20]=t=>e.nextVaccinationDate.value=t),error:e.nextVaccinationDate.error,"onUpdate:error":a[21]||(a[21]=t=>e.nextVaccinationDate.error=t),"without-time":""},null,8,["modelValue","error"]),l(g,{ref_key:"dewormingDateField",ref:G,name:"dewormingDate",label:"Last deworming date",modelValue:e.dewormingDate.value,"onUpdate:modelValue":a[22]||(a[22]=t=>e.dewormingDate.value=t),error:e.dewormingDate.error,"onUpdate:error":a[23]||(a[23]=t=>e.dewormingDate.error=t),"without-time":""},null,8,["modelValue","error"])]),_:1},8,["header"]),l(i(F),{header:"Weight Log"},{default:m(()=>[l(i(ye),{ref:"draggable",modelValue:e.weightLog.value,"onUpdate:modelValue":a[24]||(a[24]=t=>e.weightLog.value=t),itemKey:t=>t.date.toString(),handle:".drag-handle"},{item:m(({element:t,index:y})=>[l(i(Z),null,{default:m(()=>[l(i(F),{pt:{header:{class:"drag-handle"},toggleableContent:{class:"background-gray-dark rounded-t-primary rounded-b-primary pt-3 my-3"}}},{header:m(()=>[v("div",Ce,[a[27]||(a[27]=v("i",{class:"pi pi-arrows-v place-self-center hover:cursor-pointer"},null,-1)),v("p",null,ce(i(pe)(t.date)),1)])]),default:m(()=>[l(he,{ref:u=>{T.value[y]=u},id:t.date.toString(),log:t,"is-open":r.isOpen,onDelete:u=>te(t.date.toString()),onError:u=>le(u,t.date.toString())},null,8,["id","log","is-open","onDelete","onError"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","itemKey"]),v("div",Se,[l(ee,{class:"w-1/2",type:"green",label:"Add Log",onClick:re})])]),_:1})]),_:1}),v("div",xe,[l(ie,{ref_key:"avatarField",ref:z,id:"avatar",name:"avatar",label:"Avatar",modelValue:e.avatar.value,"onUpdate:modelValue":a[25]||(a[25]=t=>e.avatar.value=t),error:e.avatar.error,"onUpdate:error":a[26]||(a[26]=t=>e.avatar.error=t),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["modelValue","error"])])])]),_:1},8,["isOpen","title","confirm-text","confirm-loading","confirm-props"]))}});export{je as _};
