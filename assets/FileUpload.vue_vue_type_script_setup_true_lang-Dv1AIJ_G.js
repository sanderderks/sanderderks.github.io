import{M as $,bQ as j,bR as D,bS as I,aS as t,q as g,ck as L,c4 as N,bC as T,aK as o,u as d,b9 as b,t as i,v as c,s as h,au as q,a4 as z,ar as A,cl as E}from"../bundle.js";import{a as K}from"./TextField.vue_vue_type_script_setup_true_lang-R63U0JUS.js";import{_ as M}from"./validation-Bf-E2UlI.js";const O={class:"m-4"},Q=["for"],G={class:"flex justify-between gap-1"},H=["id","disabled"],J={key:2},W={class:"flex justify-center"},X=["src"],ee=$({__name:"FileUpload",props:{id:{},name:{},label:{},modelValue:{},error:{},isPublic:{type:Boolean},blogPost:{},imageProps:{},imageContainerProps:{}},emits:["update:modelValue","update:error"],setup(_,{expose:y,emit:k}){const l=_,{firebaseUser:f}=j(D()),{fetchFileInfo:w,uploadFile:P,deleteFile:V}=I(),v=t(),s=t(null),n=t(0),r=g(()=>L(l.modelValue||"uploads/"+N())),F=g(()=>r.value.name),u=t(),m=t(""),U=e=>{const a=e.target;a.files&&a.files.length>0&&(s.value=a.files[0],m.value=s.value.name,C())},C=async()=>{var e,a;s.value&&((e=f.value)!=null&&e.uid)&&await P(r.value,s.value,B=>n.value=B,m.value,(a=f.value)==null?void 0:a.uid,l.isPublic,l.blogPost)&&(p("update:modelValue",await E(r.value)),s.value=null,n.value=0)},R=async()=>{await V(r.value)?(window.URL.revokeObjectURL(l.modelValue),v.value.value=null,p("update:modelValue","")):p("update:error","Failed to delete File reference")},S=()=>{};T(()=>l.modelValue,async()=>{var e;u.value=l.modelValue?await w(F.value):void 0,m.value=((e=u.value)==null?void 0:e.name)??""},{immediate:!0});const p=k;return y({test:S}),(e,a)=>(o(),d("div",O,[e.label?(o(),d("label",{key:0,class:"block text-sm font-bold mb-2",for:`${e.id}`},b(e.label),9,Q)):i("",!0),c("div",G,[c("input",{id:`${e.id}`,ref_key:"fileUpload",ref:v,type:"file",accept:"image/*",onChange:U,class:"p-input",disabled:!!u.value},null,40,H),e.modelValue?(o(),h(K,{key:0,onClick:R})):i("",!0)]),e.error?(o(),h(M,{key:1,name:e.name,error:e.error},null,8,["name","error"])):i("",!0),n.value>0?(o(),d("div",J,"Uploading: "+b(n.value.toFixed(2))+"%",1)):i("",!0),c("div",W,[c("div",q(z(e.imageContainerProps)),[u.value?(o(),d("img",A({key:0,class:"p-input-file mt-4 w-full min-w-25 md:max-w-fit",src:e.modelValue},e.imageProps),null,16,X)):i("",!0)],16)])]))}});export{ee as _};
