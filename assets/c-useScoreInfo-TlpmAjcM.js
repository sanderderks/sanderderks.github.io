import{_ as G}from"./c-Bubble.vue_vue_type_script_setup_true_lang-iHAaGDxw.js";import{e as N,A as V,aG as x,s as y,r as H,c as p,o as A,as as C,M as L,l as n,m as a,p as t,t as i,w as g,O as T,H as l,G as b,k as D,C as $,n as M,h as R}from"../bundle.js";import{_ as j}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"w-full overflow-x-auto"},F={class:"w-full mt-5 text-sm md:text-base text-left text-nowrap"},O={key:0},q={key:1},z={key:0},J={key:1},K={key:1},Q={key:2},W={class:"mt-5 flex justify-center"},X=N({__name:"Highscores",props:{gameId:{},unit:{}},setup(c){const h=c,_=V(),d=x(h.gameId)(),{publicUsers:k}=y(_),{allGameData:f,fetchLoading:v}=y(d),{fetchGameData:r,fetchHighscores:S,fetchScores:I}=d,s=H("highscores"),w=H(),u=p(()=>f.value[h.gameId].gameData[s.value]),B=m=>{var o;return((o=k.value.find(e=>e.id===m))==null?void 0:o.displayName)??"Unknown"},P=()=>{s.value==="highscores"?S():I()};return A(()=>{r(),w.value=setInterval(()=>{r()},1e3*60*5)}),C(()=>{clearInterval(w.value)}),L(s,()=>{f.value[h.gameId].gameData[s.value].length||P()}),(m,o)=>(n(),a(g,null,[t("div",E,[t("table",F,[t("thead",null,[t("tr",null,[o[1]||(o[1]=t("th",null,"Rank",-1)),o[2]||(o[2]=t("th",null,"User",-1)),o[3]||(o[3]=t("th",null,"Score",-1)),u.value.length&&u.value.some(e=>e.difficulty)?(n(),a("th",O,"Difficulty")):i("",!0),o[4]||(o[4]=t("th",null,"Date",-1)),u.value.length&&u.value.some(e=>e.bonus)?(n(),a("th",q,"Bonus")):i("",!0)])]),t("tbody",null,[u.value.length?(n(!0),a(g,{key:0},T(u.value,(e,U)=>(n(),a("tr",null,[t("th",null,l(U+1),1),t("th",null,l(B(e.userId??e.id)),1),t("td",null,[b(l(e.score)+" ",1),m.unit?(n(),a(g,{key:0},[b(l(m.unit),1),e.score!==1?(n(),a(g,{key:0},[b("s")],64)):i("",!0)],64)):i("",!0)]),e.difficulty?(n(),a("td",z,l(e.difficulty),1)):i("",!0),t("td",null,l(D($)(e.date)),1),e.bonus?(n(),a("td",J,l(e.bonus),1)):i("",!0)]))),256)):D(v)?(n(),a("tr",K,o[5]||(o[5]=[t("th",null,"Loading highscores...",-1)]))):(n(),a("tr",Q,[t("th",null,"There are no "+l(s.value==="highscores"?"highscores":"scores")+" yet.",1)]))])])]),t("div",W,[M(G,{class:"w-full md:w-1/2",label:`View ${s.value==="highscores"?"All Scores":"Highscores"}`,type:"secondary",onClick:o[0]||(o[0]=e=>s.value==="highscores"?s.value="scores":s.value="highscores")},null,8,["label"])])],64))}}),te=j(X,[["__scopeId","data-v-a3e7a956"]]),se=c=>{const h=R(),_=x(c)(),{allGameData:d,highscorePosition:k,personalBest:f}=y(_),{firebaseUser:v}=y(h),r=p(()=>v.value?k.value:null),S=p(()=>{const s=d.value[c].previousHighscorePosition;return r.value&&s?s>r.value:!1}),I=p(()=>{const s=d.value[c].previousPersonalBest;return v.value&&s?s<f.value:!1});return{currentHighscorePosition:r,hasImprovedHighscorePosition:S,hasImprovedPersonalBest:I}};export{te as H,se as u};
