import{d as N,a as J,g as n,m as u,j as t,l as c,y as Z,A as p,a3 as v,q as i,h as l,R as K,_ as m,aY as R,aZ as Q,C as b,k as C,N as _,I as g,w as D,f as k,aD as W,v as X,aV as U,s as P,o as j,ax as x,L as ee,E as se,x as te,z as le,c as oe}from"../bundle.js";import{_ as ae}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";const ne={key:0,class:"flex flex-wrap gap-3 mt-3 justify-center"},He=N({__name:"AddToLeaderboard",props:{isLoggedIn:{type:Boolean},isSolo:{type:Boolean},isGameOver:{type:Boolean},finalScore:{},personalBest:{},redirectRoute:{},showIf:{type:Boolean}},emits:["updateHighscore"],setup(y){const o=J();return(s,e)=>s.isGameOver?(t(),n("div",ne,[s.isLoggedIn?s.showIf!==!1&&s.isSolo&&s.finalScore>s.personalBest?(t(),c(m,{key:1,class:"w-full md:w-1/2",variant:"primary",onClick:e[1]||(e[1]=d=>s.$emit("updateHighscore"))},{default:p(()=>e[4]||(e[4]=[v(" Add To Leaderboard ")])),_:1,__:[4]})):u("",!0):(t(),c(Z,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:p(()=>[e[2]||(e[2]=v(" Please ")),i("a",{class:"cursor-pointer",onClick:e[0]||(e[0]=d=>l(o).push({name:l(K).LOGIN,params:{redirect:JSON.stringify({name:s.redirectRoute})}}))}," Login "),e[3]||(e[3]=v(" to add your score to the leaderboard. "))]),_:1,__:[2,3]}))])):u("",!0)}}),re={class:"mt-5 flex flex-wrap flex-col md:flex-row gap-3 justify-center"},Ie=N({__name:"GameActions",props:R({hasSolo:{type:Boolean},isSolo:{type:Boolean},hasMultiplayer:{type:Boolean},isMultiplayer:{type:Boolean},isOwner:{type:Boolean},isMainMenu:{type:Boolean},hasGameStarted:{type:Boolean},isGameOver:{type:Boolean}},{isViewingHighscores:{type:Boolean,required:!0},isViewingHighscoresModifiers:{}}),emits:R(["playSolo","playMultiplayer","goBack","restart"],["update:isViewingHighscores"]),setup(y){const o=Q(y,"isViewingHighscores");return(s,e)=>(t(),n("div",re,[s.isMainMenu?(t(),n(b,{key:0},[C(l(_),{class:"w-full md:w-1/2"},{default:p(()=>[s.hasSolo&&!o.value?(t(),c(m,{key:0,class:"w-full",onClick:e[0]||(e[0]=d=>s.$emit("playSolo"))},{default:p(()=>e[8]||(e[8]=[v(" Play Solo ")])),_:1,__:[8]})):u("",!0),s.hasMultiplayer&&!o.value?(t(),c(m,{key:1,class:"w-full",variant:"purple",onClick:e[1]||(e[1]=d=>s.$emit("playMultiplayer"))},{default:p(()=>e[9]||(e[9]=[v(" Play Online ")])),_:1,__:[9]})):u("",!0)]),_:1}),C(m,{class:"w-full md:w-1/2",variant:"neutral",onClick:e[2]||(e[2]=d=>o.value=!o.value)},{default:p(()=>[v(g(o.value?s.isGameOver?"View Your Score":"Go Back":"View Highscores"),1)]),_:1})],64)):s.isGameOver?s.isGameOver?(t(),n(b,{key:2},[o.value?u("",!0):(t(),c(m,{key:0,class:"w-full md:w-1/2",variant:s.isOwner?"danger":"green",onClick:e[5]||(e[5]=d=>s.$emit("restart"))},{default:p(()=>[v(g(s.isOwner?"Delete and Play Again":"Play Again"),1)]),_:1},8,["variant"])),C(m,{class:"w-full md:w-1/2",variant:"neutral",onClick:e[6]||(e[6]=d=>o.value=!o.value)},{default:p(()=>[v(g(o.value?s.isGameOver?"View Your Score":"Go Back":"View Highscores"),1)]),_:1}),s.isMultiplayer&&s.isOwner?(t(),c(m,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:e[7]||(e[7]=d=>s.$emit("goBack"))},{default:p(()=>e[12]||(e[12]=[v(" Go Back ")])),_:1,__:[12]})):u("",!0)],64)):u("",!0):(t(),n(b,{key:1},[s.hasGameStarted?(t(),c(m,{key:0,class:"w-full md:w-1/2",variant:"danger",onClick:e[3]||(e[3]=d=>s.$emit("restart"))},{default:p(()=>e[10]||(e[10]=[v(" Restart ")])),_:1,__:[10]})):u("",!0),!s.hasGameStarted||s.isMultiplayer?(t(),c(m,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:e[4]||(e[4]=d=>s.$emit("goBack"))},{default:p(()=>e[11]||(e[11]=[v(" Go Back ")])),_:1,__:[11]})):u("",!0)],64))]))}}),ie=(y,o)=>{const s=D(0),e=k(()=>W(y)),d=k(()=>(s.value+1)*o),$=k(()=>d.value-o),B=k(()=>s.value>0),h=k(()=>e.value.length>d.value),G=k(()=>e.value.filter((f,H)=>H>=$.value&&H<d.value));return{page:s,perPage:o,visibleData:G,hasPrevious:B,hasNext:h,$reset:()=>{s.value=0}}},ue={class:"mt-5 flex flex-col items-center"},de={class:"w-full overflow-x-auto"},fe={class:"w-full mt-5 text-sm md:text-base text-left text-nowrap"},ve={key:0},me={key:0},ye={key:1},pe={key:1},ge={key:0},ce={key:1},ke={key:2},we={key:3},he={key:2},$e={key:3},Be={key:4},Se={colspan:"100%"},be=N({__name:"Highscores",props:{gameId:{},unit:{}},setup(y){const o=y,s=X(),e=U(),{publicUsers:d}=P(s),{allGameData:$,fetchLoading:B}=P(e),{fetchGameData:h,fetchHighscores:G,fetchScores:I}=e,f=D("highscores"),H=D(),T=k(()=>$.value[o.gameId].gameData[f.value]),{page:M,perPage:E,visibleData:w,hasPrevious:V,hasNext:L,$reset:Y}=ie(()=>T.value,10),q=S=>{var a;return((a=d.value.find(r=>r.id===S))==null?void 0:a.displayName)??"Unknown"},A=S=>{Y(),f.value=S},z=()=>{f.value==="highscores"?G():I()};return j(()=>{e.$init(o.gameId),h(),H.value=setInterval(()=>{h()},1e3*60*5)}),x(()=>{clearInterval(H.value)}),ee(f,()=>{$.value[o.gameId].gameData[f.value].length||z()}),(S,a)=>(t(),n("div",ue,[C(l(_),{class:"w-full md:w-1/2"},{default:p(()=>[C(m,{class:"w-full",variant:"secondary",outlined:f.value==="scores",label:"Highscores",onClick:a[0]||(a[0]=r=>A("highscores"))},null,8,["outlined"]),C(m,{class:"w-full",variant:"secondary",outlined:f.value==="highscores",label:"All Scores",onClick:a[1]||(a[1]=r=>A("scores"))},null,8,["outlined"])]),_:1}),i("div",de,[i("table",fe,[l(w).length?(t(),n("thead",ve,[i("tr",null,[a[4]||(a[4]=i("th",null,"Rank",-1)),a[5]||(a[5]=i("th",null,"User",-1)),a[6]||(a[6]=i("th",null,"Score",-1)),l(w).length&&l(w).some(r=>r.difficulty)?(t(),n("th",me,"Difficulty")):u("",!0),a[7]||(a[7]=i("th",null,"Date",-1)),l(w).length&&l(w).some(r=>r.bonus)?(t(),n("th",ye,"Bonus")):u("",!0)])])):u("",!0),l(w).length?(t(),n("tbody",pe,[(t(!0),n(b,null,se(l(w),(r,F)=>(t(),n("tr",null,[i("th",null,g(F+1+l(M)*l(E)),1),i("th",null,g(q(r.userId??r.id)),1),i("td",null,[v(g(r.score)+" ",1),S.unit?(t(),n(b,{key:0},[v(g(S.unit),1),r.score!==1?(t(),n(b,{key:0},[v("s")],64)):u("",!0)],64)):u("",!0)]),r.difficulty?(t(),n("td",ge,g(r.difficulty),1)):l(w).some(O=>O.difficulty)?(t(),n("td",ce)):u("",!0),i("td",null,g(l(te)(r.date)),1),r.bonus?(t(),n("td",ke,g(r.bonus),1)):l(w).some(O=>O.bonus)?(t(),n("td",we)):u("",!0)]))),256))])):l(B)?(t(),n("tbody",he,a[8]||(a[8]=[i("tr",null,[i("th",null,"Loading highscores...")],-1)]))):(t(),n("tbody",$e,[i("tr",null,[i("th",null,"There are no "+g(f.value==="highscores"?"highscores":"scores")+" yet.",1)])])),l(V)||l(L)?(t(),n("tfoot",Be,[i("tr",null,[i("td",Se,[i("div",{class:le(["w-full p-2 flex",[l(V)?"justify-between":"justify-end"]])},[l(V)?(t(),c(m,{key:0,class:"w-fit",label:"Previous",variant:"neutral",onClick:a[2]||(a[2]=r=>M.value-=1)})):u("",!0),l(L)?(t(),c(m,{key:1,class:"w-fit",label:"Next",variant:"neutral",onClick:a[3]||(a[3]=r=>M.value+=1)})):u("",!0)],2)])])])):u("",!0)])])]))}}),Pe=ae(be,[["__scopeId","data-v-b42fb3e6"]]),Me=y=>{const o=oe(),s=U(),{allGameData:e,highscorePosition:d,personalBest:$}=P(s),{firebaseUser:B}=P(o),h=k(()=>B.value?d.value:null),G=k(()=>{if(!y)return!1;const f=e.value[y].previousHighscorePosition;return h.value&&f?f>h.value:!1}),I=k(()=>{if(!y)return!1;const f=e.value[y].previousPersonalBest;return B.value&&f?f<$.value:!1});return j(()=>{s.$init(y)}),{currentHighscorePosition:h,hasImprovedHighscorePosition:G,hasImprovedPersonalBest:I}};export{Pe as H,Ie as _,He as a,Me as u};
