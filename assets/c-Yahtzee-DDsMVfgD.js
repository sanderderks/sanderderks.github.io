import{d as te,aQ as de,v as ye,c as ve,s as W,f as w,o as ce,g as s,j as l,k as y,l as I,m as d,h as e,C as g,w as Q,L as Se,q as c,I as _,_ as N,A as k,a3 as O,aR as A,E as j,aS as oe,ax as me,z as q,a as _e,y as ie,a7 as pe,R as Ie}from"../bundle.js";import{u as ue,s as we,G as r,S as b,_ as ke}from"./c-Dice.vue_vue_type_script_setup_true_lang-DAA8KLYB.js";import{_ as re,a as Oe}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-wWpAWb7S.js";import{_ as Ne}from"./c-GameChat.vue_vue_type_script_setup_true_lang-BHc_8rRc.js";import{_ as ge}from"./c-GameSettingsDialog.vue_vue_type_script_setup_true_lang-B7V19gF1.js";import{u as Ee,H as Ae}from"./c-useScoreInfo-BCYDvVMj.js";import{_ as fe}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import"./c-Dice5.vue_vue_type_script_setup_true_lang-DK-8hWiG.js";import"./c-Dice6.vue_vue_type_script_setup_true_lang-CbzU1YFL.js";import"./c-Dialog.vue_vue_type_script_setup_true_lang-CWtsg3qw.js";const He=te({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(ee,{emit:D}){const C=D,H=de(),m=ye(),R=ve(),{onlineGames:$,onlineGamesLoading:S}=W(H),{onlineUsers:U}=W(m),{firebaseUser:p}=W(R),{getPlayerDisplayName:o}=H,F=w(()=>{var u;return(u=p.value)==null?void 0:u.uid}),x=w(()=>$.value.filter(u=>u.players.find(i=>i.userId===F.value))),Y=w(()=>U.value.filter(u=>u.id!==F.value&&!x.value.some(i=>i.players.some(a=>a.userId===u.id)))),G=w(()=>x.value.filter(u=>!u.maxPlayers)),f=w(()=>$.value.filter(u=>(u.maxPlayers??0)>2)),V=u=>{const i=f.value.find(a=>a.id===u);return(i==null?void 0:i.players.find(a=>a.userId===F.value))!==void 0},T=u=>{const i=f.value.find(a=>a.id===u);return i&&i.maxPlayers&&i.players.length<i.maxPlayers||!1},L=(u,i)=>{const a=G.value.find(v=>v.players.some(B=>B.userId===u));i?C("createParty",u):a?C("continueOnlineGame",a.id):C("createOnlineGame",u)},E=u=>{C("joinParty",u)};return ce(async()=>{await H.fetchOnlineGames()}),(u,i)=>(l(),s(g,null,[y(re,{title:"Choose 1v1 opponent",listOfUsers:Y.value,"custom-click-action":"","get-color":a=>{var v;return e(S)||a===((v=e(p))==null?void 0:v.uid)?"bg-neutral-500":"bg-green-500"},isClickable:a=>{var v;return!e(S)&&a!==((v=e(p))==null?void 0:v.uid)},onClick:i[0]||(i[0]=a=>L(a))},null,8,["listOfUsers","get-color","isClickable"]),G.value.length?(l(),I(re,{key:0,title:"Active 1v1s",listOfUsers:G.value.flatMap(a=>a.players.filter(v=>{var B;return v.userId!==((B=e(p))==null?void 0:B.uid)}).map(v=>({id:v.userId}))),"custom-click-action":"","get-color":()=>e(S)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!e(S),onClick:i[1]||(i[1]=a=>L(a))},null,8,["listOfUsers","get-color","isClickable"])):d("",!0),u.allowParty?(l(),s(g,{key:1},[y(re,{title:"Create party",listOfUsers:Y.value.map(a=>({id:a.id})),"custom-click-action":"","get-color":a=>{var v;return e(S)||a===((v=e(p))==null?void 0:v.uid)?"bg-neutral-500":"bg-green-500"},isClickable:a=>{var v;return!e(S)&&a!==((v=e(p))==null?void 0:v.uid)},onClick:i[2]||(i[2]=a=>L(a,!0))},null,8,["listOfUsers","get-color","isClickable"]),f.value.length?(l(),I(Oe,{key:0,title:"Active parties",list:f.value.map(a=>({id:a.id,label:a.players.map(v=>e(o)(v.userId)).join(", ")})),"custom-click-action":"","get-color":a=>e(S)?"bg-neutral-500":V(a)?"bg-purple-500 bg-opacity-50":T(a)?"bg-yellow-500 bg-opacity-50":"bg-red-500 bg-opacity-50",isClickable:a=>!e(S)&&(V(a)||T(a)),onClick:i[3]||(i[3]=a=>E(a))},null,8,["list","get-color","isClickable"])):d("",!0)],64)):d("",!0)],64))}}),Te={class:"h-10"},he={class:"w-1/2 md:w-1/3"},be={key:0},Pe={key:1,class:"!ps-1 md:ps-1"},Ce={key:2},xe={key:0},Ge={key:1},De={key:2},Re=te({__name:"ScoreCell",props:{row:{},hasValue:{type:[Number,Boolean]}},setup(ee){const D=ee,C=ue(),{gameType:H,gameStatus:m,activePlayerId:R,myPlayerId:$,onlineGameOpponents:S,reroll:U}=W(C),{selectScore:p,getScore:o,getActualValue:F}=C,x=Q(!1),Y=we[D.row],G=w(()=>o(D.row,$.value)),f=w(()=>F(D.row,D.hasValue)),V=w(()=>f.value===!1?"X":f.value);return Se(()=>f.value,()=>{x.value=!0,setTimeout(()=>{x.value=!1})}),(T,L)=>(l(),s("tr",Te,[c("th",he,_(e(Y).title),1),G.value?(l(),s("td",be,_(G.value.value===!1?"X":G.value.value),1)):e(R)===e($)&&e(U)>=0&&!x.value?(l(),s("td",Pe,[y(N,{class:"size-8",variant:f.value===!1||f.value===0?"neutral":void 0,onClick:L[0]||(L[0]=E=>e(p)(T.row,f.value))},{default:k(()=>[O(_(V.value),1)]),_:1},8,["variant"])])):(l(),s("td",Ce)),e(H)===e(A).ONLINE?(l(!0),s(g,{key:3},j(e(S),E=>(l(),s(g,null,[e(o)(T.row,E.userId)?(l(),s("td",xe,_(e(o)(T.row,E.userId).value===!1?"X":e(o)(T.row,E.userId).value),1)):e(R)===E.userId&&e(m)>e(r).HAS_STARTED?(l(),s("td",Ge,[y(N,{class:"size-8",variant:f.value===!1||f.value===0?"neutral":"danger"},{default:k(()=>[O(_(V.value),1)]),_:1},8,["variant"])])):(l(),s("td",De))],64))),256)):d("",!0)]))}}),P=fe(Re,[["__scopeId","data-v-3b0f70c2"]]),$e={key:0,class:"text-white"},Fe={key:3,class:"h-12 md:h-auto text-red-500"},Le={class:"h-12 md:h-auto text-pink-500"},Be={key:0,class:"text-purple-500 font-bold"},Ue={key:1,class:"text-red-500 font-bold"},Ve={key:2,class:"text-green-500 font-bold"},je={key:0,class:"h-12 md:h-auto text-red-500 font-bold"},Ye=te({__name:"Scoreboard",setup(ee){const D=ue(),C=de(),{gameType:H,gameStatus:m,myPlayerId:R,bonus:$,hasOfValue:S,hasThreeOfAKind:U,hasFourOfAKind:p,hasFullHouse:o,hasSmallStraight:F,hasLargeStraight:x,hasYahtzee:Y,diceTotal:G,scoreTotalOf:f,score:V,finalScore:T}=W(D),{onlineGamePlayers:L,onlineGameOpponents:E}=W(C),{currentHighscorePosition:u,hasImprovedHighscorePosition:i,hasImprovedPersonalBest:a}=Ee(oe.YAHTZEE),v=Q(),B=Q(!1),le=w(()=>S.value(1)),ae=w(()=>S.value(2)),se=w(()=>S.value(3)),M=w(()=>S.value(4)),h=w(()=>S.value(5)),X=w(()=>S.value(6)),Z=w(()=>f.value("top")),ne=w(()=>f.value("bottom")),K=w(()=>L.value.map(z=>T.value[z.userId]===Math.max(...Object.values(T.value))?{...z,isWinner:!0}:{player:z,isWinner:!1})),J=w(()=>K.value.filter(z=>z.isWinner).length>1);return ce(()=>{v.value=setInterval(()=>{B.value=!B.value},500)}),me(()=>{clearInterval(v.value)}),(z,t)=>(l(),s("table",{class:q(["w-full mt-5 text-sm md:text-base text-left",e(m)===e(r).HAS_FINISHED?"text-neutral-500":"text-white",e(m)===e(r).HAS_NOT_STARTED?B.value?"even":"odd":void 0])},[e(H)===e(A).ONLINE?(l(),s("thead",$e,[c("tr",null,[t[0]||(t[0]=c("th",null,null,-1)),t[1]||(t[1]=c("th",null,"You",-1)),(l(!0),s(g,null,j(e(E),n=>(l(),s("th",{key:n.userId,class:q(n.isOnline?"text-green-400":"text-red-400")},_(e(D).getPlayerDisplayName(n.userId)),3))),128))])])):d("",!0),c("tbody",null,[y(P,{row:e(b).ONES,"has-value":le.value},null,8,["row","has-value"]),y(P,{row:e(b).TWOS,"has-value":ae.value},null,8,["row","has-value"]),y(P,{row:e(b).THREES,"has-value":se.value},null,8,["row","has-value"]),y(P,{row:e(b).FOURS,"has-value":M.value},null,8,["row","has-value"]),y(P,{row:e(b).FIVES,"has-value":h.value},null,8,["row","has-value"]),y(P,{row:e(b).SIXES,"has-value":X.value},null,8,["row","has-value"]),e(m)>=e(r).HAS_FINISHED?(l(),s("tr",{key:0,class:q(["h-12 md:h-auto",e(m)===e(r).HAS_FINISHED?"text-white":"text-neutral-500"])},[t[2]||(t[2]=c("th",null,"TOP",-1)),c("td",null,_(e(m)>=e(r).HAS_STARTED?Z.value:""),1),e(H)===e(A).ONLINE?(l(!0),s(g,{key:0},j(e(E),n=>(l(),s("td",null,_(e(m)>=e(r).HAS_STARTED?e(f)("top",n.userId):""),1))),256)):d("",!0)],2)):d("",!0),e(m)>e(r).HAS_NOT_STARTED&&Object.keys(e(V)).some(n=>e(f)("top",n)>=63)?(l(),s("tr",{key:1,class:q(["h-12 md:h-auto",e(m)===e(r).HAS_FINISHED?Z.value>=63?"text-yellow-500":"text-white":"text-neutral-500"])},[t[3]||(t[3]=c("th",null,"BONUS",-1)),c("td",null,_(Z.value>=63?35:e(m)===e(r).HAS_FINISHED?"X":""),1),e(H)===e(A).ONLINE?(l(!0),s(g,{key:0},j(e(E),n=>(l(),s("td",null,_(e(f)("top",n.userId)>=63?35:e(m)===e(r).HAS_FINISHED?"X":""),1))),256)):d("",!0)],2)):d("",!0),y(P,{row:e(b).THREE_OF_A_KIND,"has-value":e(U)},null,8,["row","has-value"]),y(P,{row:e(b).FOUR_OF_A_KIND,"has-value":e(p)},null,8,["row","has-value"]),y(P,{row:e(b).FULL_HOUSE,"has-value":e(o)},null,8,["row","has-value"]),y(P,{row:e(b).SMALL_STRAIGHT,"has-value":e(F)},null,8,["row","has-value"]),y(P,{row:e(b).LARGE_STRAIGHT,"has-value":e(x)},null,8,["row","has-value"]),y(P,{row:e(b).YAHTZEE,"has-value":e(Y)},null,8,["row","has-value"]),y(P,{row:e(b).CHANCE,"has-value":e(G)},null,8,["row","has-value"]),e(m)>=e(r).HAS_FINISHED?(l(),s("tr",{key:2,class:q(["h-12 md:h-auto",e(m)===e(r).HAS_FINISHED?"text-white":"text-neutral-500"])},[t[4]||(t[4]=c("th",null,"BOTTOM",-1)),c("td",null,_(e(m)>=e(r).HAS_STARTED?ne.value:""),1),e(H)===e(A).ONLINE?(l(!0),s(g,{key:0},j(e(E),n=>(l(),s("td",null,_(e(m)>=e(r).HAS_STARTED?e(f)("bottom",n.userId):""),1))),256)):d("",!0)],2)):d("",!0),Object.values(e($)).some(n=>n>=100)?(l(),s("tr",Fe,[t[5]||(t[5]=c("th",null,"YAHTZEE BONUS",-1)),c("td",null,_(e($)[e(R)]),1),e(H)===e(A).ONLINE?(l(!0),s(g,{key:0},j(e(E),n=>(l(),s("td",null,_(e($)[n.userId]),1))),256)):d("",!0)])):d("",!0),e(m)===e(r).HAS_FINISHED?(l(),s(g,{key:4},[c("tr",Le,[t[6]||(t[6]=c("th",null,"TOTAL",-1)),c("td",null,[O(_(e(T)[e(R)])+" ",1),e(i)&&e(u)===1?(l(),s("span",Be," HIGHSCORE! ")):e(i)?(l(),s("span",Ue," LEADERBOARD IMPROVEMENT! ")):e(a)?(l(),s("span",Ve," PERSONAL BEST! ")):d("",!0)]),e(H)===e(A).ONLINE?(l(!0),s(g,{key:0},j(e(E),n=>(l(),s("td",null,_(e(T)[n.userId]),1))),256)):d("",!0)]),e(H)===e(A).ONLINE?(l(),s("tr",je,[t[7]||(t[7]=c("td",null,null,-1)),(l(!0),s(g,null,j(K.value,n=>(l(),s("td",null,_(n.isWinner?J.value?"TIE!":"WINNER!":""),1))),256))])):d("",!0)],64)):d("",!0)])],2))}}),We=fe(Ye,[["__scopeId","data-v-34b2856b"]]),ze={class:"h-fit flex flex-row-reverse md:flex-col gap-3"},Me={class:"flex flex-wrap justify-center gap-3"},Xe={key:1,class:"w-full"},Ze={class:"flex justify-center"},Ke={key:2,class:"w-full flex flex-col md:flex-row gap-3 justify-center"},Je={class:"w-full md:w-1/2 flex justify-center gap-3"},qe={class:"w-full md:w-1/2 flex justify-center gap-3"},Qe={class:"mt-5 flex flex-col md:flex-row gap-3 justify-center"},et={key:3,class:"flex flex-wrap gap-3 mt-3 justify-center"},vt=te({__name:"Yahtzee",setup(ee){const D=_e(),C=ue(),H=ve(),{onlineGameId:m,onlineGameChat:R,onlineGamePlayers:$,maxPlayers:S,isOnlineGameOwner:U,gameType:p,gameStatus:o,activePlayerId:F,myPlayerId:x,canRoll:Y,canReroll:G,dices:f,finalScore:V,personalBest:T}=W(C),{firebaseUser:L}=W(H),{start:E,$reset:u,createOnlineGame:i,continueOnlineGame:a,leaveOnlineGame:v,deleteOnlineGame:B,getPlayerDisplayName:le,roll:ae,updateYahtzeeHighscore:se}=C,M=Q(!1),h=Q(!1),X=w(()=>S.value?S.value-$.value.length:0),Z=()=>{h.value=!1,u()},ne=()=>{h.value=!1,p.value=A.SOLO,E()},K=async()=>{m.value&&await v(),u()},J=async()=>{h.value=!1,m.value&&(U.value?await B():await v()),u()};return me(async()=>{m.value&&(await v(),u())}),(z,t)=>(l(),I(ie,{class:"!bg-cyan-800 !bg-opacity-50 my-5 !rounded-secondary",title:"Yahtzee",description:e(p)===e(A).SOLO?e(o)===e(r).HAS_NOT_STARTED?"Play solo or with a friend.":"Play solo.":"Play with a friend."},{right:k(()=>[c("div",ze,[y(N,{class:"border-none h-fit",variant:"neutral",icon:"pi pi-cog",onClick:t[0]||(t[0]=n=>M.value=!0)}),e(U)&&e(o)!==e(r).HAS_FINISHED?(l(),I(N,{key:0,variant:"danger",icon:"pi pi-trash",onClick:J})):d("",!0)])]),default:k(()=>[c("div",Me,[e(o)===e(r).HAS_NOT_STARTED?(l(),s(g,{key:0},[y(N,{class:"w-full md:w-1/2",onClick:ne},{default:k(()=>t[12]||(t[12]=[O(" Play Solo ")])),_:1,__:[12]}),y(N,{class:"w-full md:w-1/2",variant:"purple",onClick:t[1]||(t[1]=()=>{o.value=e(r).FINDING_OPPONENT,p.value=e(A).ONLINE})},{default:k(()=>t[13]||(t[13]=[O(" Play Online ")])),_:1,__:[13]}),e(o)===e(r).HAS_NOT_STARTED&&!h.value?(l(),I(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:t[2]||(t[2]=n=>h.value=!0)},{default:k(()=>t[14]||(t[14]=[O(" View Highscores ")])),_:1,__:[14]})):e(o)===e(r).HAS_NOT_STARTED?(l(),I(N,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:t[3]||(t[3]=n=>h.value=!1)},{default:k(()=>t[15]||(t[15]=[O(" Go Back ")])),_:1,__:[15]})):d("",!0)],64)):e(o)===e(r).FINDING_OPPONENT?(l(),s("div",Xe,[y(He,{"allow-party":"",onCreateOnlineGame:t[4]||(t[4]=n=>e(i)([{userId:n}])),onContinueOnlineGame:e(a),onCreateParty:t[5]||(t[5]=n=>e(i)([{userId:n}],3)),onJoinParty:e(a)},null,8,["onContinueOnlineGame","onJoinParty"]),c("div",Ze,[y(N,{class:"w-full md:w-1/2",variant:"neutral",onClick:K},{default:k(()=>t[16]||(t[16]=[O(" Go Back ")])),_:1,__:[16]})])])):e(o)!==e(r).HAS_FINISHED?(l(),s("div",Ke,[c("div",Je,[e(p)===e(A).ONLINE||e(Y)||e(G)?(l(),I(N,{key:0,class:"w-full",variant:"tertiary",disabled:e(F)!==e(x)||e(o)===e(r).HAS_CHOSEN_DICES||e(o)===e(r).WAITING_FOR_OPPONENTS||e(f).every(n=>n.selected),onClick:e(ae)},{default:k(()=>[O(_(X.value?`Waiting for ${X.value} more player${X.value!==1?"s":""}`:e(F)!==e(x)?`${e(le)(e(F))}'s turn`:e(G)?"Reroll":"Roll"),1)]),_:1},8,["disabled","onClick"])):d("",!0)]),c("div",qe,[(l(!0),s(g,null,j(e(f),n=>(l(),I(ke,{key:n.id,dice:n},null,8,["dice"]))),128))])])):d("",!0)]),h.value?(l(),I(Ae,{key:0,"game-id":e(oe).YAHTZEE},null,8,["game-id"])):!h.value&&e(o)!==e(r).FINDING_OPPONENT?(l(),I(We,{key:1})):d("",!0),e(p)===e(A).ONLINE&&e(o)>=e(r).HAS_STARTED?(l(),I(Ne,{key:2,chats:e(R)??[],onSendChat:t[6]||(t[6]=n=>R.value=[...e(R)??[],n])},null,8,["chats"])):d("",!0),c("div",Qe,[e(o)>=e(r).WAITING_FOR_OPPONENTS&&e(o)<=e(r).HAS_FINISHED?(l(),s(g,{key:0},[e(p)===e(A).SOLO?(l(),I(N,{key:0,class:"w-full md:w-1/2",variant:e(o)===e(r).HAS_FINISHED?"secondary":"neutral",onClick:Z},{default:k(()=>[O(_(e(o)===e(r).HAS_FINISHED?"Play Again":"Restart"),1)]),_:1},8,["variant"])):e(p)===e(A).ONLINE?(l(),s(g,{key:1},[e(U)?(l(),s(g,{key:1},[e(o)!==e(r).HAS_FINISHED?(l(),I(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:K},{default:k(()=>t[17]||(t[17]=[O(" Go Back ")])),_:1,__:[17]})):(l(),I(N,{key:1,class:"w-full md:w-1/2",variant:"danger",onClick:J},{default:k(()=>t[18]||(t[18]=[O(" Play Again ")])),_:1,__:[18]}))],64)):(l(),I(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:J},{default:k(()=>[O(_(e(o)===e(r).HAS_FINISHED?"Play Again":"Go Back"),1)]),_:1}))],64)):d("",!0)],64)):d("",!0),e(o)===e(r).HAS_FINISHED&&!h.value?(l(),I(N,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:t[7]||(t[7]=n=>h.value=!0)},{default:k(()=>t[19]||(t[19]=[O(" View Highscores ")])),_:1,__:[19]})):e(o)===e(r).HAS_FINISHED?(l(),I(N,{key:2,class:"w-full md:w-1/2",variant:"neutral",onClick:t[8]||(t[8]=n=>h.value=!1)},{default:k(()=>t[20]||(t[20]=[O(" View Your Score ")])),_:1,__:[20]})):d("",!0)]),e(o)===e(r).HAS_FINISHED?(l(),s("div",et,[e(L)?e(p)===e(A).SOLO&&e(T)<e(V)[e(x)]?(l(),I(N,{key:1,class:"w-full md:w-1/2",variant:"primary",onClick:t[10]||(t[10]=n=>e(se)())},{default:k(()=>t[23]||(t[23]=[O(" Add To Leaderboard ")])),_:1,__:[23]})):d("",!0):(l(),I(ie,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:k(()=>[t[21]||(t[21]=O(" Please ")),c("a",{class:"cursor-pointer",onClick:t[9]||(t[9]=n=>e(D).push({name:e(Ie).LOGIN,params:{redirect:JSON.stringify({name:e(pe).GAMES_YAHTZEE})}}))}," Login "),t[22]||(t[22]=O(" to add your score to the leaderboard. "))]),_:1,__:[21,22]}))])):d("",!0),y(ge,{"game-id":e(oe).YAHTZEE,"is-open":M.value,"onUpdate:isOpen":t[11]||(t[11]=n=>M.value=n)},null,8,["game-id","is-open"])]),_:1},8,["description"]))}});export{vt as default};
