import{aW as xe,bl as Pe,c as Ve,aX as Ye,aR as Be,s as L,bm as Ue,bn as J,aS as C,w as A,aQ as g,a9 as x,f as v,o as ze,L as G,b0 as Ze,b1 as We,aY as D,b2 as Me,a$ as K,aq as je,aZ as ye,d as I,g as N,j as O,q as i,l as Xe,aT as qe,h as P,z as Qe}from"../bundle.js";import{_ as Je}from"./c-Dice6.vue_vue_type_script_setup_true_lang-CbzU1YFL.js";var Ke=(l=>(l[l.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",l[l.FINDING_OPPONENT=1]="FINDING_OPPONENT",l[l.HAS_STARTED=2]="HAS_STARTED",l[l.HAS_THROWN_DICES=3]="HAS_THROWN_DICES",l[l.HAS_CHOSEN_DICES=4]="HAS_CHOSEN_DICES",l[l.HAS_FINISHED=5]="HAS_FINISHED",l))(Ke||{}),el=(l=>(l[l.ONES=0]="ONES",l[l.TWOS=1]="TWOS",l[l.THREES=2]="THREES",l[l.FOURS=3]="FOURS",l[l.FIVES=4]="FIVES",l[l.SIXES=5]="SIXES",l[l.THREE_OF_A_KIND=6]="THREE_OF_A_KIND",l[l.FOUR_OF_A_KIND=7]="FOUR_OF_A_KIND",l[l.FULL_HOUSE=8]="FULL_HOUSE",l[l.SMALL_STRAIGHT=9]="SMALL_STRAIGHT",l[l.LARGE_STRAIGHT=10]="LARGE_STRAIGHT",l[l.YAHTZEE=11]="YAHTZEE",l[l.CHANCE=12]="CHANCE",l))(el||{}),se=(l=>(l[l.PLAYER=0]="PLAYER",l[l.OPPONENT=1]="OPPONENT",l))(se||{});const ee=()=>({0:[],1:[]}),le=()=>({0:0,1:0}),te=()=>({0:0,1:0}),ll=xe("yahtzeeStore",()=>{const l=Pe(),s=Ve(),c=Ye(),d=Be(),{personalBest:w,highscorePosition:E}=L(c),{firebaseUser:S}=L(s),{onlineGames:V,onlineGamesLoading:ie,onlineGameId:Y,onlineGameCreatorId:ne,onlineGameOpponentId:B,onlineGameOpponentActive:ae,onlineGameChat:re,isInitializingOnlineGame:U,isOnlineGameOwner:z,onlineGameOpponentName:ce}=L(d),{fetchOnlineGames:ue,createOnlineGame:fe,continueOnlineGame:he,updateOnlineGame:ve,leaveOnlineGame:_e,deleteOnlineGame:me}=d,{setPreviousHighscores:Z,updateHighscores:pe,sortHighscores:ge}=c,de={onlineGames:Ue(l,J.GAME_DATA,C.YAHTZEE,J.ONLINE_GAMES)},p=A(g.SOLO),u=A(0),b=A(!1),_=A(0),m=A(-1),a=A(oe()),f=x(ee()),h=x(le()),r=x(te()),H=v(()=>a.value.some(e=>e.isRolling)),Oe=v(()=>m.value===-1&&!a.value.every(e=>e.selected)),Ee=v(()=>m.value>=0&&m.value<2&&!a.value.every(e=>e.selected)),Se=v(()=>e=>a.value.filter(t=>t.value===e).length),Ae=v(()=>q(3)),Te=v(()=>q(4)),Ie=v(()=>F(2)&&F(3)?T[8].trueValue??!1:!1),Ne=v(()=>Q(4)?T[9].trueValue??!1:!1),be=v(()=>Q(5)?T[10].trueValue??!1:!1),W=v(()=>F(5)?T[11].trueValue??!1:!1),He=v(()=>{let e=0;return a.value.forEach(t=>{e+=t.value}),e}),$=v(()=>(e,t)=>{let o=0;return f[t].filter(n=>T[n.row].section===e).forEach(n=>{n.value!==!1&&(o+=n.value)}),o});ze(()=>{c.$init(C.YAHTZEE)}),G(f,e=>{e[0].length===13&&(p.value===g.SOLO||e[1].length===13)&&(u.value=5)},{deep:!0}),G(u,e=>{if(e===5){let t=$.value("top",0);t>=63&&(h[0]+=35),t+=$.value("bottom",0),t+=h[0],r[0]=t,p.value===g.SOLO&&R(),D(ye)}}),G(()=>r[1],()=>{p.value===g.ONLINE&&r[0]>r[1]&&R()}),G([u,_,H],()=>{p.value===g.ONLINE&&(console.log("CHANGE IN LOCAL DATA DETECTED",u.value,_.value,H.value),M())},{deep:!0});const k=()=>{d.$reset(),p.value=g.SOLO,u.value=0,b.value=!1,_.value=0,m.value=-1,a.value=oe(),Object.assign(f,ee()),Object.assign(h,le()),Object.assign(r,te()),Z()},Ce=e=>{S.value&&(p.value=g.ONLINE,u.value=2,d.$init(C.YAHTZEE,y,j,k),fe(e))},Ge=e=>{p.value=g.ONLINE,d.$init(C.YAHTZEE,y,j,k),he(e)},M=()=>{console.log("updateOnlineGameCustom.1"),!(!S.value||!B.value||_.value===1&&!b.value&&!U.value)&&(console.log("updateOnlineGameCustom.2"),ve())},j=(e,t)=>({gameStatus:u.value,activePlayer:_.value===0?e:t,dices:a.value,score:{[e]:f[0],[t]:f[1]},bonus:{[e]:h[0],[t]:h[1]},finalScore:{[e]:r[0],[t]:r[1]}}),y=e=>{var o;console.log("updateLocalGameState.1");const t=(o=S.value)==null?void 0:o.uid;!t||_.value===0&&!U.value||(console.log("updateLocalGameState.2"),u.value=e.gameStatus,_.value=e.activePlayer===t?0:1,a.value=e.dices,z.value?(f[0]=e.score[e.creatorId],f[1]=e.score[e.opponentId],h[0]=e.bonus[e.creatorId],h[1]=e.bonus[e.opponentId],r[1]=e.finalScore[e.opponentId],r[0]=e.finalScore[e.creatorId]):(f[0]=e.score[e.opponentId],f[1]=e.score[e.creatorId],h[0]=e.bonus[e.opponentId],h[1]=e.bonus[e.creatorId],r[0]=e.finalScore[e.opponentId],r[1]=e.finalScore[e.creatorId]))},X=async()=>{for(;H.value;)await new Promise(e=>setTimeout(e,c.diceRollSpeed*1e3));return!0},q=e=>{for(let t=1;t<=6;t++)if(a.value.filter(o=>o.value===t).length>=e){let o=0;return a.value.forEach(n=>{o+=n.value}),o}return!1},F=e=>{for(let t=1;t<=6;t++)if(a.value.filter(o=>o.value===t).length===e)return!0;return!1},Q=e=>{let t=0,o=e;do{e:for(let n=o-e+1;n<=o;n++)if(a.value.some(Re=>Re.value===n))t++;else break e;if(t===e)return!0;t=0,o++}while(o<=6);return!1},De=()=>{u.value=2},Le=async()=>{const e=c.diceRollSpeed*1e3;m.value++,a.value.forEach(t=>{t.selected||(t.isRolling=!0,setTimeout(()=>{t.value=Ze(6),t.isRolling=!1,m.value===2&&(t.selected=!0),a.value.sort((o,n)=>o.value-n.value)},We(e,e/3)))}),await X(),u.value=3,D(Me)},we=(e,t=0)=>f[t].find(o=>o.row===e),$e=(e,t)=>{let o=t;if(o===!1)return!1;const n=T[e];return n.multiplier?o*=n.multiplier:n.trueValue&&(o=n.trueValue),o},ke=e=>{_.value===0&&m.value>=0&&m.value<2&&(e.selected=!e.selected,D(K))},Fe=(e,t)=>{if(!H.value){if(t!==!1&&W.value){const o=f[0].find(n=>n.row===11);o&&o.value!==!1&&(h[0]+=100)}f[0].push({row:e,value:t}),m.value=-1,a.value.forEach(o=>{o.selected=!1}),D(K),p.value===g.ONLINE&&(b.value=!0,u.value=4,setTimeout(async()=>{u.value=2,_.value=1,await je(),b.value=!1},c.diceRollSpeed*1e3))}},R=()=>{r[0]&&pe({gameId:Y.value??null,score:r[0],bonus:h[0]})};return{collections:de,onlineGames:V,onlineGamesLoading:ie,onlineGameId:Y,onlineGameCreatorId:ne,onlineGameOpponentId:B,onlineGameOpponentActive:ae,onlineGameChat:re,isOnlineGameOwner:z,onlineGameOpponentName:ce,gameType:p,gameStatus:u,gameStatusLoading:b,activePlayer:_,score:f,finalScore:r,bonus:h,reroll:m,dices:a,isRolling:H,canRoll:Oe,canReroll:Ee,hasOfValue:Se,hasThreeOfAKind:Ae,hasFourOfAKind:Te,hasFullHouse:Ie,hasSmallStraight:Ne,hasLargeStraight:be,hasYahtzee:W,diceTotal:He,scoreTotalOf:$,personalBest:w,highscorePosition:E,$reset:k,start:De,roll:Le,hasFinishedRolling:X,getScore:we,getActualValue:$e,selectDice:ke,selectScore:Fe,setPreviousHighscores:Z,updateYahtzeeHighscore:R,sortHighscores:ge,fetchOnlineGames:ue,createOnlineGame:Ce,continueOnlineGame:Ge,updateOnlineGame:M,leaveOnlineGame:_e,deleteOnlineGame:me}},{persist:{enabled:!0}}),oe=()=>[{id:1,value:1,selected:!1,isRolling:!1},{id:2,value:2,selected:!1,isRolling:!1},{id:3,value:3,selected:!1,isRolling:!1},{id:4,value:4,selected:!1,isRolling:!1},{id:5,value:5,selected:!1,isRolling:!1}],T={0:{title:"Ones",section:"top"},1:{title:"Twos",section:"top",multiplier:2},2:{title:"Threes",section:"top",multiplier:3},3:{title:"Fours",section:"top",multiplier:4},4:{title:"Fives",section:"top",multiplier:5},5:{title:"Sixes",section:"top",multiplier:6},6:{title:"Three of a Kind",section:"bottom"},7:{title:"Four of a Kind",section:"bottom"},8:{title:"Full House",section:"bottom",trueValue:25},9:{title:"Small Straight",section:"bottom",trueValue:30},10:{title:"Large Straight",section:"bottom",trueValue:40},11:{title:"Yahtzee",section:"bottom",trueValue:50},12:{title:"Chance",section:"bottom"}},tl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},ol=["fill"],sl=["fill"],il=I({__name:"Dice1",props:{color:{},backgroundColor:{}},setup(l){return(s,c)=>(O(),N("svg",tl,[i("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,ol),i("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,sl)]))}}),nl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},al=["fill"],rl=["fill"],cl=["fill"],ul=I({__name:"Dice2",props:{color:{},backgroundColor:{}},setup(l){return(s,c)=>(O(),N("svg",nl,[i("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,al),i("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,rl),i("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,cl)]))}}),fl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},hl=["fill"],vl=["fill"],_l=["fill"],ml=["fill"],pl=I({__name:"Dice3",props:{color:{},backgroundColor:{}},setup(l){return(s,c)=>(O(),N("svg",fl,[i("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,hl),i("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,vl),i("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,_l),i("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,ml)]))}}),gl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},dl=["fill"],Ol=["fill"],El=["fill"],Sl=["fill"],Al=["fill"],Tl=I({__name:"Dice4",props:{color:{},backgroundColor:{}},setup(l){return(s,c)=>(O(),N("svg",gl,[i("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,dl),i("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,Ol),i("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,El),i("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,Sl),i("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,Al)]))}}),Il={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Nl=["fill"],bl=["fill"],Hl=["fill"],Cl=["fill"],Gl=["fill"],Dl=["fill"],Ll=I({__name:"Dice5",props:{color:{},backgroundColor:{}},setup(l){return(s,c)=>(O(),N("svg",Il,[i("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Nl),i("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,bl),i("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,Hl),i("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,Cl),i("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,Gl),i("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,Dl)]))}}),kl=I({__name:"Dice",props:{dice:{}},setup(l){const s=ll(),{activePlayer:c}=L(s),{selectDice:d}=s,w={1:il,2:ul,3:pl,4:Tl,5:Ll,6:Je};return(E,S)=>(O(),N("div",{class:Qe(["cursor-pointer",{"animate-spin":E.dice.isRolling}])},[(O(),Xe(qe(w[E.dice.value]),{color:"black",backgroundColor:E.dice.selected?P(c)===P(se).PLAYER?"#2563eb":"#e11d48":"white",width:"40",height:"40",onClick:S[0]||(S[0]=V=>P(d)(E.dice))},null,8,["backgroundColor"]))],2))}});export{Ke as G,se as P,el as S,kl as _,T as s,ll as u};
