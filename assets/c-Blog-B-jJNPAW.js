import{_ as Be}from"./c-Dialog.vue_vue_type_script_setup_true_lang-gllcCUGl.js";import{_ as je}from"./c-Page.vue_vue_type_script_setup_true_lang-BX8gkhZ9.js";import{c as Ae,B as Ne,s as Re,a as h,o,b as P,d as S,m as z,r as Y,e as G,u as Ge,f as Ee,g as be,h as ee,i as ae,j as D,k as _,l as Ie,n as Fe,F as ze,R as J,p as t,q as u,_ as W,t as b,v as F,w as ke,x as r,y as we,z as ge,A as T,C as Q,D as ie,E as $e,G as qe,H as Z,I as de,J as He,K as Pe,L as Je,M as ye,N as ne,O as ue,P as We,Q as Te,S as te,T as Ye,U as Ve,V as Qe,W as H,X as ce,Y as Ke,Z as Ce,$ as pe,a0 as Xe,a1 as he,a2 as Ze,a3 as et,a4 as tt,a5 as me,a6 as ve,a7 as fe,a8 as lt}from"../bundle.js";import{_ as ot}from"./c-BackButton.vue_vue_type_script_setup_true_lang-C4MDoQ1O.js";import{_ as De,a as Se,u as st}from"./c-BlogPost.vue_vue_type_script_setup_true_lang-DbMDEb-x.js";var at=Ae`
    .p-card {
        background: dt('card.background');
        color: dt('card.color');
        box-shadow: dt('card.shadow');
        border-radius: dt('card.border.radius');
        display: flex;
        flex-direction: column;
    }

    .p-card-caption {
        display: flex;
        flex-direction: column;
        gap: dt('card.caption.gap');
    }

    .p-card-body {
        padding: dt('card.body.padding');
        display: flex;
        flex-direction: column;
        gap: dt('card.body.gap');
    }

    .p-card-title {
        font-size: dt('card.title.font.size');
        font-weight: dt('card.title.font.weight');
    }

    .p-card-subtitle {
        color: dt('card.subtitle.color');
    }
`,nt={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},rt=Ne.extend({name:"card",style:at,classes:nt}),it={name:"BaseCard",extends:Re,style:rt,provide:function(){return{$pcCard:this,$parentInstance:this}}},Le={name:"Card",extends:it,inheritAttrs:!1};function dt(n,p,i,m,k,a){return o(),h("div",z({class:n.cx("root")},n.ptmi("root")),[n.$slots.header?(o(),h("div",z({key:0,class:n.cx("header")},n.ptm("header")),[Y(n.$slots,"header")],16)):P("",!0),S("div",z({class:n.cx("body")},n.ptm("body")),[n.$slots.title||n.$slots.subtitle?(o(),h("div",z({key:0,class:n.cx("caption")},n.ptm("caption")),[n.$slots.title?(o(),h("div",z({key:0,class:n.cx("title")},n.ptm("title")),[Y(n.$slots,"title")],16)):P("",!0),n.$slots.subtitle?(o(),h("div",z({key:1,class:n.cx("subtitle")},n.ptm("subtitle")),[Y(n.$slots,"subtitle")],16)):P("",!0)],16)):P("",!0),S("div",z({class:n.cx("content")},n.ptm("content")),[Y(n.$slots,"content")],16),n.$slots.footer?(o(),h("div",z({key:1,class:n.cx("footer")},n.ptm("footer")),[Y(n.$slots,"footer")],16)):P("",!0)],16)],16)}Le.render=dt;const ut={key:0,class:"flex justify-center mt-5"},ct={key:1,class:"flex flex-col gap-3"},pt=G({__name:"BlogDetails",emits:["createClicked","editClicked","deleteClicked"],setup(n){const p=Ge(),i=Ee(),m=be(),k=ee(),a=ae(),{routeLoading:U}=D(m),{isLoggedIn:E}=D(k),{blogPosts:C,blogReactions:B,isBlogPostsFetchLoading:d}=D(a),{fetchBlogPost:y}=a,v=_(()=>p.params.postId);return Ie(async()=>{var c;if(B.value.unread=[],v.value)if(((c=C.value.data.single)==null?void 0:c.id)!==v.value){const w=await y(v.value);if(Fe(w)&&w===ze.PERMISSION_DENIED&&!E.value){i.push({name:J.LOGIN,params:{redirect:JSON.stringify({name:J.BLOG_DETAILS,params:{postId:v.value}})}});return}}else C.value.data.single}),(c,w)=>t(d)?(o(),h("div",ut,[u(W,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:"",label:"Loading..."})])):(o(),h("div",ct,[u(ot,{"back-route":t(J).BLOG,label:"Back to other posts"},null,8,["back-route"]),t(C).data.single?(o(),b(De,{key:0,post:t(C).data.single,onEditClicked:w[0]||(w[0]=e=>c.$emit("editClicked",t(C).data.single)),onDeleteClicked:w[1]||(w[1]=e=>c.$emit("deleteClicked",t(C).data.single))},null,8,["post"])):P("",!0)]))}}),Ue=G({__name:"BlogPostSectionTitle",props:{class:{},alignment:{},isExpandable:{type:Boolean},isExpanded:{type:Boolean},isSubTitle:{type:Boolean}},emits:["click"],setup(n){const p=n;return(i,m)=>(o(),h("div",{class:F(["font-bold",{"text-lg md:text-2xl":!i.isSubTitle},{"hover:underline cursor-pointer":i.isExpandable},p.class])},[S("div",{class:F({block:!i.alignment,flex:!!i.alignment,"justify-start":i.alignment==="left","justify-center":i.alignment==="center","justify-end":i.alignment==="right"})},[S("span",{class:"flex",onClick:m[0]||(m[0]=k=>i.$emit("click"))},[i.isExpandable&&i.alignment==="right"?(o(),h("i",{key:0,class:F(["pi pi-angle-down animation",{"rotate-180":i.isExpanded}])},null,2)):P("",!0),Y(i.$slots,"default"),i.isExpandable&&(i.alignment==="left"||i.alignment==="center")?(o(),h("i",{key:1,class:F(["pi pi-angle-down animation",{"rotate-180":i.isExpanded}])},null,2)):P("",!0)])],2)],2))}}),mt={class:"flex gap-3"},vt={class:"min-h-[50vh] flex flex-col"},ft={class:"flex justify-between h-fit mt-2 gap-2"},gt={class:"flex flex-wrap gap-3"},yt={class:"relative mt-5 min-h-[20vh] max-h-screen flex flex-col justify-end"},bt={class:"relative min-h-[20vh] max-h-full flex-grow"},kt={class:"w-full"},wt={key:3,class:"w-full"},$t={class:"flex justify-center mt-5"},Pt={class:"flex justify-center mt-3"},Ct=G({__name:"BlogPostOverview",props:{post:{}},emits:["editClicked","deleteClicked"],setup(n){const p=n,i=be(),m=ee(),k=ke(),{routeLoading:a,routeLoadingId:U}=D(i),{publicUsers:E}=D(k),{isOwner:C}=D(m),B=r(p.post.archived),d=_(()=>{var e;return(e=p.post.allowedUserIds)!=null&&e.length?E.value.filter(l=>{var s;return(s=p.post.allowedUserIds)==null?void 0:s.includes(l.id)}):[]}),y=_(()=>{const e=we(p.post.date);return p.post.dateUpdated?e+` - updated ${we(p.post.dateUpdated)}`:e}),v=_(()=>{const e=[];return p.post.datePinned&&e.push({value:"Pinned",severity:"success",rounded:!1}),p.post.locked&&e.push({value:"Locked",severity:"danger",rounded:!1,icon:"pi pi-lock"}),p.post.archived&&e.push({value:"Archived",severity:"warning",rounded:!1,icon:"pi pi-file-excel"}),e}),c=_(()=>p.post.sections.length?p.post.sections[0]:null),w=()=>{const e=document.createElement("textarea"),{protocol:l,hostname:s,port:I}=window.location,$=`${l}//${s}`+(s==="localhost"?`:${I}`:"");e.value=`${$}#${Je.BLOG.path}/${p.post.id}`,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),ye.success("Copied link!")};return(e,l)=>(o(),b(ge,{id:e.post.id,class:F([{"min-h-[50vh]":!B.value},"border-4 border-transparent","!rounded-primary",e.post.colorSecondary||e.post.colorPrimary||"bg-secondary-900",e.post.opacitySecondary||"bg-opacity-50"]),title:e.post.title,subTitle:y.value,tags:v.value,loading:e.post.loading,isCollapsed:B.value,clickable:"",route:{name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}},{right:T(()=>[S("div",mt,[B.value?t(C)?(o(),b(Se,{key:1,onEditClicked:l[0]||(l[0]=s=>e.$emit("editClicked")),onDeleteClicked:l[1]||(l[1]=s=>e.$emit("deleteClicked"))})):P("",!0):(o(),b(W,{key:0,class:"border-none h-fit",variant:"neutral",icon:"pi pi-copy",onClick:w}))])]),default:T(()=>{var s;return[S("div",vt,[S("div",ft,[S("div",gt,[d.value.length?(o(),h(Q,{key:0},[u(t(ie),{class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:d.value[0].displayName,rounded:""},null,8,["label"]),d.value.length>1?(o(),b(t(ie),{key:0,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:"You",rounded:""})):P("",!0),d.value.length>2?(o(),b(t(ie),{key:1,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",label:`${d.value.length-2} others`,rounded:""},null,8,["label"])):P("",!0)],64)):P("",!0)]),t(C)?(o(),h("div",{key:0,class:F(["flex justify-end ms-5",(s=e.post.allowedUserIds)!=null&&s.length?"flex-col md:flex-row":"flex-row"])},[u(Se,{onEditClicked:l[2]||(l[2]=I=>e.$emit("editClicked")),onDeleteClicked:l[3]||(l[3]=I=>e.$emit("deleteClicked"))})],2)):P("",!0)]),S("div",yt,[l[6]||(l[6]=S("div",{class:"absolute inset-0 rounded-primary bg-gradient-to-t from-neutral-500 to-transparent"},null,-1)),S("div",bt,[u(t(Le),{class:F(["z-10 min-h-[20vh] p-5 text-neutral-300",e.post.colorPrimary,e.post.opacityPrimary||"bg-opacity-50"])},{header:T(()=>[e.post.coverImageUrl?(o(),b(He,{key:0,post:e.post,"cover-image-url":e.post.coverImageUrl,thumb:""},null,8,["post","cover-image-url"])):P("",!0)]),content:T(()=>[S("div",{class:F(["flex relative",e.post.countdown||e.post.alignment==="center"?"flex justify-between":""])},[S("div",kt,[e.post.countdown?(o(),b($e,{key:0,time:new Date(e.post.countdown).getTime(),direction:"down",alignment:e.post.alignment},null,8,["time","alignment"])):P("",!0),e.post.timer?(o(),b($e,{key:1,time:new Date(e.post.timer).getTime(),direction:"up",alignment:e.post.alignment},null,8,["time","alignment"])):P("",!0),e.post.description?(o(),b(qe,{key:2,description:e.post.description.substring(0,150)+(e.post.description.length>=150?"...":"")},null,8,["description"])):c.value?(o(),h("div",wt,[c.value.title?(o(),b(Ue,{key:0,alignment:c.value.alignment},{default:T(()=>[Z(de(c.value.subTitle?c.value.title:`${c.value.title}...`),1)]),_:1},8,["alignment"])):P("",!0),c.value.subTitle?(o(),b(Ue,{key:1,alignment:c.value.alignment,"is-sub-title":""},{default:T(()=>[Z(de(c.value.subTitle)+"... ",1)]),_:1},8,["alignment"])):P("",!0)])):P("",!0)])],2)]),_:1},8,["class"])])]),S("div",$t,[u(W,{class:"w-full md:w-1/2",variant:"neutral",label:"Read more",loading:t(a)===t(J).BLOG_DETAILS&&t(U)===e.post.id,onClick:l[4]||(l[4]=I=>t(Pe).push({name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}))},null,8,["loading"])]),S("div",Pt,[S("p",{class:F(e.post.reactions.length?"text-yellow-400 hover:text-yellow-500 cursor-pointer":"text-neutral-200"),onClick:l[5]||(l[5]=I=>t(Pe).push({name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}))},de(e.post.reactions.length)+" replies ",3)])])]}),_:1},8,["id","class","title","subTitle","tags","loading","isCollapsed","route"]))}}),ht={class:"w-full grid gap-4 md:gap-10 xl:gap-20"},St={key:2,class:"w-full flex justify-center mt-5"},Ut=G({__name:"BlogPosts",props:{single:{type:Boolean}},emits:["createClicked","editClicked","deleteClicked"],setup(n){const p=ee(),i=ae(),{blogPosts:m,visibleBlogPosts:k,isBlogPostsFetchLoading:a}=D(i),{firebaseUser:U,isLoggedIn:E,isOwner:C}=D(p),{fetchBlogPosts:B}=i;st();const d=r(),y=r(),v=r(),c=async e=>{var l;m.value.visibility!==e&&(m.value.data[e].length||await B((l=U.value)==null?void 0:l.uid,{visibility:e}),m.value.visibility=e,m.value.isLastPage=!1,ue(d.value))},w=async()=>{var l;const e=k.value.length;await B((l=U.value)==null?void 0:l.uid),k.value[e]&&ue(y.value[e])};return Ie(()=>{m.value.loadedOnce||(E.value?c("private"):m.value.visibility!=="public"&&c("public"),m.value.loadedOnce=!0)}),ne(()=>{var e;return(e=y.value)==null?void 0:e.length},()=>{var e;if((e=y.value)!=null&&e.length&&v.value){const l=k.value.find(s=>s.id===v.value);if(l){const s=k.value.indexOf(l);ue(y.value[s]),v.value=void 0}}}),(e,l)=>(o(),h("div",{ref_key:"container",ref:d,class:"flex flex-col gap-5 items-center"},[t(C)?(o(),b(W,{key:0,class:"w-full md:w-1/2",variant:"tertiary",label:"New Post",onClick:l[0]||(l[0]=s=>e.$emit("createClicked"))})):P("",!0),t(E)?(o(),b(t(We),{key:1,class:"w-full md:w-1/2"},{default:T(()=>[u(W,{class:"w-full",variant:"secondary",outlined:t(m).visibility!=="public",loading:t(m).isLoading.public.fetch,label:"Public Posts",onClick:l[1]||(l[1]=s=>c("public"))},null,8,["outlined","loading"]),u(W,{class:"w-full",variant:"secondary",outlined:t(m).visibility!=="private",loading:t(m).isLoading.private.fetch,label:"Private Posts",onClick:l[2]||(l[2]=s=>c("private"))},null,8,["outlined","loading"])]),_:1})):P("",!0),S("div",ht,[t(k).length?(o(!0),h(Q,{key:0},Te(t(k),(s,I)=>(o(),h("div",{key:s.id,ref_for:!0,ref_key:"posts",ref:y},[I===0||s.datePinned?(o(),b(De,{key:0,post:s,onEditClicked:$=>e.$emit("editClicked",s),onDeleteClicked:$=>e.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"])):(o(),b(Ct,{key:1,post:s,onEditClicked:$=>e.$emit("editClicked",s),onDeleteClicked:$=>e.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"]))]))),128)):t(a)?(o(),b(ge,{key:1,class:"!bg-neutral-600 !bg-opacity-40 !rounded-primary",title:"Loading..."})):(o(),b(ge,{key:2,class:"!bg-red-900 !bg-opacity-40 !rounded-primary",title:"No posts"}))]),t(m).isLastPage?P("",!0):(o(),h("div",St,[u(W,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:t(k).length>0&&t(a),label:"Load more posts",onClick:w},null,8,["loading"])]))],512))}}),Bt=G({__name:"BlogPostContentDialog",emits:["update:selected","error"],setup(n,{expose:p,emit:i}){const m=i,k=te(),{blogPostMutation:a}=D(k),U=r(),E=r(),C=_(()=>[E.value].some(d=>!!d));return p({test:async()=>{await Promise.all([U.value.test()]),m("error",C.value)}}),(d,y)=>(o(),h(Q,null,[u(Ye,{ref_key:"title",ref:U,class:"w-full",name:"title",label:"Title",placeholder:"Amazing Post",modelValue:t(a).title,"onUpdate:modelValue":y[0]||(y[0]=v=>t(a).title=v),error:E.value,"onUpdate:error":y[1]||(y[1]=v=>E.value=v),rules:[t(Ve).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),u(Qe,{modelValue:t(a).content,"onUpdate:modelValue":y[2]||(y[2]=v=>t(a).content=v)},null,8,["modelValue"])],64))}}),Et=G({__name:"BlogPostSettingsDialog",emits:["error"],setup(n,{expose:p,emit:i}){const m=i,k=ee(),a=ke(),U=te(),{publicUser:E,publicUsers:C}=D(a),{firebaseUser:B}=D(k),{blogPostMutation:d}=D(U),{allowedPublicUsers:y}=a,v=r(),c=r(),w=r(),e=r(),l=_({get(){return!!d.value.datePinned},set(x){d.value.datePinned=x?new Date:null}}),s=r(),I=r(),$=r(),L=r(),O=_(()=>[s.value,I.value,$.value,L.value].some(x=>!!x)),g=_(()=>C.value.map(({id:x,displayName:M})=>({value:x,label:M}))),f=r([]),le=x=>{d.value.allowedUserIds=x},oe=async()=>{d.value.allowedUserIds.length&&!f.value.length&&(s.value="Invalid user ID's"),await Promise.all([c.value.test(),w.value.test(),e.value.test()]),m("error",O.value)};return ne(()=>d.value.allowedUserIds,async x=>{f.value=await y(x)},{immediate:!0}),p({test:oe}),(x,M)=>(o(),h(Q,null,[u(H,{ref_key:"allowedUsers",ref:v,class:"w-full md:w-1/2",name:"allowedUserIds",label:"Allowed users",placeholder:"This post is public","model-value":t(d).allowedUserIds,error:s.value,"onUpdate:error":M[0]||(M[0]=j=>s.value=j),"onUpdate:arrayValue":le,options:[{value:t(B).uid,label:t(E).displayName},...g.value.filter(({value:j})=>{var se;return j!==((se=t(B))==null?void 0:se.uid)})],multiple:""},null,8,["model-value","error","options"]),u(ce,{ref_key:"pinned",ref:e,class:"w-full md:w-1/2",name:"pinned",label:"Pinned",modelValue:l.value,"onUpdate:modelValue":M[1]||(M[1]=j=>l.value=j)},null,8,["modelValue"]),u(ce,{ref_key:"locked",ref:c,class:"w-full md:w-1/2",name:"locked",label:"Locked for commenting",modelValue:t(d).locked,"onUpdate:modelValue":M[2]||(M[2]=j=>t(d).locked=j)},null,8,["modelValue"]),u(ce,{ref_key:"archived",ref:w,class:"w-full md:w-1/2",name:"archived",label:"Archived",modelValue:t(d).archived,"onUpdate:modelValue":M[3]||(M[3]=j=>t(d).archived=j)},null,8,["modelValue"])],64))}}),It=G({__name:"BlogPostStylingDialog",emits:["error"],setup(n,{expose:p,emit:i}){const m=i,k=te(),{blogPostMutation:a}=D(k),U=r(),E=r(),C=r(),B=r(),d=r(),y=r(),v=r(),c=r(),w=r(),e=r(),l=r(),s=r(),I=_(()=>[v.value,c.value,w.value,e.value,l.value,s.value].some(O=>!!O)),$=_(()=>Ke(Ce.find(O=>O.value===a.value.colorPrimary)));return p({test:async()=>{await Promise.all([U.value.test(),E.value.test(),C.value.test(),B.value.test(),d.value.test(),y.value.test()]),m("error",I.value)}}),(O,g)=>(o(),h(Q,null,[u(H,{ref_key:"colorPrimary",ref:U,class:"w-full md:w-1/2",name:"colorPrimary",label:"Primary Style",modelValue:t(a).colorPrimary,"onUpdate:modelValue":g[0]||(g[0]=f=>t(a).colorPrimary=f),error:v.value,"onUpdate:error":g[1]||(g[1]=f=>v.value=f),options:t(Ce),rules:[t(Ve).Required]},null,8,["modelValue","error","options","rules"]),u(H,{ref_key:"opacityPrimary",ref:B,class:"w-full md:w-1/2",name:"opacityPrimary",label:"Primary Opacity",modelValue:t(a).opacityPrimary,"onUpdate:modelValue":g[2]||(g[2]=f=>t(a).opacityPrimary=f),error:e.value,"onUpdate:error":g[3]||(g[3]=f=>e.value=f),options:t(pe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"colorSecondary",ref:E,class:"w-full md:w-1/2",name:"colorSecondary",label:"Secondary Style",modelValue:t(a).colorSecondary,"onUpdate:modelValue":g[4]||(g[4]=f=>t(a).colorSecondary=f),error:c.value,"onUpdate:error":g[5]||(g[5]=f=>c.value=f),options:$.value},null,8,["modelValue","error","options"]),u(H,{ref_key:"opacitySecondary",ref:d,class:"w-full md:w-1/2",name:"opacitySecondary",label:"Secondary Opacity",modelValue:t(a).opacitySecondary,"onUpdate:modelValue":g[6]||(g[6]=f=>t(a).opacitySecondary=f),error:l.value,"onUpdate:error":g[7]||(g[7]=f=>l.value=f),options:t(pe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"colorTertiary",ref:C,class:"w-full md:w-1/2",name:"colorTertiary",label:"Tertiary Style",modelValue:t(a).colorTertiary,"onUpdate:modelValue":g[8]||(g[8]=f=>t(a).colorTertiary=f),error:w.value,"onUpdate:error":g[9]||(g[9]=f=>w.value=f),options:t(Xe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"opacityTertiary",ref:y,class:"w-full md:w-1/2",name:"opacityTertiary",label:"Tertiary Opacity",modelValue:t(a).opacityTertiary,"onUpdate:modelValue":g[10]||(g[10]=f=>t(a).opacityTertiary=f),error:s.value,"onUpdate:error":g[11]||(g[11]=f=>s.value=f),options:t(pe)},null,8,["modelValue","error","options"])],64))}}),Tt=G({__name:"BlogPostDialog",emits:["scroll-to-updated"],setup(n,{emit:p}){const i=p,m=ee(),k=ae(),a=te(),{firebaseUser:U}=D(m),{isBlogPostsMutationLoading:E}=D(k),{createBlogPost:C,updateBlogPost:B,deleteFilesOfBlogPost:d,toggleBlogPostVisibility:y}=k,{getBlogPostMutationContent:v,getBlogPostMutationStyling:c,getBlogPostMutationSettings:w}=a,{isOpen:e,blogPostOriginal:l,blogPostMutationId:s,blogPostMutation:I,hasBlogPostMutationContentChanges:$,hasBlogPostMutationStylingChanges:L,hasBlogPostMutationSettingsChanges:O}=D(a),g=r(),f=r(),le=r(),oe=r(),x=r(!1),M=r(!1),j=r(!1),se=_(()=>{var A,V,N,K,X,R;return!!((V=(A=l.value)==null?void 0:A.allowedUserIds)!=null&&V.length)&&!((N=w().allowedUserIds)!=null&&N.length)||!((X=(K=l.value)==null?void 0:K.allowedUserIds)!=null&&X.length)&&!!((R=w().allowedUserIds)!=null&&R.length)}),Oe=_(()=>{const A=[];return $.value&&A.push("Content"),L.value&&A.push("Styling"),O.value&&A.push("Settings"),A.length?"Update "+he(A):void 0}),re=_(()=>Ze(l.value)),_e=async()=>{var A,V,N,K,X;if(await Promise.all([f.value.test(),le.value.test(),oe.value.test()]),!(x.value||M.value||j.value))if(!l.value)await C(s.value,I.value,(A=U.value)==null?void 0:A.uid)&&(a.close(),i("scroll-to-updated",s.value));else if(se.value){const R=s.value;a.isOpen=!1,await y(R,lt.convert(I.value),l.value.reactions,I.value.allowedUserIds.length?"private":"public",(V=U.value)==null?void 0:V.uid)&&(a.close(),ye.success("Successfully updated Post Visibility"),i("scroll-to-updated",R))}else{const R=s.value;let q=[];$.value&&q.push(await B(R,v(),re.value,(N=U.value)==null?void 0:N.uid)),L.value&&q.push(await B(R,c(),re.value,(K=U.value)==null?void 0:K.uid)),O.value&&(q.push(await B(R,w(),re.value,(X=U.value)==null?void 0:X.uid)),i("scroll-to-updated",R)),q=q.filter(Me=>typeof Me=="string"),q.length&&(ye.success(`Successfully updated Post ${he(q)}`),a.close())}},xe=async()=>{d(I.value,l.value??void 0),a.close()};return ne(I,()=>{a.isMutationEqual()},{deep:!0}),(A,V)=>(o(),b(Be,{isOpen:t(e),title:t(l)?"Update Post":"Create Post",description:t(l)?"Update this post":"Create a new post","confirm-text":t(l)?Oe.value:"Create","confirm-loading":t(E),onConfirm:_e,onCancel:xe},{default:T(()=>[S("form",{ref_key:"dialog",ref:g,class:"pt-6 mb-4 xl:px-16"},[t(e)?(o(),b(t(et),{key:0,"active-index":0,onTabOpen:t(tt)},{default:T(()=>[u(t(fe),{value:"content"},{default:T(()=>[u(t(me),null,{default:T(()=>V[3]||(V[3]=[Z(" Content ")])),_:1,__:[3]}),u(t(ve),{"pt:content":"flex flex-col justify-center items-center gap-3"},{default:T(()=>[u(Bt,{ref_key:"content",ref:f,onError:V[0]||(V[0]=N=>x.value=N)},null,512)]),_:1})]),_:1}),u(t(fe),{value:"styling"},{default:T(()=>[u(t(me),null,{default:T(()=>V[4]||(V[4]=[Z(" Styling ")])),_:1,__:[4]}),u(t(ve),{"pt:content":"flex flex-col justify-center items-center gap-3"},{default:T(()=>[u(It,{ref_key:"styling",ref:le,onError:V[1]||(V[1]=N=>M.value=N)},null,512)]),_:1})]),_:1}),u(t(fe),{value:"settings"},{default:T(()=>[u(t(me),null,{default:T(()=>V[5]||(V[5]=[Z(" Settings ")])),_:1,__:[5]}),u(t(ve),{"pt:content":"flex flex-col justify-center items-center gap-3"},{default:T(()=>[u(Et,{ref_key:"settings",ref:oe,onError:V[2]||(V[2]=N=>j.value=N)},null,512)]),_:1})]),_:1})]),_:1},8,["onTabOpen"])):P("",!0)],512)]),_:1},8,["isOpen","title","description","confirm-text","confirm-loading"]))}}),Vt={class:"grid mt-10 md:mt-15"},Dt={class:"grid justify-center"},Lt={class:"text-lg md:text-xl text-white"},Ot=["innerHTML"],_t={class:"grid my-5 xl:px-20"},xt=G({__name:"Blog",setup(n){const p=Ee(),i=be(),m=ke(),k=ae(),a=te(),{menuItems:U,content:E}=D(i),{publicUser:C}=D(m),{deleteBlogPost:B}=k,d=r(null),y=r(),v=r(!1),c=r(p.currentRoute.value.params.postId),w=_(()=>{var $;return C.value?[...E.value.blogDescriptionUser.map(L=>L.replace("%USER%",C.value.displayName||"Unknown user")),...(($=U.value.find(L=>L.id==="nfNQM4SMESU2VOkJtcgY"))==null?void 0:$.description)||[]]:E.value.blogDescriptionGuest}),e=()=>{a.openWith(null)},l=$=>{a.openWith($)},s=$=>{d.value=$,v.value=!0},I=async $=>{await B($)&&(v.value=!1,d.value=null)};return ne(p.currentRoute,$=>{c.value=$.params.postId}),($,L)=>(o(),b(je,null,{content:T(()=>[S("div",Vt,[S("div",Dt,[(o(!0),h(Q,null,Te(w.value,O=>(o(),h("h1",Lt,[S("span",{innerHTML:O},null,8,Ot)]))),256))]),S("div",_t,[c.value?(o(),b(pt,{key:0,onEditClicked:l,onDeleteClicked:s})):(o(),b(Ut,{key:1,onCreateClicked:e,onEditClicked:l,onDeleteClicked:s})),u(Tt,{onScrollToUpdated:L[0]||(L[0]=O=>y.value=O)}),d.value?(o(),b(Be,{key:2,title:"Delete Post",isOpen:v.value,description:[` Are you sure you want to delete this post called ' ${d.value.title}'?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},onConfirm:L[1]||(L[1]=O=>I(d.value.id)),onCancel:L[2]||(L[2]=O=>v.value=!1)},null,8,["isOpen","description"])):P("",!0)])])]),_:1}))}}),Gt=G({__name:"Blog",setup(n){return(p,i)=>(o(),b(xt))}});export{Gt as default};
