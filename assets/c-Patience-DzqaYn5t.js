import{u as ue,b as pe,a as ce,_ as G}from"./c-Bubble.vue_vue_type_script_setup_true_lang-iHAaGDxw.js";import{d as Oe,aG as He,aH as de,s as X,r as V,a as Pe,c as I,o as Ne,M as Le,aI as ve,aN as Re,aJ as $e,aM as Me,l as d,m as v,p as m,e as fe,q as A,D,ay as ie,G as Q,H as Y,E as W,ae as Be,n as p,k as e,t as T,h as je,f as Fe,w as Qe,R as Ke,ah as Ue}from"../bundle.js";import{_ as Ge}from"./c-GameSettingsDialog.vue_vue_type_script_setup_true_lang-DqJc4GP2.js";import{u as Ve,H as Ze}from"./c-useScoreInfo-CTNsRnrK.js";import{_ as ee}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import{S as ge}from"./c-Spades-CRNFPKDk.js";import{D as qe}from"./c-vuedraggable.umd-DZ3azzJt.js";import"./c-SwitchField.vue_vue_type_script_setup_true_lang-JQE6dSwt.js";import"./c-SelectField.vue_vue_type_script_setup_true_lang-Bu9S1e-e.js";import"./c-validation-DokkLKHB.js";var S=(s=>(s.HEARTS="hearts",s.SPADES="spades",s.DIAMONDS="diamonds",s.CLUBS="clubs",s))(S||{});const ae={hearts:{label:"Hearts",color:"red"},spades:{label:"Spades",color:"black"},diamonds:{label:"Diamonds",color:"red"},clubs:{label:"Clubs",color:"black"}};var u=(s=>(s.STOCK_CLOSED="stock_closed",s.STOCK_OPEN="stock_open",s.PILE1="pile1",s.PILE2="pile2",s.PILE3="pile3",s.PILE4="pile4",s.PILE5="pile5",s.PILE6="pile6",s.PILE7="pile7",s.HEARTS="hearts",s.SPADES="spades",s.DIAMONDS="diamonds",s.CLUBS="clubs",s))(u||{}),x=(s=>(s[s.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",s[s.HAS_STARTED=1]="HAS_STARTED",s[s.HAS_FINISHED=2]="HAS_FINISHED",s))(x||{});const Se=()=>{const s=ze();return Re(s),{pile1:s.splice(0,1).map(l=>({...l,deck:"pile1"})),pile2:s.splice(0,2).map((l,c)=>c<1?{...l,hidden:!0,deck:"pile2"}:{...l,deck:"pile2"}),pile3:s.splice(0,3).map((l,c)=>c<2?{...l,hidden:!0,deck:"pile3"}:{...l,deck:"pile3"}),pile4:s.splice(0,4).map((l,c)=>c<3?{...l,hidden:!0,deck:"pile4"}:{...l,deck:"pile4"}),pile5:s.splice(0,5).map((l,c)=>c<4?{...l,hidden:!0,deck:"pile5"}:{...l,deck:"pile5"}),pile6:s.splice(0,6).map((l,c)=>c<5?{...l,hidden:!0,deck:"pile6"}:{...l,deck:"pile6"}),pile7:s.splice(0,7).map((l,c)=>c<6?{...l,hidden:!0,deck:"pile7"}:{...l,deck:"pile7"}),stock_closed:s.map(l=>({...l,hidden:!0,deck:"stock_closed"})),stock_open:[],hearts:[],spades:[],diamonds:[],clubs:[]}},ke=Oe("patienceStore",()=>{const s=He(de.PATIENCE)(),{personalBest:l,highscorePosition:c}=X(s),{setPreviousHighscores:C,fetchGameData:K,updateHighscores:U,sortHighscores:f}=s,g=V(0),O=V(0),y=V(0),H=V(0),P=V(0),B=V(),i=Pe(Se()),h=I(()=>Object.keys(i).flatMap(t=>i[t])),Z=1e3,j=10,w=10,_=I(()=>{const t=y.value%10===0?y.value:Math.floor(y.value/10)*10,o=O.value*j,n=P.value*j,a=t+o+n,E=H.value*w;return Math.max(0,Z-(a-E))}),N=I(()=>{const t=Math.floor(y.value/60),o=y.value%60;return`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`}),R=I(()=>i.hearts.length===13&&i.spades.length===13&&i.diamonds.length===13&&i.clubs.length===13);Ne(()=>{y.value&&r()}),Le(R,()=>{L(),g.value=2,U(_.value,{score:_.value,bonus:H.value,time:y.value,turns:O.value,penalty:P.value}),ve($e)});const $=()=>{L(),O.value=0,y.value=0,H.value=0,P.value=0,g.value=0,Object.assign(i,Se()),s.setPreviousHighscores()},M=()=>{y.value=0,r(),g.value=1,setTimeout(()=>{le()},500)},r=()=>{B.value&&L(),B.value=setInterval(()=>{y.value++},1e3)},L=()=>{clearInterval(B.value)},Ee=()=>{const t=i.stock_open;t.length&&(t.reverse(),z(t[0],!1,o=>{o.deck="stock_closed",o.hidden=!0,i.stock_closed.push(o)}),t.splice(0,t.length),F(1))},Ae=t=>{const o=t.deck,n=h.value.filter(a=>a.selected);if(o==="stock_closed"){const a=i.stock_closed,E=a.indexOf(t);if(E===a.length-1){const q=E-2,b=q<0?0:q,re=a.filter((ye,Ie)=>Ie>=b);se(re,"stock_open",ye=>{ye.hidden=!1}),F(0)}}else if(o==="stock_open"){const a=i.stock_open;a.indexOf(t)===a.length-1&&(t.selected=!t.selected,n.length&&z(n[0],!1))}else if(n.length){const a=n[0];a===t?z(t,!1):J(o)&&be(a,t)?t.value===a.value+1&&(se(n,o),a.value===13&&J(a.deck)?F(5):F(4)):n.length===1&&ne(o)&&De(a,t)&&t.value===a.value-1&&(te(a,o),F(3))}else z(t,!0)},Ce=t=>{const o=h.value.filter(n=>n.selected);if(o.length){const n=o[0],a=n.deck;n.value===13&&(se(o,t),a==="stock_open"?F(2):J(n.deck)?F(5):F(4))}},we=t=>{const o=h.value.filter(n=>n.selected);if(o.length===1){const n=o[0],a=n.type;!i[t].length&&a===t&&n.value===1&&(te(n,t),F(3))}},z=(t,o,n)=>{const a=i[t.deck],E=a.indexOf(t);a.filter((b,re)=>re>=E).forEach(b=>{b.selected=o,n==null||n(b)})},Te=()=>{h.value.forEach(t=>{t.selected=!1})},te=(t,o)=>{const n=t.deck,a=i[n].indexOf(t);t.deck=o,t.selected=!1,i[o].push(t),i[n].splice(a,1),(J(n)||n==="stock_open")&&oe(n)},se=(t,o,n)=>{const a=t[0],E=a.deck,q=i[E].indexOf(a);z(a,!1,b=>{b.deck=o,n==null||n(b),i[o].push(b)}),i[E].splice(q,t.length),ne(E)||oe(E!=="stock_closed"?E:o)},me=t=>{const o=i[t.type],n=o.length?o[o.length-1].value:0;if(t.value===n+1){const a=["hearts","spades","diamonds","clubs"],E=n<=1||a.every(q=>{const b=i[q];return(b.length?b[b.length-1].value:0)>=n});if(n===0||E)return te(t,t.type),F(3),!0}return!1},le=()=>{for(const t of["stock_open","pile1","pile2","pile3","pile4","pile5","pile6","pile7"]){const o=i[t];if(o.length&&me(o[o.length-1]))return}},oe=t=>{const o=i[t];if(o.length){const n=o[o.length-1],a=n.deck;n.hidden=!1,setTimeout(()=>{n.deck===a&&(me(n)||le())},500)}else setTimeout(()=>{le()},500)},F=t=>{switch(t!==5&&O.value++,t){case 0:{P.value+=2;break}case 1:{P.value+=5;break}case 2:{H.value+=10;break}case 3:{H.value+=20;break}}ve(Me)},be=(t,o)=>t.color!==o.color,De=(t,o)=>t.type===o.type,J=t=>["pile1","pile2","pile3","pile4","pile5","pile6","pile7"].includes(t),ne=t=>["hearts","spades","diamonds","clubs"].includes(t);return{gameStatus:g,score:_,turns:O,time:y,bonus:H,penalty:P,cards:i,allCards:h,formattedTime:N,personalBest:l,highscorePosition:c,$reset:$,start:M,shuffle:Ee,selectCard:Ae,selectEmptyDeck:Ce,selectFinalDeck:we,deselectAllCards:Te,isPlayDeck:J,isFinalDeck:ne,setPreviousHighscores:C,fetchGameData:K,updateHighscores:U,sortHighscores:f}},{persist:{enabled:!0}}),ze=()=>Object.keys(ae).flatMap(s=>{const l=s,c=[];for(let C=0;C<13;C++){const K={type:l,label:ae[l].label,color:ae[l].color,value:C+1,hidden:!1,selected:!1};c.push(K)}return c}),Je={},Ye={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function We(s,l){return d(),v("svg",Ye,l[0]||(l[0]=[m("path",{d:"M50 35 Q40 25 50 15 Q60 25 50 35 Z M35 50 Q25 40 35 30 Q45 40 35 50 Z M65 50 Q75 40 65 30 Q55 40 65 50 Z M50 40 Q65 55 50 65 Q35 55 50 40 Z M45 65 Q45 80 55 80 Q55 65 45 65 Z",fill:"black"},null,-1)]))}const he=ee(Je,[["render",We]]),Xe={},et={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function tt(s,l){return d(),v("svg",et,l[0]||(l[0]=[m("polygon",{points:"50,10 80,50 50,90 20,50",fill:"red"},null,-1)]))}const xe=ee(Xe,[["render",tt]]),st={},lt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function ot(s,l){return d(),v("svg",lt,l[0]||(l[0]=[m("path",{d:"M50 70 Q20 50 20 30 Q20 10 40 10 Q50 10 50 20 Q50 10 60 10 Q80 10 80 30 Q80 50 50 70 Z",fill:"red"},null,-1)]))}const _e=ee(st,[["render",ot]]),nt={key:0,class:"w-full h-full flex justify-center"},rt={key:1,class:"relative w-full flex"},at={class:"relative flex text-xs md:text-md lg:text-lg font-bold"},ct=fe({__name:"Card",props:{card:{},index:{}},emits:["select"],setup(s,{emit:l}){const c=s,C=l,U=ue(pe).greaterOrEqual("lg"),f=ke(),{gameStatus:g,cards:O}=X(f),{isPlayDeck:y}=f,H=I(()=>{if(c.card.hidden)return"";switch(c.card.value){case 13:return"K";case 12:return"Q";case 11:return"J";case 1:return"A";default:return`${c.card.value}`}}),P=I(()=>c.card.hidden?"text-primary":c.card.color==="black"?"text-black":"text-red-500"),B=I(()=>c.index===O.value[c.card.deck].length-1),i=I(()=>g.value===x.HAS_STARTED&&(B.value||!c.card.hidden)),h=I(()=>y(c.card.deck)||U.value&&c.card.deck===u.STOCK_CLOSED),Z=I(()=>y(c.card.deck)?20:10),j={[S.HEARTS]:_e,[S.SPADES]:ge,[S.DIAMONDS]:xe,[S.CLUBS]:he};return(w,_)=>(d(),A(ce,{class:W(["z-10 absolute h-[90px] w-[40px] xs:h-[100px] xs:w-[50px] sm:h-[110px] sm:w-[60px] lg:h-[120px] lg:w-[80px] !p-1 !pt-0 bg-opacity-100 !rounded-primary flex justify-center border border-white",[P.value,w.card.hidden?"bg-violet-950 border-1 !border-yellow-700":"bg-neutral-300",w.card.selected?"border-[3px] !border-red-600":"!border-black",{"draggable-card":i.value&&!w.card.hidden}]]),style:Be({top:h.value?`${Z.value*w.index}px`:0,zIndex:w.index+10}),"title-props":{class:"text-xl"},clickable:i.value,onClick:_[0]||(_[0]=N=>C("select"))},{fullControl:D(()=>[w.card.hidden?(d(),v("div",nt,_[1]||(_[1]=[m("div",{class:"flex flex-col justify-center"},[m("p",{class:"mb-2 text-5xl text-yellow-300"},"?")],-1)]))):(d(),v("div",rt,[m("div",at,[(d(),A(ie(j[w.card.type]),{class:"mt-[5px] sm:mt-[1px] h-[10px] w-[10px] sm:h-[20px] sm:w-[20px] md:h-[25px] md:w-[25px]"})),Q(" "+Y(H.value),1)]),(d(),A(ie(j[w.card.type]),{class:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[25px] sm:w-[35px] md:w-[50px]"}))]))]),_:1},8,["class","style","clickable"]))}}),dt={class:"absolute h-[90px] w-[40px] xs:h-[100px] xs:w-[50px] sm:h-[110px] sm:w-[60px] lg:h-[120px] lg:w-[80px]"},it=fe({__name:"CardDeck",props:{deckType:{},cardType:{}},setup(s){const l=s,C=ue(pe).greaterOrEqual("md"),K=ke(),{cards:U}=X(K),{shuffle:f,selectCard:g,selectEmptyDeck:O,selectFinalDeck:y,deselectAllCards:H,isPlayDeck:P,isFinalDeck:B}=K,i={[S.HEARTS]:_e,[S.SPADES]:ge,[S.DIAMONDS]:xe,[S.CLUBS]:he},h=I(()=>U.value[l.deckType]),Z=I(()=>!h.value.length&&!l.cardType),j=I(()=>Z.value&&l.deckType!==u.STOCK_OPEN),w=()=>{j.value&&O(l.deckType)},_=()=>{H()},N=R=>{R.added&&(g(R.added.element),h.value.length?g(h.value[h.value.length-1]):P(l.deckType)?O(l.deckType):B(l.deckType)&&y(l.deckType))};return(R,$)=>(d(),v("div",{class:W(["relative h-[90px] w-[40px] xs:h-[100px] xs:w-[50px] sm:h-[110px] sm:w-[60px] lg:h-[120px] lg:w-[80px]",{"border border-neutral-500":h.value.length===0,"cursor-pointer":j.value}]),onClick:w},[p(e(qe),{list:[...h.value],itemKey:M=>`${M.type}.s${M.value}`,group:"patience",draggable:".draggable-card",delay:e(C)?0:100,onStart:_,onChange:N,onEnd:_},{item:D(({element:M,index:r})=>[p(ct,{card:M,index:r,onSelect:L=>e(g)(M)},null,8,["card","index","onSelect"])]),header:D(()=>[m("div",dt,[R.cardType?(d(),A(ie(i[R.cardType]),{key:0,class:"absolute left-1/2 transform -translate-x-1/2 w-[50px] cursor-pointer",onClick:$[0]||($[0]=M=>e(y)(R.deckType))})):R.deckType===e(u).STOCK_CLOSED?(d(),v("div",{key:1,class:"w-full h-full flex justify-center",onClick:$[1]||($[1]=(...M)=>e(f)&&e(f)(...M))},$[2]||($[2]=[m("div",{class:"flex flex-col justify-center"},[m("p",{class:"text-neutral-300 text-xs md:text-md lg:text-lg mb-2"},"Shuffle")],-1)]))):T("",!0)])]),_:1},8,["list","itemKey","delay"])],2))}}),k=ee(it,[["__scopeId","data-v-1f64f67d"]]),ut={class:"flex justify-center"},pt={key:0,class:"w-full flex flex-wrap gap-3 justify-center"},ft={key:1,class:"w-full flex flex-col gap-3"},kt={class:"my-3"},mt={key:0,class:"w-full grid grid-cols-4 gap-1 justify-items-center"},yt={key:2,class:"w-full grid grid-cols-4 md:grid-cols-6 justify-items-center"},vt={key:1,class:"mt-5 text-center text-xl md:text-3xl font-bold"},St={class:"text-purple-500"},gt={key:0,class:"text-blue-500 font-bold"},ht={key:1,class:"text-blue-500 font-bold"},xt={key:2,class:"text-blue-500 font-bold"},_t={class:"mt-5 flex flex-wrap gap-3 justify-center"},Et={key:0,class:"flex flex-wrap gap-3 mt-3 justify-center"},Nt=fe({__name:"Patience",setup(s){const l=ue(pe),c=l.greaterOrEqual("md"),C=l.greaterOrEqual("lg"),K=Fe(),U=ke(),{gameStatus:f,score:g,turns:O,formattedTime:y,personalBest:H}=X(U),{currentHighscorePosition:P,hasImprovedHighscorePosition:B,hasImprovedPersonalBest:i}=Ve(de.PATIENCE),{start:h,$reset:Z,updateHighscores:j}=U,{firebaseUser:w}=X(je()),_=V(!1),N=V(!1),R=()=>{N.value=!1,h()},$=()=>{N.value=!1,Z()};return(M,r)=>(d(),A(ce,{class:"!bg-cyan-800 !bg-opacity-50 my-5 !rounded-secondary",title:"Patience",description:"Play solo."},{right:D(()=>[p(G,{class:"border-none h-fit",type:"neutral",icon:"pi pi-cog",onClick:r[0]||(r[0]=L=>_.value=!0)})]),default:D(()=>[m("div",ut,[e(f)===e(x).HAS_NOT_STARTED?(d(),v("div",pt,[p(G,{class:"w-full md:w-1/2",onClick:R},{default:D(()=>r[7]||(r[7]=[Q(" Start ")])),_:1})])):T("",!0),e(f)===e(x).HAS_STARTED?(d(),v("div",ft,[m("div",kt,[m("p",null,"Time: "+Y(e(y)),1),m("p",null,"Turns: "+Y(e(O)),1),m("p",null,"Score: "+Y(e(g)),1)]),e(c)?T("",!0):(d(),v("div",mt,[p(k,{class:"col-start-2","deck-type":e(u).STOCK_OPEN},null,8,["deck-type"]),p(k,{"deck-type":e(u).STOCK_CLOSED},null,8,["deck-type"])])),m("div",{class:W(["w-full grid gap-1 justify-items-center",e(C)?"grid-cols-8":e(c)?"grid-cols-7":"grid-cols-4"])},[e(c)?(d(),v(Qe,{key:0},[p(k,{"deck-type":e(u).STOCK_OPEN},null,8,["deck-type"]),e(C)?T("",!0):(d(),A(k,{key:0,"deck-type":e(u).STOCK_CLOSED},null,8,["deck-type"])),r[8]||(r[8]=m("div",null,null,-1))],64)):T("",!0),p(k,{"deck-type":e(u).HEARTS,"card-type":e(S).HEARTS},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).SPADES,"card-type":e(S).SPADES},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).DIAMONDS,"card-type":e(S).DIAMONDS},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).CLUBS,"card-type":e(S).CLUBS},null,8,["deck-type","card-type"])],2),e(f)===e(x).HAS_STARTED?(d(),v("div",{key:1,class:W(["w-full grid gap-1 justify-items-center",e(C)?"grid-cols-8":"grid-cols-7"])},[e(C)?(d(),A(k,{key:0,"deck-type":e(u).STOCK_CLOSED},null,8,["deck-type"])):T("",!0),p(k,{"deck-type":e(u).PILE1},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE2},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE3},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE4},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE5},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE6},null,8,["deck-type"]),p(k,{"deck-type":e(u).PILE7},null,8,["deck-type"])],2)):T("",!0)])):e(f)===e(x).HAS_FINISHED?(d(),v("div",yt,[p(k,{class:"md:col-start-2","deck-type":e(u).HEARTS,"card-type":e(S).HEARTS},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).SPADES,"card-type":e(S).SPADES},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).DIAMONDS,"card-type":e(S).DIAMONDS},null,8,["deck-type","card-type"]),p(k,{"deck-type":e(u).CLUBS,"card-type":e(S).CLUBS},null,8,["deck-type","card-type"])])):T("",!0)]),N.value?(d(),A(Ze,{key:0,"game-id":e(de).PATIENCE,unit:"point"},null,8,["game-id"])):e(f)===e(x).HAS_FINISHED?(d(),v("div",vt,[m("p",St,"You won with "+Y(e(g))+" points!",1),e(B)&&e(P)===1?(d(),v("p",gt," HIGHSCORE! ")):e(B)?(d(),v("p",ht," LEADERBOARD IMPROVEMENT! ")):e(i)?(d(),v("p",xt," PERSONAL BEST! ")):T("",!0)])):T("",!0),m("div",{class:W(["flex flex-col",{"h-[50vh] justify-end":e(f)===e(x).HAS_STARTED}])},[m("div",_t,[e(f)!==e(x).HAS_NOT_STARTED&&e(f)!==e(x).HAS_FINISHED?(d(),A(G,{key:0,class:"w-full md:w-1/2",type:"neutral",onClick:$},{default:D(()=>r[9]||(r[9]=[Q(" Restart ")])),_:1})):e(f)===e(x).HAS_FINISHED?(d(),A(G,{key:1,class:"w-full md:w-1/2",type:"secondary",onClick:$},{default:D(()=>r[10]||(r[10]=[Q(" Play Again ")])),_:1})):T("",!0),!N.value&&(e(f)===e(x).HAS_NOT_STARTED||e(f)===e(x).HAS_FINISHED)?(d(),A(G,{key:2,class:"w-full md:w-1/2",type:"neutral",onClick:r[1]||(r[1]=L=>N.value=!0)},{default:D(()=>r[11]||(r[11]=[Q(" View Highscores ")])),_:1})):e(f)===e(x).HAS_NOT_STARTED?(d(),A(G,{key:3,class:"w-full md:w-1/2",type:"neutral",onClick:r[2]||(r[2]=L=>N.value=!1)},{default:D(()=>r[12]||(r[12]=[Q(" Go Back ")])),_:1})):e(f)===e(x).HAS_FINISHED?(d(),A(G,{key:4,class:"w-full md:w-1/2",type:"neutral",onClick:r[3]||(r[3]=L=>N.value=!1)},{default:D(()=>r[13]||(r[13]=[Q(" View Your Score ")])),_:1})):T("",!0)]),e(f)===e(x).HAS_FINISHED?(d(),v("div",Et,[e(w)?e(g)&&e(H)<e(g)?(d(),A(G,{key:1,class:"w-full md:w-1/2",type:"primary",onClick:r[5]||(r[5]=L=>e(j)(e(g)))},{default:D(()=>r[16]||(r[16]=[Q(" Add To Leaderboard ")])),_:1})):T("",!0):(d(),A(ce,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:D(()=>[r[14]||(r[14]=Q(" Please ")),m("a",{class:"cursor-pointer",onClick:r[4]||(r[4]=L=>e(K).push({name:e(Ke).LOGIN,params:{redirect:JSON.stringify({name:e(Ue).GAMES_PATIENCE})}}))}," Login "),r[15]||(r[15]=Q(" to add your score to the leaderboard. "))]),_:1}))])):T("",!0)],2),p(Ge,{"is-open":_.value,"onUpdate:isOpen":r[6]||(r[6]=L=>_.value=L)},null,8,["is-open"])]),_:1}))}});export{Nt as default};
