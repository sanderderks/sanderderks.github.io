import{M as b,bS as q,q as P,bU as U,bW as C,bT as E,aS as w,aQ as M,aC as B,aX as N,aK as R,s as y,bH as p,I as s,v as c,bM as T,bi as o,bZ as I}from"../bundle.js";import{a as O,_ as f}from"./c-Bubble.vue_vue_type_script_setup_true_lang-D9wpE-yC.js";import{_ as j,a as A,b as F}from"./c-PasswordField.vue_vue_type_script_setup_true_lang-B4hrd1-q.js";import{_ as G}from"./c-Page.vue_vue_type_script_setup_true_lang-GCQpNNfB.js";import{R as g}from"./c-validation-Bf-E2UlI.js";import"./c-TextField.vue_vue_type_script_setup_true_lang-DhuayGui.js";const H={class:"flex flex-col items-center content-center"},J={class:"grid grid-cols-4 mt-10 gap-3"},K=b({__name:"Login",setup(S){const l=q(),t=P(()=>l.params.redirect?JSON.parse(l.params.redirect):void 0),n=U(),{isLoginLoading:k,firebaseUser:x}=C(n),i=E(),{initEmail:u,initPassword:m}=i.currentRoute.value.query,d=w(),_=w(),e=M({email:{value:(u==null?void 0:u.toString())||"",error:""},password:{value:(m==null?void 0:m.toString())||"",error:""}}),L=async()=>{Object.keys(e).forEach(v=>e[v].error=""),await Promise.all([d.value.test(),_.value.test()]),!e.email.error&&!e.password.error&&(await n.login(e.email.value,e.password.value),x.value&&t.value&&i.push(t.value))},V=async()=>{await d.value.test(),e.email.error||n.resetPassword(e.email.value)};return B(()=>{i.replace({query:void 0})}),(v,a)=>{const $=N("RouterLink");return R(),y(G,null,{content:p(()=>[s(O,{class:"!bg-primary-800 !bg-opacity-50 my-5",title:"Login",description:"Please login using your e-mail and password."},{default:p(()=>[c("div",H,[c("form",{class:"w-full lg:w-1/2 xl:w-1/3 px-8 pt-6 pb-8 mb-4",onSubmit:a[4]||(a[4]=T(r=>L(),["prevent"]))},[s(j,{ref_key:"email",ref:d,name:"email",label:"E-mail",modelValue:e.email.value,"onUpdate:modelValue":a[0]||(a[0]=r=>e.email.value=r),error:e.email.error,"onUpdate:error":a[1]||(a[1]=r=>e.email.error=r),rules:[o(g).Required]},null,8,["modelValue","error","rules"]),s(A,{ref_key:"password",ref:_,name:"password",label:"Password",modelValue:e.password.value,"onUpdate:modelValue":a[2]||(a[2]=r=>e.password.value=r),error:e.password.error,"onUpdate:error":a[3]||(a[3]=r=>e.password.error=r),rules:[o(g).Required]},null,8,["modelValue","error","rules"]),c("div",J,[s(f,{class:"col-span-full md:col-span-2",action:"submit",loading:o(k),label:"Login"},null,8,["loading"]),s($,{class:"col-span-full md:col-span-2",to:{name:o(I).REGISTER,query:{initEmail:e.email.value,initPassword:e.password.value}}},{default:p(()=>[s(f,{class:"w-full",outlined:"",label:"Register"})]),_:1},8,["to"]),s(f,{class:"col-span-full md:col-span-2 md:col-start-3",outlined:"",label:"Forgot Password",onClick:V})])],32),s(F)])]),_:1})]),_:1})}}}),D=b({__name:"Login",setup(S){return(l,t)=>(R(),y(K))}});export{D as default};
