import{_ as De}from"./c-Dialog.vue_vue_type_script_setup_true_lang-0OqU2rqq.js";import{_ as Fe}from"./c-Page.vue_vue_type_script_setup_true_lang-UxItz0XY.js";import{d as Ge,r,a as qe,c as D,I as z,b as ue,v as ze,e as We,f as He,B as Je,s as Ye,g as U,o as s,h as S,i as I,m as q,j as Q,k as F,u as Qe,l as Ve,n as Pe,p as te,q as se,t as M,w as Me,x as Ke,F as Xe,R as J,y as o,z as m,_ as Y,A as h,C as G,D as we,E as Se,G as Ce,H as T,J as K,K as de,L as $e,M as Ze,N as ee,O as pe,P as et,Q as Ue,S as tt,T as he,U as ie,V as ce,W as ot,X as Oe,Y as at,Z as Le,$ as lt,a0 as H,a1 as ve,a2 as nt,a3 as Be,a4 as me,a5 as st,a6 as Ie,a7 as it,a8 as rt,a9 as ut,aa as ge,ab as ye,ac as fe}from"../bundle.js";import{_ as dt}from"./c-BackButton.vue_vue_type_script_setup_true_lang-BpRPS7sg.js";import{_ as _e,a as Ee,u as pt}from"./c-BlogPost.vue_vue_type_script_setup_true_lang-B83CXQ2B.js";const be=e=>(e==null?void 0:e.id)??ze(),ke=e=>{var u;return{content:(e==null?void 0:e.content.slice().map(We.mapOutgoing))??[],date:e!=null&&e.date?new Date(e.date):new Date,dateUpdated:e!=null&&e.dateUpdated?new Date(e.dateUpdated):new Date,title:(e==null?void 0:e.title)??"",description:(e==null?void 0:e.description)??"",descriptionFooter:(e==null?void 0:e.descriptionFooter)??"",coverImageUrl:(e==null?void 0:e.coverImageUrl)??"",timer:e!=null&&e.timer?new Date(e.timer):null,countdown:e!=null&&e.countdown?new Date(e.countdown):null,table:(e==null?void 0:e.table)??"",sections:((u=e==null?void 0:e.sections)==null?void 0:u.slice().map(l=>({...l,bullets:l.bullets.slice(),timer:l.timer?new Date(l.timer):null,countdown:l.countdown?new Date(l.countdown):null})))??[],alignment:(e==null?void 0:e.alignment)??"center",tableAlignment:(e==null?void 0:e.tableAlignment)??"left",colorPrimary:(e==null?void 0:e.colorPrimary)??"",colorSecondary:(e==null?void 0:e.colorSecondary)??"",colorTertiary:(e==null?void 0:e.colorTertiary)??"",opacityPrimary:(e==null?void 0:e.opacityPrimary)??"",opacitySecondary:(e==null?void 0:e.opacitySecondary)??"",opacityTertiary:(e==null?void 0:e.opacityTertiary)??"",locked:(e==null?void 0:e.locked)??!1,allowedUserIds:(e==null?void 0:e.allowedUserIds)??[],archived:(e==null?void 0:e.archived)??!1,datePinned:e!=null&&e.datePinned?new Date(e.datePinned):null}},oe=Ge("blogPostDialogStore",()=>{const e=r(!1),u=r(null),l=r(be(null)),d=r(ke(null)),c=qe({hasContentChanges:!1,hasStylingChanges:!1,hasSettingsChanges:!1}),n=D(()=>u.value?z.convert(u.value):null),$=D(()=>c.hasContentChanges),B=D(()=>c.hasStylingChanges),C=D(()=>c.hasSettingsChanges),P=()=>{u.value=null,l.value=be(null),d.value=ke(null),c.hasContentChanges=!1,c.hasStylingChanges=!1,c.hasSettingsChanges=!1},p=a=>{u.value=a,l.value=be(a),d.value=ke(a),e.value=!0},b=()=>{e.value=!1,P()},g=()=>z.Content.convert(d.value),v=()=>z.Styling.convert(d.value),k=()=>z.Settings.convert(d.value);return{isOpen:e,blogPostOriginal:u,blogPostMutationId:l,blogPostMutation:d,blogPostMutationChanges:c,blogPostOriginalMutation:n,hasBlogPostMutationContentChanges:$,hasBlogPostMutationStylingChanges:B,hasBlogPostMutationSettingsChanges:C,$reset:P,openWith:p,close:b,getBlogPostMutationContent:g,getBlogPostMutationStyling:v,getBlogPostMutationSettings:k,isMutationEqual:async()=>{n.value&&(c.hasContentChanges=!ue(z.Content.convert(n.value),g()),c.hasStylingChanges=!ue(z.Styling.convert(n.value),v()),c.hasSettingsChanges=!ue(z.Settings.convert(n.value),k()))}}});var ct=He`
    .p-card {
        background: dt('card.background');
        color: dt('card.color');
        box-shadow: dt('card.shadow');
        border-radius: dt('card.border.radius');
        display: flex;
        flex-direction: column;
    }

    .p-card-caption {
        display: flex;
        flex-direction: column;
        gap: dt('card.caption.gap');
    }

    .p-card-body {
        padding: dt('card.body.padding');
        display: flex;
        flex-direction: column;
        gap: dt('card.body.gap');
    }

    .p-card-title {
        font-size: dt('card.title.font.size');
        font-weight: dt('card.title.font.weight');
    }

    .p-card-subtitle {
        color: dt('card.subtitle.color');
    }
`,vt={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},mt=Je.extend({name:"card",style:ct,classes:vt}),gt={name:"BaseCard",extends:Ye,style:mt,provide:function(){return{$pcCard:this,$parentInstance:this}}},xe={name:"Card",extends:gt,inheritAttrs:!1};function yt(e,u,l,d,c,n){return s(),U("div",q({class:e.cx("root")},e.ptmi("root")),[e.$slots.header?(s(),U("div",q({key:0,class:e.cx("header")},e.ptm("header")),[Q(e.$slots,"header")],16)):S("",!0),I("div",q({class:e.cx("body")},e.ptm("body")),[e.$slots.title||e.$slots.subtitle?(s(),U("div",q({key:0,class:e.cx("caption")},e.ptm("caption")),[e.$slots.title?(s(),U("div",q({key:0,class:e.cx("title")},e.ptm("title")),[Q(e.$slots,"title")],16)):S("",!0),e.$slots.subtitle?(s(),U("div",q({key:1,class:e.cx("subtitle")},e.ptm("subtitle")),[Q(e.$slots,"subtitle")],16)):S("",!0)],16)):S("",!0),I("div",q({class:e.cx("content")},e.ptm("content")),[Q(e.$slots,"content")],16),e.$slots.footer?(s(),U("div",q({key:1,class:e.cx("footer")},e.ptm("footer")),[Q(e.$slots,"footer")],16)):S("",!0)],16)],16)}xe.render=yt;const ft={key:0,class:"flex justify-center mt-5"},bt={key:1,class:"flex flex-col gap-3"},kt=F({__name:"BlogDetails",emits:["createClicked","editClicked","deleteClicked"],setup(e){const u=Qe(),l=Ve(),d=Pe(),c=te(),n=se(),{routeLoading:$}=M(d),{isLoggedIn:B}=M(c),{blogPosts:C,blogReactions:P,isBlogPostsFetchLoading:p}=M(n),{fetchBlogPost:b}=n,g=D(()=>u.params.postId);return Me(async()=>{var v;if(P.value.unread=[],g.value)if(((v=C.value.data.single)==null?void 0:v.id)!==g.value){const k=await b(g.value);if(Ke(k)&&k===Xe.PERMISSION_DENIED&&!B.value){l.push({name:J.LOGIN,params:{redirect:JSON.stringify({name:J.BLOG_DETAILS,params:{postId:g.value}})}});return}}else C.value.data.single}),(v,k)=>o(p)?(s(),U("div",ft,[m(Y,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:"",label:"Loading..."})])):(s(),U("div",bt,[m(dt,{"back-route":o(J).BLOG,label:"Back to other posts"},null,8,["back-route"]),o(C).data.single?(s(),h(_e,{key:0,post:o(C).data.single,onEditClicked:k[0]||(k[0]=t=>v.$emit("editClicked",o(C).data.single)),onDeleteClicked:k[1]||(k[1]=t=>v.$emit("deleteClicked",o(C).data.single))},null,8,["post"])):S("",!0)]))}}),Te=F({__name:"BlogPostSectionTitle",props:{class:{},alignment:{},isExpandable:{type:Boolean},isExpanded:{type:Boolean},isSubTitle:{type:Boolean}},emits:["click"],setup(e){const u=e;return(l,d)=>(s(),U("div",{class:G(["font-bold",{"text-lg md:text-2xl":!l.isSubTitle},{"hover:underline cursor-pointer":l.isExpandable},u.class])},[I("div",{class:G({block:!l.alignment,flex:!!l.alignment,"justify-start":l.alignment==="left","justify-center":l.alignment==="center","justify-end":l.alignment==="right"})},[I("span",{class:"flex",onClick:d[0]||(d[0]=c=>l.$emit("click"))},[l.isExpandable&&l.alignment==="right"?(s(),U("i",{key:0,class:G(["pi pi-angle-down animation",{"rotate-180":l.isExpanded}])},null,2)):S("",!0),Q(l.$slots,"default"),l.isExpandable&&(l.alignment==="left"||l.alignment==="center")?(s(),U("i",{key:1,class:G(["pi pi-angle-down animation",{"rotate-180":l.isExpanded}])},null,2)):S("",!0)])],2)],2))}}),Ct={class:"flex gap-3"},ht={class:"min-h-[50vh] flex flex-col"},Pt={class:"flex justify-between h-fit mt-2 gap-2"},wt={class:"flex flex-wrap gap-3"},St={class:"relative mt-5 min-h-[20vh] max-h-screen flex flex-col justify-end"},$t={class:"relative min-h-[20vh] max-h-full flex-grow"},Ut={class:"w-full"},Bt={key:3,class:"w-full"},It={class:"flex justify-center mt-5"},Et={class:"flex justify-center mt-3"},Tt=F({__name:"BlogPostOverview",props:{post:{}},emits:["editClicked","deleteClicked"],setup(e){const u=e,l=Pe(),d=te(),c=we(),{routeLoading:n,routeLoadingId:$}=M(l),{publicUsers:B}=M(c),{isOwner:C}=M(d),P=r(u.post.archived),p=D(()=>{var t;return(t=u.post.allowedUserIds)!=null&&t.length?B.value.filter(a=>{var i;return(i=u.post.allowedUserIds)==null?void 0:i.includes(a.id)}):[]}),b=D(()=>{const t=Se(u.post.date);return u.post.dateUpdated?t+` - updated ${Se(u.post.dateUpdated)}`:t}),g=D(()=>{const t=[];return u.post.datePinned&&t.push({value:"Pinned",severity:"success",rounded:!1}),u.post.locked&&t.push({value:"Locked",severity:"danger",rounded:!1,icon:"pi pi-lock"}),u.post.archived&&t.push({value:"Archived",severity:"warning",rounded:!1,icon:"pi pi-file-excel"}),t}),v=D(()=>u.post.sections.length?u.post.sections[0]:null),k=()=>{const t=document.createElement("textarea"),{protocol:a,hostname:i,port:E}=window.location,w=`${a}//${i}`+(i==="localhost"?`:${E}`:"");t.value=`${w}#${tt.BLOG.path}/${u.post.id}`,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),he.success("Copied link!")};return(t,a)=>(s(),h(Ce,{id:t.post.id,class:G([{"min-h-[50vh]":!P.value},"border-4 border-transparent","!rounded-primary",t.post.colorSecondary||t.post.colorPrimary||"bg-secondary-900",t.post.opacitySecondary||"bg-opacity-50"]),title:t.post.title,subTitle:b.value,tags:g.value,loading:t.post.loading,isCollapsed:P.value,clickable:"",route:{name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}},{right:T(()=>[I("div",Ct,[P.value?o(C)?(s(),h(Ee,{key:1,onEditClicked:a[0]||(a[0]=i=>t.$emit("editClicked")),onDeleteClicked:a[1]||(a[1]=i=>t.$emit("deleteClicked"))})):S("",!0):(s(),h(Y,{key:0,class:"border-none h-fit",variant:"neutral",icon:"pi pi-copy",onClick:k}))])]),default:T(()=>{var i;return[I("div",ht,[I("div",Pt,[I("div",wt,[p.value.length?(s(),U(K,{key:0},[m(o(de),{class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:p.value[0].displayName,rounded:""},null,8,["label"]),p.value.length>1?(s(),h(o(de),{key:0,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:"You",rounded:""})):S("",!0),p.value.length>2?(s(),h(o(de),{key:1,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",label:`${p.value.length-2} others`,rounded:""},null,8,["label"])):S("",!0)],64)):S("",!0)]),o(C)?(s(),U("div",{key:0,class:G(["flex justify-end ms-5",(i=t.post.allowedUserIds)!=null&&i.length?"flex-col md:flex-row":"flex-row"])},[m(Ee,{onEditClicked:a[2]||(a[2]=E=>t.$emit("editClicked")),onDeleteClicked:a[3]||(a[3]=E=>t.$emit("deleteClicked"))})],2)):S("",!0)]),I("div",St,[a[6]||(a[6]=I("div",{class:"absolute inset-0 rounded-primary bg-gradient-to-t from-neutral-500 to-transparent"},null,-1)),I("div",$t,[m(o(xe),{class:G(["z-10 min-h-[20vh] p-5 text-neutral-300",t.post.colorPrimary,t.post.opacityPrimary||"bg-opacity-50"])},{header:T(()=>[t.post.coverImageUrl?(s(),h(et,{key:0,post:t.post,"cover-image-url":t.post.coverImageUrl,thumb:""},null,8,["post","cover-image-url"])):S("",!0)]),content:T(()=>[I("div",{class:G(["flex relative",t.post.countdown||t.post.alignment==="center"?"flex justify-between":""])},[I("div",Ut,[t.post.countdown?(s(),h($e,{key:0,time:new Date(t.post.countdown).getTime(),direction:"down",alignment:t.post.alignment},null,8,["time","alignment"])):S("",!0),t.post.timer?(s(),h($e,{key:1,time:new Date(t.post.timer).getTime(),direction:"up",alignment:t.post.alignment},null,8,["time","alignment"])):S("",!0),t.post.description?(s(),h(Ze,{key:2,description:t.post.description.substring(0,150)+(t.post.description.length>=150?"...":"")},null,8,["description"])):v.value?(s(),U("div",Bt,[v.value.title?(s(),h(Te,{key:0,alignment:v.value.alignment},{default:T(()=>[ee(pe(v.value.subTitle?v.value.title:`${v.value.title}...`),1)]),_:1},8,["alignment"])):S("",!0),v.value.subTitle?(s(),h(Te,{key:1,alignment:v.value.alignment,"is-sub-title":""},{default:T(()=>[ee(pe(v.value.subTitle)+"... ",1)]),_:1},8,["alignment"])):S("",!0)])):S("",!0)])],2)]),_:1},8,["class"])])]),I("div",It,[m(Y,{class:"w-full md:w-1/2",variant:"neutral",label:"Read more",loading:o(n)===o(J).BLOG_DETAILS&&o($)===t.post.id,onClick:a[4]||(a[4]=E=>o(Ue).push({name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}))},null,8,["loading"])]),I("div",Et,[I("p",{class:G(t.post.reactions.length?"text-yellow-400 hover:text-yellow-500 cursor-pointer":"text-neutral-200"),onClick:a[5]||(a[5]=E=>o(Ue).push({name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}))},pe(t.post.reactions.length)+" replies ",3)])])]}),_:1},8,["id","class","title","subTitle","tags","loading","isCollapsed","route"]))}}),Dt={class:"w-full grid gap-4 md:gap-10 xl:gap-20"},Vt={key:2,class:"w-full flex justify-center mt-5"},Mt=F({__name:"BlogPosts",props:{single:{type:Boolean}},emits:["createClicked","editClicked","deleteClicked"],setup(e){const u=te(),l=se(),{blogPosts:d,visibleBlogPosts:c,isBlogPostsFetchLoading:n}=M(l),{firebaseUser:$,isLoggedIn:B,isOwner:C}=M(u),{fetchBlogPosts:P}=l;pt();const p=r(),b=r(),g=r(),v=async t=>{var a;d.value.visibility!==t&&(d.value.data[t].length||await P((a=$.value)==null?void 0:a.uid,{visibility:t}),d.value.visibility=t,d.value.isLastPage=!1,ce(p.value))},k=async()=>{var a;const t=c.value.length;await P((a=$.value)==null?void 0:a.uid),c.value[t]&&ce(b.value[t])};return Me(()=>{d.value.loadedOnce||(B.value?v("private"):d.value.visibility!=="public"&&v("public"),d.value.loadedOnce=!0)}),ie(()=>{var t;return(t=b.value)==null?void 0:t.length},()=>{var t;if((t=b.value)!=null&&t.length&&g.value){const a=c.value.find(i=>i.id===g.value);if(a){const i=c.value.indexOf(a);ce(b.value[i]),g.value=void 0}}}),(t,a)=>(s(),U("div",{ref_key:"container",ref:p,class:"flex flex-col gap-5 items-center"},[o(C)?(s(),h(Y,{key:0,class:"w-full md:w-1/2",variant:"tertiary",label:"New Post",onClick:a[0]||(a[0]=i=>t.$emit("createClicked"))})):S("",!0),o(B)?(s(),h(o(ot),{key:1,class:"w-full md:w-1/2"},{default:T(()=>[m(Y,{class:"w-full",variant:"secondary",outlined:o(d).visibility!=="public",loading:o(d).isLoading.public.fetch,label:"Public Posts",onClick:a[1]||(a[1]=i=>v("public"))},null,8,["outlined","loading"]),m(Y,{class:"w-full",variant:"secondary",outlined:o(d).visibility!=="private",loading:o(d).isLoading.private.fetch,label:"Private Posts",onClick:a[2]||(a[2]=i=>v("private"))},null,8,["outlined","loading"])]),_:1})):S("",!0),I("div",Dt,[o(c).length?(s(!0),U(K,{key:0},Oe(o(c),(i,E)=>(s(),U("div",{key:i.id,ref_for:!0,ref_key:"posts",ref:b},[E===0||i.datePinned?(s(),h(_e,{key:0,post:i,onEditClicked:w=>t.$emit("editClicked",i),onDeleteClicked:w=>t.$emit("deleteClicked",i)},null,8,["post","onEditClicked","onDeleteClicked"])):(s(),h(Tt,{key:1,post:i,onEditClicked:w=>t.$emit("editClicked",i),onDeleteClicked:w=>t.$emit("deleteClicked",i)},null,8,["post","onEditClicked","onDeleteClicked"]))]))),128)):o(n)?(s(),h(Ce,{key:1,class:"!bg-neutral-600 !bg-opacity-40 !rounded-primary",title:"Loading..."})):(s(),h(Ce,{key:2,class:"!bg-red-900 !bg-opacity-40 !rounded-primary",title:"No posts"}))]),o(d).isLastPage?S("",!0):(s(),U("div",Vt,[m(Y,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:o(c).length>0&&o(n),label:"Load more posts",onClick:k},null,8,["loading"])]))],512))}}),Ot=F({__name:"BlogPostContentDialog",emits:["update:selected","error"],setup(e,{expose:u,emit:l}){const d=l,c=oe(),{blogPostMutation:n}=M(c),$=r(),B=r(),C=D(()=>[B.value].some(p=>!!p));return u({test:async()=>{await Promise.all([$.value.test()]),d("error",C.value)}}),(p,b)=>(s(),U(K,null,[m(at,{ref_key:"title",ref:$,name:"title",label:"Title",placeholder:"Amazing Post",modelValue:o(n).title,"onUpdate:modelValue":b[0]||(b[0]=g=>o(n).title=g),error:B.value,"onUpdate:error":b[1]||(b[1]=g=>B.value=g),rules:[o(Le).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),m(lt,{modelValue:o(n).content,"onUpdate:modelValue":b[2]||(b[2]=g=>o(n).content=g)},null,8,["modelValue"])],64))}}),Lt=F({__name:"BlogPostSettingsDialog",emits:["error"],setup(e,{expose:u,emit:l}){const d=l,c=te(),n=we(),$=oe(),{publicUser:B,publicUsers:C}=M(n),{firebaseUser:P}=M(c),{blogPostMutation:p}=M($),{allowedPublicUsers:b}=n,g=r(),v=r(),k=r(),t=r(),a=D({get(){return!!p.value.datePinned},set(_){p.value.datePinned=_?new Date:null}}),i=r(),E=r(),w=r(),O=r(),L=D(()=>[i.value,E.value,w.value,O.value].some(_=>!!_)),f=D(()=>C.value.map(({id:_,displayName:x})=>({value:_,label:x}))),y=r([]),ae=_=>{p.value.allowedUserIds=_},le=async()=>{p.value.allowedUserIds.length&&!y.value.length&&(i.value="Invalid user ID's"),await Promise.all([v.value.test(),k.value.test(),t.value.test()]),d("error",L.value)};return ie(()=>p.value.allowedUserIds,async _=>{y.value=await b(_)},{immediate:!0}),u({test:le}),(_,x)=>(s(),U(K,null,[m(H,{ref_key:"allowedUsers",ref:g,name:"allowedUserIds",label:"Allowed users",placeholder:"This post is public","model-value":o(p).allowedUserIds,error:i.value,"onUpdate:error":x[0]||(x[0]=A=>i.value=A),"onUpdate:arrayValue":ae,options:[{value:o(P).uid,label:o(B).displayName},...f.value.filter(({value:A})=>{var ne;return A!==((ne=o(P))==null?void 0:ne.uid)})],multiple:""},null,8,["model-value","error","options"]),m(ve,{ref_key:"pinned",ref:t,name:"pinned",label:"Pinned",modelValue:a.value,"onUpdate:modelValue":x[1]||(x[1]=A=>a.value=A)},null,8,["modelValue"]),m(ve,{ref_key:"locked",ref:v,name:"locked",label:"Locked for commenting",modelValue:o(p).locked,"onUpdate:modelValue":x[2]||(x[2]=A=>o(p).locked=A)},null,8,["modelValue"]),m(ve,{ref_key:"archived",ref:k,name:"archived",label:"Archived",modelValue:o(p).archived,"onUpdate:modelValue":x[3]||(x[3]=A=>o(p).archived=A)},null,8,["modelValue"])],64))}}),_t=F({__name:"BlogPostStylingDialog",emits:["error"],setup(e,{expose:u,emit:l}){const d=l,c=oe(),{blogPostMutation:n}=M(c),$=r(),B=r(),C=r(),P=r(),p=r(),b=r(),g=r(),v=r(),k=r(),t=r(),a=r(),i=r(),E=D(()=>[g.value,v.value,k.value,t.value,a.value,i.value].some(L=>!!L)),w=D(()=>nt(Be.find(L=>L.value===n.value.colorPrimary)));return u({test:async()=>{await Promise.all([$.value.test(),B.value.test(),C.value.test(),P.value.test(),p.value.test(),b.value.test()]),d("error",E.value)}}),(L,f)=>(s(),U(K,null,[m(H,{ref_key:"colorPrimary",ref:$,name:"colorPrimary",label:"Primary Style",modelValue:o(n).colorPrimary,"onUpdate:modelValue":f[0]||(f[0]=y=>o(n).colorPrimary=y),error:g.value,"onUpdate:error":f[1]||(f[1]=y=>g.value=y),options:o(Be),rules:[o(Le).Required]},null,8,["modelValue","error","options","rules"]),m(H,{ref_key:"opacityPrimary",ref:P,name:"opacityPrimary",label:"Primary Opacity",modelValue:o(n).opacityPrimary,"onUpdate:modelValue":f[2]||(f[2]=y=>o(n).opacityPrimary=y),error:t.value,"onUpdate:error":f[3]||(f[3]=y=>t.value=y),options:o(me)},null,8,["modelValue","error","options"]),m(H,{ref_key:"colorSecondary",ref:B,name:"colorSecondary",label:"Secondary Style",modelValue:o(n).colorSecondary,"onUpdate:modelValue":f[4]||(f[4]=y=>o(n).colorSecondary=y),error:v.value,"onUpdate:error":f[5]||(f[5]=y=>v.value=y),options:w.value},null,8,["modelValue","error","options"]),m(H,{ref_key:"opacitySecondary",ref:p,name:"opacitySecondary",label:"Secondary Opacity",modelValue:o(n).opacitySecondary,"onUpdate:modelValue":f[6]||(f[6]=y=>o(n).opacitySecondary=y),error:a.value,"onUpdate:error":f[7]||(f[7]=y=>a.value=y),options:o(me)},null,8,["modelValue","error","options"]),m(H,{ref_key:"colorTertiary",ref:C,name:"colorTertiary",label:"Tertiary Style",modelValue:o(n).colorTertiary,"onUpdate:modelValue":f[8]||(f[8]=y=>o(n).colorTertiary=y),error:k.value,"onUpdate:error":f[9]||(f[9]=y=>k.value=y),options:o(st)},null,8,["modelValue","error","options"]),m(H,{ref_key:"opacityTertiary",ref:b,name:"opacityTertiary",label:"Tertiary Opacity",modelValue:o(n).opacityTertiary,"onUpdate:modelValue":f[10]||(f[10]=y=>o(n).opacityTertiary=y),error:i.value,"onUpdate:error":f[11]||(f[11]=y=>i.value=y),options:o(me)},null,8,["modelValue","error","options"])],64))}}),xt=F({__name:"BlogPostDialog",emits:["scroll-to-updated"],setup(e,{emit:u}){const l=u,d=te(),c=se(),n=oe(),{firebaseUser:$}=M(d),{isBlogPostsMutationLoading:B}=M(c),{createBlogPost:C,updateBlogPost:P,deleteFilesOfBlogPost:p,toggleBlogPostVisibility:b}=c,{getBlogPostMutationContent:g,getBlogPostMutationStyling:v,getBlogPostMutationSettings:k}=n,{isOpen:t,blogPostOriginal:a,blogPostMutationId:i,blogPostMutation:E,hasBlogPostMutationContentChanges:w,hasBlogPostMutationStylingChanges:O,hasBlogPostMutationSettingsChanges:L}=M(n),f=r(),y=r(),ae=r(),le=r(),_=r(!1),x=r(!1),A=r(!1),ne=D(()=>{var N,V,R,X,Z,j;return!!((V=(N=a.value)==null?void 0:N.allowedUserIds)!=null&&V.length)&&!((R=k().allowedUserIds)!=null&&R.length)||!((Z=(X=a.value)==null?void 0:X.allowedUserIds)!=null&&Z.length)&&!!((j=k().allowedUserIds)!=null&&j.length)}),Ae=D(()=>{const N=[];return w.value&&N.push("Content"),O.value&&N.push("Styling"),L.value&&N.push("Settings"),N.length?"Update "+Ie(N):void 0}),re=D(()=>it(a.value)),Ne=async()=>{var N,V,R,X,Z;if(await Promise.all([y.value.test(),ae.value.test(),le.value.test()]),!(_.value||x.value||A.value))if(!a.value)await C(i.value,E.value,(N=$.value)==null?void 0:N.uid)&&(n.close(),l("scroll-to-updated",i.value));else if(ne.value){const j=i.value;n.isOpen=!1,await b(j,z.convert(E.value),a.value.reactions,E.value.allowedUserIds.length?"private":"public",(V=$.value)==null?void 0:V.uid)&&(n.close(),he.success("Successfully updated Post Visibility"),l("scroll-to-updated",j))}else{const j=i.value;let W=[];w.value&&W.push(await P(j,g(),re.value,(R=$.value)==null?void 0:R.uid)),O.value&&W.push(await P(j,v(),re.value,(X=$.value)==null?void 0:X.uid)),L.value&&(W.push(await P(j,k(),re.value,(Z=$.value)==null?void 0:Z.uid)),l("scroll-to-updated",j)),W=W.filter(je=>typeof je=="string"),W.length&&(he.success(`Successfully updated Post ${Ie(W)}`),n.close())}},Re=async()=>{p(E.value,a.value??void 0),n.close()};return ie(E,()=>{n.isMutationEqual()},{deep:!0}),(N,V)=>(s(),h(De,{isOpen:o(t),title:o(a)?"Update Post":"Create Post",description:o(a)?"Update this post":"Create a new post","confirm-text":o(a)?Ae.value:"Create","confirm-loading":o(B),onConfirm:Ne,onCancel:Re},{default:T(()=>[I("form",{ref_key:"dialog",ref:f,class:"pt-6 mb-4 xl:px-16"},[o(t)?(s(),h(o(rt),{key:0,"active-index":0,onTabOpen:o(ut)},{default:T(()=>[m(o(fe),{value:"content"},{default:T(()=>[m(o(ge),null,{default:T(()=>V[3]||(V[3]=[ee(" Content ")])),_:1,__:[3]}),m(o(ye),null,{default:T(()=>[m(Ot,{ref_key:"content",ref:y,onError:V[0]||(V[0]=R=>_.value=R)},null,512)]),_:1})]),_:1}),m(o(fe),{value:"styling"},{default:T(()=>[m(o(ge),null,{default:T(()=>V[4]||(V[4]=[ee(" Styling ")])),_:1,__:[4]}),m(o(ye),null,{default:T(()=>[m(_t,{ref_key:"styling",ref:ae,onError:V[1]||(V[1]=R=>x.value=R)},null,512)]),_:1})]),_:1}),m(o(fe),{value:"settings"},{default:T(()=>[m(o(ge),null,{default:T(()=>V[5]||(V[5]=[ee(" Settings ")])),_:1,__:[5]}),m(o(ye),null,{default:T(()=>[m(Lt,{ref_key:"settings",ref:le,onError:V[2]||(V[2]=R=>A.value=R)},null,512)]),_:1})]),_:1})]),_:1},8,["onTabOpen"])):S("",!0)],512)]),_:1},8,["isOpen","title","description","confirm-text","confirm-loading"]))}}),At={class:"grid mt-10 md:mt-15"},Nt={class:"grid justify-center"},Rt={class:"text-lg md:text-xl text-white"},jt=["innerHTML"],Ft={class:"grid my-5 xl:px-20"},Gt=F({__name:"Blog",setup(e){const u=Ve(),l=Pe(),d=we(),c=se(),n=oe(),{menuItems:$,content:B}=M(l),{publicUser:C}=M(d),{deleteBlogPost:P}=c,p=r(null),b=r(),g=r(!1),v=r(u.currentRoute.value.params.postId),k=D(()=>{var w;return C.value?[...B.value.blogDescriptionUser.map(O=>O.replace("%USER%",C.value.displayName||"Unknown user")),...((w=$.value.find(O=>O.id==="nfNQM4SMESU2VOkJtcgY"))==null?void 0:w.description)||[]]:B.value.blogDescriptionGuest}),t=()=>{n.openWith(null)},a=w=>{n.openWith(w)},i=w=>{p.value=w,g.value=!0},E=async w=>{await P(w)&&(g.value=!1,p.value=null)};return ie(u.currentRoute,w=>{v.value=w.params.postId}),(w,O)=>(s(),h(Fe,null,{content:T(()=>[I("div",At,[I("div",Nt,[(s(!0),U(K,null,Oe(k.value,L=>(s(),U("h1",Rt,[I("span",{innerHTML:L},null,8,jt)]))),256))]),I("div",Ft,[v.value?(s(),h(kt,{key:0,onEditClicked:a,onDeleteClicked:i})):(s(),h(Mt,{key:1,onCreateClicked:t,onEditClicked:a,onDeleteClicked:i})),m(xt,{onScrollToUpdated:O[0]||(O[0]=L=>b.value=L)}),p.value?(s(),h(De,{key:2,title:"Delete Post",isOpen:g.value,description:[` Are you sure you want to delete this post called ' ${p.value.title}'?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},onConfirm:O[1]||(O[1]=L=>E(p.value.id)),onCancel:O[2]||(O[2]=L=>g.value=!1)},null,8,["isOpen","description"])):S("",!0)])])]),_:1}))}}),Yt=F({__name:"Blog",setup(e){return(u,l)=>(s(),h(Gt))}});export{Yt as default};
