import{q as ae,G as ne,s as z,z as F,C as c,X as H,d as le,b as a,c as g,e as f,Y as X,t as V,T as ie,l as oe,g as n,w as B,Z as de,f as e,h,R as M,_ as Z,J as u,$ as S,a0 as ee,a1 as ve,a2 as ce,a3 as pe,O as $,Q as fe,a4 as ye,i as T,k as te,j as me,a5 as ge,B as be}from"../bundle.js";import{_ as he}from"./c-BackButton.vue_vue_type_script_setup_true_lang-DVCFWGtb.js";import{D as A,u as we,_ as xe}from"./c-useDateChart-CUtQUbNq.js";import{_ as ke}from"./c-Dialog.vue_vue_type_script_setup_true_lang-Cg8Yx5Jw.js";import{_ as De}from"./c-Page.vue_vue_type_script_setup_true_lang-C2l5ciLA.js";import{u as _e}from"./c-useCatCalc-8L7-CzdD.js";import{_ as Se}from"./c-PetDialog.vue_vue_type_script_setup_true_lang-CGivOTtA.js";import{_ as Ae}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import"./c-useUsers-DiKbhbPK.js";const W=b=>{const o=ae(),w=ne(),{isOwner:k,firebaseUser:r}=z(o),{publicUsers:D}=z(w),O=1e3*60*60*24*365.25,C=F(A.MONTHS),s=c(()=>H(b)),v=c(()=>s.value?.dateOfBirth?(new Date().getTime()-new Date(s.value.dateOfBirth).getTime())/O:0),y=c(()=>v.value*12),_=c(()=>v.value*52),t=c(()=>D.value.find(i=>i.id===s.value?.userId)),x=c(()=>D.value.find(i=>i.id===s.value?.coOwnerId)),P=c(()=>s.value?.userId===r.value?.uid||k.value),L=c(()=>s.value?.weightLog.map(i=>({date:new Date(i.date),value:i.weight}))??[]),{headers:G,filteredData:Y}=we(L,C),N=c(()=>{if(!s.value||!s.value.dateOfBirth)return null;const i=s.value.vetDate?new Date(s.value.vetDate):null;if(i)return v.value<=7?m(i,1,1):m(i,2,1);if(s.value.type==="cat")return m(new Date(s.value.dateOfBirth),52,10);if(s.value.type==="dog")return m(new Date(s.value.dateOfBirth),52,4)}),q=c(()=>{if(!s.value||!s.value.dateOfBirth)return null;const i=s.value.dewormingDate?new Date(s.value.dewormingDate):null;if(i){if(_.value<=9)return m(i,52,2);if(y.value<=3)return m(i,12,3);if(y.value<=6)return m(i,12,1);if(s.value.type==="cat")return m(i,12,s.value.insideCat?6:3);if(s.value.type==="dog")return m(i,12,3)}else return m(new Date(s.value.dateOfBirth),52,3)}),m=(i,I,R)=>new Date(i.getTime()+O/I*R);return{weightLogPeriod:C,petAgeYears:v,petAgeMonths:y,petAgeWeeks:_,petOwner:t,petCoOwner:x,isMyPet:P,nextVetVisit:N,nextDeworming:q,chartHeaders:G,chartData:Y}},Oe=b=>{const o=c(()=>H(b)),{petAgeYears:w,petAgeMonths:k}=W(o),r=c(()=>{if(o.value?.type!=="cat"||!o.value?.dateOfBirth)return null;const v=w.value;switch(!0){case v<1:return{value:"kitten",label:"Kitten (0-12 months)"};case(v>=1&&v<3):return{value:"junior",label:"Junior (1-2 years)"};case(v>=3&&v<7):return{value:"adult",label:"Adult (3-6 years)"};case(v>=7&&v<11):return{value:"mature",label:"Mature (7-10 years)"};case(v>=11&&v<15):return{value:"senior",label:"Senior (11-14 years)"};case v>=15:return{value:"geriatric",label:"Geriatric (15+ years)"};default:return null}}),D=c(()=>o.value?o.value.weightLog.length?o.value.weightLog.map(y=>({...y,date:new Date(y.date).getTime()})).sort((y,_)=>_.date-y.date)[0].weight:o.value.weight??null:null),O=c(()=>o.value?.dateOfBirth?r.value?.value==="kitten"?k.value<=4?"kitten0.4":"kitten1":o.value?.castrated?"castrated":"default":null),{requiredCaloriesByWeightAndAgeAndSize:C,requiredFoodDry:s}=_e("average",D.value??"",O.value??"default",o.value?.gender??"male","35","default");return{catLifeStage:r,petWeight:D,requiredCaloriesByWeightAndAgeAndSize:r?C:null,requiredFoodDry:r?s:null}},Ce=b=>{const o=c(()=>H(b)),{petAgeYears:w}=W(o);return{dogLifeStage:c(()=>{if(o.value?.type!=="dog"||!o.value?.dateOfBirth||!o.value?.breedSize)return null;const r=w.value;switch(o.value.breedSize){case"small":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<8?{value:"adult",label:"Adult (3-7 years)"}:r<11?{value:"mature",label:"Mature (8-10 years)"}:r<15?{value:"senior",label:"Senior (11-14 years)"}:{value:"geriatric",label:"Geriatric (15+ years)"};case"medium":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<7?{value:"adult",label:"Adult (3-6 years)"}:r<10?{value:"mature",label:"Mature (7-9 years)"}:r<13?{value:"senior",label:"Senior (10-12 years)"}:{value:"geriatric",label:"Geriatric (13+ years)"};case"large":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<6?{value:"adult",label:"Adult (3-5 years)"}:r<9?{value:"mature",label:"Mature (6-8 years)"}:r<12?{value:"senior",label:"Senior (9-11 years)"}:{value:"geriatric",label:"Geriatric (12+ years)"};case"giant":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<2?{value:"young_adult",label:"Young Adult (1-1.5 years)"}:r<5?{value:"adult",label:"Adult (2-4 years)"}:r<8?{value:"mature",label:"Mature (5-7 years)"}:r<10?{value:"senior",label:"Senior (8-9 years)"}:{value:"geriatric",label:"Geriatric (10+ years)"};default:return null}})}},Be={class:"ms-5 max-sm:mt-3 md:ms-10 grid grid-cols-1 sm:grid-cols-[1fr_2fr] gap-1 sm:gap-3 justify-between"},d=le({__name:"KeyValuePair",props:{title:{},value:{},titleProps:{},valueProps:{}},setup(b){return(o,w)=>(a(),g("div",Be,[f("p",X({class:"font-bold text-nowrap"},b.titleProps),V(b.title),17),f("p",X({class:"text-neutral-300"},b.valueProps),V(b.value),17)]))}}),Pe={class:"break-words text-neutral-300"},Le={class:"flex flex-col gap-10"},$e={key:2,class:"max-sm:mt-5 ms-5 md:ms-10 pi pi-sync animate-spin text-neutral-300"},Te={key:0,class:"flex flex-wrap md:flex-nowrap gap-3 justify-around"},Ve={class:"flex flex-col md:items-center"},Ye={class:"text-indigo-300 font-bold"},Ne={class:"text-gray-300 italic"},Ie={class:"mt-3 flex justify-center gap-3"},Re={key:0,class:"w-full text-neutral-300"},Ee={key:1,class:"flex gap-3"},Me={key:1,class:"flex justify-center"},ze=le({__name:"Pet",setup(b){const o=be(),w=me(),k=ie(),r=ae(),{pets:D}=z(k),{isLoggedIn:O}=z(r),{deletePet:C}=k,s=ge("statisticsRef"),v=F(!1),y=F(!1),_=c(()=>o.params.petId),t=c(()=>D.value.find(E=>E.id===_.value)),{weightLogPeriod:x,petOwner:P,petCoOwner:L,isMyPet:G,nextVetVisit:Y,nextDeworming:N,chartHeaders:q,chartData:m}=W(t),{catLifeStage:i,petWeight:I,requiredCaloriesByWeightAndAgeAndSize:R,requiredFoodDry:j}=Oe(t),{dogLifeStage:U}=Ce(t),{births:J,holidays:K,isLoading:re,fetchData:ue}=de(),se=async E=>{await C(E),w.push({name:M.PET_OVERVIEW})};return oe(()=>{t.value?.dateOfBirth&&setTimeout(()=>{ue(new Date(t.value.dateOfBirth),"all",{reverse:!0})},1e3)}),(E,l)=>(a(),n(De,null,{content:B(()=>[e(O)?(a(),g($,{key:0},[h(he,{"back-route":e(M).PET_OVERVIEW,label:"Back to all pets"},null,8,["back-route"]),t.value?(a(),n(Z,{key:0,class:"!bg-primary-500 !bg-opacity-35 my-5",title:t.value.name,"title-props":{class:"text-3xl md:text-5xl"},"title-wrapper-props":{class:"ms-5"},avatar:t.value.avatar??void 0,"avatar-props":{class:"h-20 w-20 md:h-32 md:w-32"}},{underTitle:B(()=>[f("p",Pe,V(t.value.description),1)]),default:B(()=>[f("div",Le,[f("div",null,[l[9]||(l[9]=f("h3",null,"Details",-1)),e(P)?(a(),n(d,{key:0,title:e(L)?"Owners:":"Owner:",value:e(L)?`${e(P).displayName} & ${e(L).displayName}`:e(P).displayName},null,8,["title","value"])):u("",!0),t.value.dateOfBirth?(a(),n(d,{key:1,title:"Date of birth:",value:e(S)(t.value.dateOfBirth)},null,8,["value"])):u("",!0),e(re)?(a(),g("i",$e)):u("",!0),e(K).length?(a(),n(d,{key:3,title:"On this date:",value:`~ ${e(ee)(e(K)).text}`,"title-props":{class:"text-yellow-300 italic"},"value-props":{class:"max-sm:ms-0 ms-2 text-neutral-100 italic"}},null,8,["value"])):u("",!0),e(J).length?(a(),n(d,{key:4,class:"max-sm:ms-3",title:"",value:`~ ${e(ee)(e(J)).text} was born`,"title-props":{class:"hidden sm:block"},"value-props":{class:"ms-2 text-neutral-100 italic"}},null,8,["value"])):u("",!0),t.value.type?(a(),n(d,{key:5,title:"Type:",value:e(ve).find(({value:p})=>p===t.value?.type)?.label??""},null,8,["value"])):u("",!0),t.value.breed?(a(),n(d,{key:6,title:"Breed:",value:t.value.breed},null,8,["value"])):u("",!0),t.value.breedSize&&t.value.type==="dog"?(a(),n(d,{key:7,title:"Breed size:",value:e(ce).find(({value:p})=>p===t.value?.breedSize)?.label??""},null,8,["value"])):u("",!0),t.value.gender?(a(),n(d,{key:8,title:"Gender:",value:e(pe).find(({value:p})=>p===t.value?.gender)?.label??""},null,8,["value"])):u("",!0),l[10]||(l[10]=f("h3",null,"Health",-1)),e(I)?(a(),n(d,{key:9,title:"Weight:",value:e(I)+"kg"},null,8,["value"])):u("",!0),typeof t.value.insideCat=="boolean"?(a(),n(d,{key:10,title:"Inside Cat:",value:t.value.insideCat?"Yes":"No"},null,8,["value"])):u("",!0),t.value.castrated!==void 0?(a(),n(d,{key:11,title:"Castrated:",value:t.value.castrated?"Yes":"No"},null,8,["value"])):u("",!0),t.value.vetDate?(a(),n(d,{key:12,title:"Last vet visit:",value:e(S)(t.value.vetDate)},null,8,["value"])):u("",!0),t.value.lastVaccinationDate?(a(),n(d,{key:13,title:"Last vaccination:",value:e(S)(t.value.lastVaccinationDate)},null,8,["value"])):u("",!0),t.value.dewormingDate?(a(),n(d,{key:14,title:"Last deworming:",value:e(S)(t.value.dewormingDate)},null,8,["value"])):u("",!0)]),t.value.dateOfBirth?(a(),g("div",Te,[h(ye,{class:"w-full md:w-3/4 text-neutral-300 bg-neutral-900 rounded-secondary",time:new Date(t.value.dateOfBirth).getTime(),direction:"up"},{birthdayText:B(()=>[...l[11]||(l[11]=[f("h4",{class:"text-xl xl:text-3xl text-pink-500 font-bold italic"},"Happy birthday!",-1)])]),onThisDay:B(({selected:p})=>[l[12]||(l[12]=f("h5",{class:"place-self-center xl:text-xl text-slate-400 font-bold"},"Also on this day:",-1)),(a(!0),g($,null,fe(p,Q=>(a(),g("div",Ve,[f("p",Ye,V(Q.year),1),f("p",Ne,V(Q.text),1)]))),256))]),_:1},8,["time"])])):u("",!0),f("div",null,[l[13]||(l[13]=f("h3",null,"Statistics",-1)),f("div",{ref_key:"statisticsRef",ref:s},[t.value.type==="cat"?(a(),g($,{key:0},[e(i)?(a(),n(d,{key:0,title:"Life stage:",value:e(i).label},null,8,["value"])):u("",!0),e(R)?(a(),n(d,{key:1,title:"Required energy per day:",value:e(R).toFixed(1)+" kcal"},null,8,["value"])):u("",!0),e(j)?(a(),n(d,{key:2,title:"Required dry food per day:",value:e(j).toFixed(1)+" g"},null,8,["value"])):u("",!0)],64)):t.value.type==="dog"?(a(),g($,{key:1},[e(U)?(a(),n(d,{key:0,title:"Life stage:",value:e(U).label},null,8,["value"])):u("",!0)],64)):u("",!0),e(Y)?(a(),n(d,{key:2,title:"Next vet visit:",value:e(S)(e(Y))},null,8,["value"])):u("",!0),t.value.nextVaccinationDate?(a(),n(d,{key:3,title:"Next vaccination:",value:e(S)(new Date(t.value.nextVaccinationDate))},null,8,["value"])):u("",!0),e(N)?(a(),n(d,{key:4,title:"Next deworming:",value:e(S)(e(N))},null,8,["value"])):u("",!0),t.value.weightLog.length?(a(),g($,{key:5},[f("div",Ie,[h(T,{variant:"neutral",label:"1 Year",outlined:e(x)===e(A).MONTHS,onClick:l[0]||(l[0]=p=>x.value=e(A).MONTHS)},null,8,["outlined"]),h(T,{variant:"neutral",label:"3 Years",outlined:e(x)===e(A).YEARS_HALF,onClick:l[1]||(l[1]=p=>x.value=e(A).YEARS_HALF)},null,8,["outlined"]),h(T,{variant:"neutral",label:"10 Years",outlined:e(x)===e(A).YEARS,onClick:l[2]||(l[2]=p=>x.value=e(A).YEARS)},null,8,["outlined"])]),h(xe,{headers:e(q),datasets:[{label:`${t.value.name}'s weight (kg)`,fill:!1,borderColor:"red",yAxisID:"y",tension:.4,data:e(m),spanGaps:!0}]},null,8,["headers","datasets"])],64)):u("",!0)],512),s.value?.childElementCount?u("",!0):(a(),g("p",Re," Nothing to show yet. "))]),e(G)?(a(),g("div",Ee,[h(T,{label:"Edit",outlined:"",onClick:l[3]||(l[3]=p=>v.value=!0)}),h(T,{label:"Delete",variant:"danger",outlined:"",onClick:l[4]||(l[4]=p=>y.value=!0)})])):u("",!0),h(Se,{"is-open":v.value,"original-pet":t.value??null,onClose:l[5]||(l[5]=p=>v.value=!1)},null,8,["is-open","original-pet"]),h(ke,{"is-open":y.value,title:"Delete Pet",description:"Are you sure you want to delete your pet?","confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},onConfirm:l[6]||(l[6]=p=>se(t.value.id)),onCancel:l[7]||(l[7]=p=>y.value=!1)},null,8,["is-open"])])]),_:1},8,["title","avatar"])):u("",!0)],64)):(a(),g("div",Me,[h(Z,{class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:B(()=>[l[14]||(l[14]=te(" Please ",-1)),f("a",{class:"cursor-pointer",onClick:l[8]||(l[8]=p=>e(w).push({name:e(M).LOGIN,params:{redirect:JSON.stringify({name:e(M).PET_DETAILS,params:{petId:_.value}})}}))}," Login "),l[15]||(l[15]=te(" to view this pet. ",-1))]),_:1})]))]),_:1}))}}),Qe=Ae(ze,[["__scopeId","data-v-de03ee83"]]);export{Qe as default};
