import{_ as T,a as ue}from"./c-Bubble.vue_vue_type_script_setup_true_lang-BnZmzn5o.js";import{B as fe,_ as ge,x as me,l as s,m as E,p as _,y as se,e as W,r as G,o as ye,q as g,k as l,c as f,au as Y,h as de,A as he,s as B,H as Z,u as be,f as we,av as De,g as Se,aw as _e,D as H,w as j,n as x,R as L,t as p,C as z,ax as Ce,ay as ke,az as Oe,aA as U,G as ie}from"../bundle.js";import{_ as Ae}from"./c-Countdown.vue_vue_type_script_setup_true_lang-D85vdNQ7.js";import{a as xe}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-BslGDv8j.js";import{_ as Ee}from"./c-Page.vue_vue_type_script_setup_true_lang-DZ-XFGOQ.js";import{u as Me}from"./c-useCatCalc-6gobbMX9.js";import{_ as Pe}from"./c-PetDialog.vue_vue_type_script_setup_true_lang-sgys28NM.js";import{_ as $e}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import"./c-DateField-CWvNIfkF.js";import"./c-FileUpload.vue_vue_type_script_setup_true_lang-CjJy5MB6.js";import"./c-TextField.vue_vue_type_script_setup_true_lang-B16KBOJM.js";import"./c-validation-DokkLKHB.js";import"./c-SelectField.vue_vue_type_script_setup_true_lang-DIKuGEia.js";import"./c-accordiontab.esm-CrO3SYCY.js";import"./c-vuedraggable.umd-6GGnRdAM.js";var Te={root:{position:"relative"}},Le={root:"p-chart"},Be=fe.extend({name:"chart",inlineStyles:Te,classes:Le}),Ye={name:"BaseChart",extends:me,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:Be,provide:function(){return{$parentInstance:this}}},pe={name:"Chart",extends:Ye,inheritAttrs:!1,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var e=this;ge(()=>import("./c-auto-U_pncEX3.js"),__vite__mapDeps([]),import.meta.url).then(function(a){e.chart&&(e.chart.destroy(),e.chart=null),a&&a.default&&(e.chart=new a.default(e.$refs.canvas,{type:e.type,data:e.data,options:e.options,plugins:e.plugins})),e.$emit("loaded",e.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(e){if(this.chart){var a=this.chart.getElementsAtEventForMode(e,"nearest",{intersect:!0},!1),u=this.chart.getElementsAtEventForMode(e,"dataset",{intersect:!0},!1);a&&a[0]&&u&&this.$emit("select",{originalEvent:e,element:a[0],dataset:u})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function R(t){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(t)}function oe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);e&&(u=u.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,u)}return a}function ce(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?oe(Object(a),!0).forEach(function(u){Re(t,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach(function(u){Object.defineProperty(t,u,Object.getOwnPropertyDescriptor(a,u))})}return t}function Re(t,e,a){return e=Ve(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Ve(t){var e=Ne(t,"string");return R(e)=="symbol"?e:String(e)}function Ne(t,e){if(R(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var u=a.call(t,e||"default");if(R(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fe=["width","height"];function Ie(t,e,a,u,n,b){return s(),E("div",se({class:t.cx("root"),style:t.sx("root")},t.ptmi("root")),[_("canvas",se({ref:"canvas",width:t.width,height:t.height,onClick:e[0]||(e[0]=function(w){return b.onCanvasClick(w)})},ce(ce({},t.canvasProps),t.ptm("canvas"))),null,16,Fe)],16)}pe.render=Ie;const He=W({__name:"Chart",props:{headers:{},datasets:{}},setup(t){const e=G(),a=()=>{const u=getComputedStyle(document.documentElement),n="white",b="white",w=u.getPropertyValue("--p-content-border-color");return{stacked:!1,maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:n}}},scales:{x:{ticks:{color:b},grid:{color:w}},y:{type:"linear",display:!0,position:"left",beginAtZero:!0,ticks:{color:b},grid:{color:w}},y1:{type:"linear",display:!1,position:"right",ticks:{color:b},grid:{drawOnChartArea:!1,color:w}}}}};return ye(()=>{e.value=a()}),(u,n)=>(s(),g(l(pe),{type:"line",data:{labels:u.headers,datasets:u.datasets},options:e.value,class:"h-[30rem]"},null,8,["data","options"]))}});var P=(t=>(t[t.MONTHS=0]="MONTHS",t[t.YEARS_HALF=1]="YEARS_HALF",t[t.YEARS=2]="YEARS",t))(P||{});const $={0:{amount:12,getStartDate:t=>{const e=new Date(t);return e.setMonth(e.getMonth()-$[0].amount+1,1),e},calculateStartDate:(t,e)=>{const a=new Date(t);return a.setMonth(a.getMonth()+e),a},calculateEndDate:t=>{const e=new Date(t);return e.setMonth(t.getMonth()+1,0),e},getLabel:t=>K[t.getMonth()]},1:{amount:10,getStartDate:t=>{const e=new Date(t);return e.setMonth(e.getMonth()-6*$[1].amount+1,1),e},calculateStartDate:(t,e)=>{const a=new Date(t);return a.setMonth(a.getMonth()+e*6),a},calculateEndDate:t=>{const e=new Date(t);return e.setMonth(e.getMonth()+6,0),e},getLabel:(t,e)=>{const a=K[t.getMonth()].substring(0,3),u=K[e.getMonth()].substring(0,3);return`${a}-${u} ${e.getFullYear()}`}},2:{amount:10,getStartDate:t=>{const e=new Date(t);return e.setFullYear(e.getFullYear()-$[2].amount+1,0,1),e},calculateStartDate:(t,e)=>{const a=new Date(t);return a.setFullYear(a.getFullYear()+e,0,1),a},calculateEndDate:t=>{const e=new Date(t);return e.setFullYear(e.getFullYear(),12,0),e},getLabel:t=>`${t.getFullYear()}`}},K=["January","February","March","April","May","June","July","August","September","October","November","December"],je=(t,e)=>{const a=f(()=>Y(t)),u=f(()=>Y(e)),n=f(()=>{const m=new Date;return $[u.value].getStartDate(m).getTime()}),b=f(()=>{const m=n.value;return a.value.filter(i=>i.date.getTime()>=m)}),w=f(()=>{const m=D=>{const r=$[u.value].calculateStartDate(new Date(n.value),D),S=$[u.value].calculateEndDate(r);return[r.getTime(),S.getTime()]},i=(D,r)=>b.value.some(S=>S.date.getTime()>=D&&S.date.getTime()<r),v=[];let y=!1;for(let D=0;D<$[u.value].amount;D++){const[r,S]=m(D);(y||i(r,S))&&(y=!0,v.push({label:$[u.value].getLabel(new Date(r),new Date(S)),startTime:r,endTime:S}))}return v}),A=f(()=>w.value.map(m=>m.label)),c=f(()=>{const m=[];return w.value.forEach(i=>{const v=b.value.filter(y=>{const D=y.date.getTime();return D>=i.startTime&&D<i.endTime});v.length?m.push({x:i.label,y:v.reduce((y,D)=>y+D.value,0)/v.length}):m.push({x:i.label,y:null})}),m});return{headers:A,filteredData:c}},Q=t=>{const e=de(),a=he(),{isOwner:u,firebaseUser:n}=B(e),{publicUsers:b}=B(a),w=1e3*60*60*24*365.25,A=G(P.MONTHS),c=f(()=>Y(t)),m=f(()=>{var d;return(d=c.value)!=null&&d.dateOfBirth?(new Date().getTime()-new Date(c.value.dateOfBirth).getTime())/w:0}),i=f(()=>m.value*12),v=f(()=>m.value*52),y=f(()=>b.value.find(d=>{var O;return d.id===((O=c.value)==null?void 0:O.userId)})),D=f(()=>{var d,O;return((d=c.value)==null?void 0:d.userId)===((O=n.value)==null?void 0:O.uid)||u.value}),r=f(()=>{var d;return((d=c.value)==null?void 0:d.weightLog.map(O=>({date:new Date(O.date),value:O.weight})))??[]}),{headers:S,filteredData:V}=je(r,A),q=f(()=>{if(!c.value||!c.value.dateOfBirth)return null;const d=c.value.vetDate?new Date(c.value.vetDate):null;if(d)return m.value<=7?C(d,1,1):C(d,2,1);if(c.value.type==="cat")return C(new Date(c.value.dateOfBirth),52,10);if(c.value.type==="dog")return C(new Date(c.value.dateOfBirth),52,4)}),N=f(()=>{if(!c.value||!c.value.dateOfBirth)return null;const d=c.value.dewormingDate?new Date(c.value.dewormingDate):null;if(d){if(v.value<=9)return C(d,52,2);if(i.value<=3)return C(d,12,3);if(i.value<=6)return C(d,12,1);if(c.value.type==="cat")return C(d,12,c.value.insideCat?6:3);if(c.value.type==="dog")return C(d,12,3)}else return C(new Date(c.value.dateOfBirth),52,3)}),C=(d,O,F)=>new Date(d.getTime()+w/O*F);return{weightLogPeriod:A,petAgeYears:m,petAgeMonths:i,petAgeWeeks:v,petOwner:y,isMyPet:D,nextVetVisit:q,nextDeworming:N,chartHeaders:S,chartData:V}},ze=t=>{var m;const e=f(()=>Y(t)),{petAgeYears:a,petAgeMonths:u}=Q(e),n=f(()=>{var v,y;if(((v=e.value)==null?void 0:v.type)!=="cat"||!((y=e.value)!=null&&y.dateOfBirth))return null;const i=a.value;switch(!0){case i<1:return{value:"kitten",label:"Kitten (0-12 months)"};case(i>=1&&i<3):return{value:"junior",label:"Junior (1-2 years)"};case(i>=3&&i<7):return{value:"adult",label:"Adult (3-6 years)"};case(i>=7&&i<11):return{value:"mature",label:"Mature (7-10 years)"};case(i>=11&&i<15):return{value:"senior",label:"Senior (11-14 years)"};case i>=15:return{value:"geriatric",label:"Geriatric (15+ years)"};default:return null}}),b=f(()=>e.value?e.value.weightLog.length?e.value.weightLog.map(v=>({...v,date:new Date(v.date).getTime()})).sort((v,y)=>y.date-v.date)[0].weight:e.value.weight??null:null),w=f(()=>{var i,v,y;if(!((i=e.value)!=null&&i.dateOfBirth))return null;switch((v=n.value)==null?void 0:v.value){case"kitten":return u.value<=4?"kitten0.4":"kitten1";default:return(y=e.value)!=null&&y.castrated?"castrated":"default"}}),{requiredCaloriesByWeightAndAgeAndSize:A,requiredFoodDry:c}=Me("average",b.value??"",w.value??"default",((m=e.value)==null?void 0:m.gender)??"male","35","default");return{catLifeStage:n,petWeight:b,requiredCaloriesByWeightAndAgeAndSize:n?A:null,requiredFoodDry:n?c:null}},Ge=t=>{const e=f(()=>Y(t)),{petAgeYears:a}=Q(e);return{dogLifeStage:f(()=>{var b,w,A;if(((b=e.value)==null?void 0:b.type)!=="dog"||!((w=e.value)!=null&&w.dateOfBirth)||!((A=e.value)!=null&&A.breedSize))return null;const n=a.value;switch(e.value.breedSize){case"small":return n<1?{value:"puppy",label:"Puppy (0-12 months)"}:n<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:n<8?{value:"adult",label:"Adult (3-7 years)"}:n<11?{value:"mature",label:"Mature (8-10 years)"}:n<15?{value:"senior",label:"Senior (11-14 years)"}:{value:"geriatric",label:"Geriatric (15+ years)"};case"medium":return n<1?{value:"puppy",label:"Puppy (0-12 months)"}:n<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:n<7?{value:"adult",label:"Adult (3-6 years)"}:n<10?{value:"mature",label:"Mature (7-9 years)"}:n<13?{value:"senior",label:"Senior (10-12 years)"}:{value:"geriatric",label:"Geriatric (13+ years)"};case"large":return n<1?{value:"puppy",label:"Puppy (0-12 months)"}:n<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:n<6?{value:"adult",label:"Adult (3-5 years)"}:n<9?{value:"mature",label:"Mature (6-8 years)"}:n<12?{value:"senior",label:"Senior (9-11 years)"}:{value:"geriatric",label:"Geriatric (12+ years)"};case"giant":return n<1?{value:"puppy",label:"Puppy (0-12 months)"}:n<2?{value:"young_adult",label:"Young Adult (1-1.5 years)"}:n<5?{value:"adult",label:"Adult (2-4 years)"}:n<8?{value:"mature",label:"Mature (5-7 years)"}:n<10?{value:"senior",label:"Senior (8-9 years)"}:{value:"geriatric",label:"Geriatric (10+ years)"};default:return null}})}},We={class:"ms-5 max-sm:mt-3 md:ms-10 grid grid-cols-1 sm:grid-cols-[1fr_2fr] gap-1 sm:gap-3 justify-between"},qe={class:"font-bold text-nowrap"},Je={class:"text-neutral-300"},h=W({__name:"KeyValuePair",props:{title:{},value:{}},setup(t){return(e,a)=>(s(),E("div",We,[_("p",qe,Z(e.title),1),_("p",Je,Z(e.value),1)]))}}),Ue={class:"grid grid-cols-6 mb-5 gap-5"},Ke={class:"break-words text-neutral-300"},Ze={class:"flex flex-col gap-10"},Qe={key:0,class:"flex flex-wrap md:flex-nowrap gap-3 justify-around"},Xe={class:"mt-3 flex justify-center gap-3"},et={key:0,class:"w-full text-neutral-300"},tt={key:1,class:"flex gap-3"},at={key:1,class:"flex justify-center"},rt=W({__name:"Pet",setup(t){const e=be(),a=we(),u=De(),n=Se(),b=de(),{pets:w}=B(u),{routeLoading:A}=B(n),{isLoggedIn:c}=B(b),{deletePet:m}=u,i=_e("statisticsRef"),v=G(!1),y=G(!1),D=f(()=>e.params.petId),r=f(()=>w.value.find(I=>I.id===D.value)),{weightLogPeriod:S,petOwner:V,isMyPet:q,nextVetVisit:N,nextDeworming:C,chartHeaders:d,chartData:O}=Q(r),{catLifeStage:F,petWeight:X,requiredCaloriesByWeightAndAgeAndSize:ee,requiredFoodDry:te}=ze(r),{dogLifeStage:ae}=Ge(r),ve=async I=>{await m(I),a.push({name:L.PET_OVERVIEW})};return(I,o)=>(s(),g(Ee,null,{content:H(()=>[l(c)?(s(),E(j,{key:0},[_("div",Ue,[x(T,{class:"col-span-full md:col-span-4 lg:col-span-2",type:"tertiary",route:l(L).PET_OVERVIEW,loading:l(A)===l(L).PET_OVERVIEW,label:"Back to all pets",icon:"pi pi-arrow-up-left"},null,8,["route","loading"])]),r.value?(s(),g(ue,{key:0,class:"!bg-primary-500 !bg-opacity-35 my-5",title:r.value.name,"title-props":{class:"text-3xl md:text-5xl"},"title-wrapper-props":{class:"ms-5"},avatar:r.value.avatar??void 0,"avatar-props":{class:"h-20 w-20 md:h-32 md:w-32"}},{underTitle:H(()=>[_("p",Ke,Z(r.value.description),1)]),default:H(()=>{var J,re,le,ne;return[_("div",Ze,[_("div",null,[o[9]||(o[9]=_("h3",null,"Details",-1)),l(V)?(s(),g(h,{key:0,title:"Owner:",value:l(V).displayName},null,8,["value"])):p("",!0),r.value.dateOfBirth?(s(),g(h,{key:1,title:"Date of birth:",value:l(z)(r.value.dateOfBirth)},null,8,["value"])):p("",!0),r.value.type?(s(),g(h,{key:2,title:"Type:",value:((J=l(Ce).find(({value:k})=>{var M;return k===((M=r.value)==null?void 0:M.type)}))==null?void 0:J.label)??""},null,8,["value"])):p("",!0),r.value.breed?(s(),g(h,{key:3,title:"Breed:",value:r.value.breed},null,8,["value"])):p("",!0),r.value.breedSize&&r.value.type==="dog"?(s(),g(h,{key:4,title:"Breed size:",value:((re=l(ke).find(({value:k})=>{var M;return k===((M=r.value)==null?void 0:M.breedSize)}))==null?void 0:re.label)??""},null,8,["value"])):p("",!0),r.value.gender?(s(),g(h,{key:5,title:"Gender:",value:((le=l(Oe).find(({value:k})=>{var M;return k===((M=r.value)==null?void 0:M.gender)}))==null?void 0:le.label)??""},null,8,["value"])):p("",!0),o[10]||(o[10]=_("h3",null,"Health",-1)),l(X)?(s(),g(h,{key:6,title:"Weight:",value:l(X)+"kg"},null,8,["value"])):p("",!0),typeof r.value.insideCat=="boolean"?(s(),g(h,{key:7,title:"Inside Cat:",value:r.value.insideCat?"Yes":"No"},null,8,["value"])):p("",!0),r.value.castrated!==void 0?(s(),g(h,{key:8,title:"Castrated:",value:r.value.castrated?"Yes":"No"},null,8,["value"])):p("",!0),r.value.vetDate?(s(),g(h,{key:9,title:"Last vet visit:",value:l(z)(r.value.vetDate)},null,8,["value"])):p("",!0),r.value.lastVaccinationDate?(s(),g(h,{key:10,title:"Last vaccination:",value:l(z)(r.value.lastVaccinationDate)},null,8,["value"])):p("",!0),r.value.dewormingDate?(s(),g(h,{key:11,title:"Last deworming:",value:l(z)(r.value.dewormingDate)},null,8,["value"])):p("",!0)]),r.value.dateOfBirth?(s(),E("div",Qe,[x(Ae,{class:"w-full md:w-3/4 text-neutral-300 bg-neutral-900 rounded-secondary",time:new Date(r.value.dateOfBirth).getTime(),direction:"up"},null,8,["time"])])):p("",!0),_("div",null,[o[11]||(o[11]=_("h3",null,"Statistics",-1)),_("div",{ref_key:"statisticsRef",ref:i},[r.value.type==="cat"?(s(),E(j,{key:0},[l(F)?(s(),g(h,{key:0,title:"Life stage:",value:l(F).label},null,8,["value"])):p("",!0),l(ee)?(s(),g(h,{key:1,title:"Required energy per day:",value:l(ee).toFixed(1)+" kcal"},null,8,["value"])):p("",!0),l(te)?(s(),g(h,{key:2,title:"Required dry food per day:",value:l(te).toFixed(1)+" g"},null,8,["value"])):p("",!0)],64)):r.value.type==="dog"?(s(),E(j,{key:1},[l(ae)?(s(),g(h,{key:0,title:"Life stage:",value:l(ae).label},null,8,["value"])):p("",!0)],64)):p("",!0),l(N)?(s(),g(h,{key:2,title:"Next vet visit:",value:l(U)(l(N))},null,8,["value"])):p("",!0),r.value.nextVaccinationDate?(s(),g(h,{key:3,title:"Next vaccination:",value:l(U)(new Date(r.value.nextVaccinationDate))},null,8,["value"])):p("",!0),l(C)?(s(),g(h,{key:4,title:"Next deworming:",value:l(U)(l(C))},null,8,["value"])):p("",!0),r.value.weightLog.length?(s(),E(j,{key:5},[_("div",Xe,[x(T,{type:"neutral",label:"1 Year",outlined:l(S)===l(P).MONTHS,onClick:o[0]||(o[0]=k=>S.value=l(P).MONTHS)},null,8,["outlined"]),x(T,{type:"neutral",label:"3 Years",outlined:l(S)===l(P).YEARS_HALF,onClick:o[1]||(o[1]=k=>S.value=l(P).YEARS_HALF)},null,8,["outlined"]),x(T,{type:"neutral",label:"10 Years",outlined:l(S)===l(P).YEARS,onClick:o[2]||(o[2]=k=>S.value=l(P).YEARS)},null,8,["outlined"])]),x(He,{headers:l(d),datasets:[{label:`${r.value.name}'s weight (kg)`,fill:!1,borderColor:"red",yAxisID:"y",tension:.4,data:l(O),spanGaps:!0}]},null,8,["headers","datasets"])],64)):p("",!0)],512),(ne=l(i))!=null&&ne.childElementCount?p("",!0):(s(),E("p",et," Nothing to show yet. "))]),l(q)?(s(),E("div",tt,[x(T,{label:"Edit",outlined:"",onClick:o[3]||(o[3]=k=>v.value=!0)}),x(T,{label:"Delete",type:"danger",outlined:"",onClick:o[4]||(o[4]=k=>y.value=!0)})])):p("",!0),x(Pe,{"is-open":v.value,"original-pet":r.value??null,onClose:o[5]||(o[5]=k=>v.value=!1)},null,8,["is-open","original-pet"]),x(xe,{"is-open":y.value,title:"Delete Pet",description:"Are you sure you want to delete your pet?","confirm-text":"Confirm","confirm-props":{type:"danger",outlined:!0},onConfirm:o[6]||(o[6]=k=>ve(r.value.id)),onCancel:o[7]||(o[7]=k=>y.value=!1)},null,8,["is-open"])])]}),_:1},8,["title","avatar"])):p("",!0)],64)):(s(),E("div",at,[x(ue,{class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:H(()=>[o[12]||(o[12]=ie(" Please ")),_("a",{class:"cursor-pointer",onClick:o[8]||(o[8]=J=>l(a).push({name:l(L).LOGIN,params:{redirect:JSON.stringify({name:l(L).PET_DETAILS,params:{petId:D.value}})}}))}," Login "),o[13]||(o[13]=ie(" to view this pet. "))]),_:1})]))]),_:1}))}}),lt=$e(rt,[["__scopeId","data-v-e357a264"]]),wt=W({__name:"Pet",setup(t){return(e,a)=>(s(),g(lt))}});export{wt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
