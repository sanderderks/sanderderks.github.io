import{_ as N}from"./c-Bubble.vue_vue_type_script_setup_true_lang-iHAaGDxw.js";import{e as V,A,aG as B,s as y,r as D,c as p,o as C,as as L,M as T,l as n,m as l,p as t,t as u,w as g,O as $,H as r,G as w,k as x,C as M,n as R,h as j}from"../bundle.js";import{_ as E}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"w-full overflow-x-auto"},O={class:"w-full mt-5 text-sm md:text-base text-left text-nowrap"},q={key:0},z={key:0},J={key:1},K={key:1},Q={key:0},W={key:1},X={key:2},Y={key:3},Z={key:2},ee={key:3},te={class:"mt-5 flex justify-center"},se=V({__name:"Highscores",props:{gameId:{},unit:{}},setup(c){const h=c,_=A(),d=B(h.gameId)(),{publicUsers:k}=y(_),{allGameData:f,fetchLoading:v}=y(d),{fetchGameData:i,fetchHighscores:b,fetchScores:S}=d,s=D("highscores"),H=D(),a=p(()=>f.value[h.gameId].gameData[s.value]),P=m=>{var o;return((o=k.value.find(e=>e.id===m))==null?void 0:o.displayName)??"Unknown"},U=()=>{s.value==="highscores"?b():S()};return C(()=>{i(),H.value=setInterval(()=>{i()},1e3*60*5)}),L(()=>{clearInterval(H.value)}),T(s,()=>{f.value[h.gameId].gameData[s.value].length||U()}),(m,o)=>(n(),l(g,null,[t("div",F,[t("table",O,[a.value.length?(n(),l("thead",q,[t("tr",null,[o[1]||(o[1]=t("th",null,"Rank",-1)),o[2]||(o[2]=t("th",null,"User",-1)),o[3]||(o[3]=t("th",null,"Score",-1)),a.value.length&&a.value.some(e=>e.difficulty)?(n(),l("th",z,"Difficulty")):u("",!0),o[4]||(o[4]=t("th",null,"Date",-1)),a.value.length&&a.value.some(e=>e.bonus)?(n(),l("th",J,"Bonus")):u("",!0)])])):u("",!0),a.value.length?(n(),l("tbody",K,[(n(!0),l(g,null,$(a.value,(e,G)=>(n(),l("tr",null,[t("th",null,r(G+1),1),t("th",null,r(P(e.userId??e.id)),1),t("td",null,[w(r(e.score)+" ",1),m.unit?(n(),l(g,{key:0},[w(r(m.unit),1),e.score!==1?(n(),l(g,{key:0},[w("s")],64)):u("",!0)],64)):u("",!0)]),e.difficulty?(n(),l("td",Q,r(e.difficulty),1)):a.value.some(I=>I.difficulty)?(n(),l("td",W)):u("",!0),t("td",null,r(x(M)(e.date)),1),e.bonus?(n(),l("td",X,r(e.bonus),1)):a.value.some(I=>I.bonus)?(n(),l("td",Y)):u("",!0)]))),256))])):x(v)?(n(),l("tbody",Z,o[5]||(o[5]=[t("tr",null,[t("th",null,"Loading highscores...")],-1)]))):(n(),l("tbody",ee,[t("tr",null,[t("th",null,"There are no "+r(s.value==="highscores"?"highscores":"scores")+" yet.",1)])]))])]),t("div",te,[R(N,{class:"w-full md:w-1/2",label:`View ${s.value==="highscores"?"All Scores":"Highscores"}`,type:"secondary",onClick:o[0]||(o[0]=e=>s.value==="highscores"?s.value="scores":s.value="highscores")},null,8,["label"])])],64))}}),ae=E(se,[["__scopeId","data-v-a8e07785"]]),re=c=>{const h=j(),_=B(c)(),{allGameData:d,highscorePosition:k,personalBest:f}=y(_),{firebaseUser:v}=y(h),i=p(()=>v.value?k.value:null),b=p(()=>{const s=d.value[c].previousHighscorePosition;return i.value&&s?s>i.value:!1}),S=p(()=>{const s=d.value[c].previousPersonalBest;return v.value&&s?s<f.value:!1});return{currentHighscorePosition:i,hasImprovedHighscorePosition:b,hasImprovedPersonalBest:S}};export{ae as H,re as u};
