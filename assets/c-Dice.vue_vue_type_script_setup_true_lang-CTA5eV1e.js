import{a$ as xe,bo as Pe,c as Ve,b0 as Ye,aR as Be,s as D,bp as Ue,bq as ee,aS as le,w as h,aQ as p,a9 as ze,f,o as We,L as x,br as Me,bm as Ze,b1 as w,bs as qe,b4 as te,aq as je,b2 as Xe,d as T,g as N,j as g,q as n,l as ye,aW as Qe,h as P,z as Je}from"../bundle.js";import{_ as Ke}from"./c-Dice6.vue_vue_type_script_setup_true_lang-CbzU1YFL.js";var el=(l=>(l[l.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",l[l.FINDING_OPPONENT=1]="FINDING_OPPONENT",l[l.HAS_STARTED=2]="HAS_STARTED",l[l.HAS_THROWN_DICES=3]="HAS_THROWN_DICES",l[l.HAS_CHOSEN_DICES=4]="HAS_CHOSEN_DICES",l[l.HAS_FINISHED=5]="HAS_FINISHED",l))(el||{}),ll=(l=>(l[l.ONES=0]="ONES",l[l.TWOS=1]="TWOS",l[l.THREES=2]="THREES",l[l.FOURS=3]="FOURS",l[l.FIVES=4]="FIVES",l[l.SIXES=5]="SIXES",l[l.THREE_OF_A_KIND=6]="THREE_OF_A_KIND",l[l.FOUR_OF_A_KIND=7]="FOUR_OF_A_KIND",l[l.FULL_HOUSE=8]="FULL_HOUSE",l[l.SMALL_STRAIGHT=9]="SMALL_STRAIGHT",l[l.LARGE_STRAIGHT=10]="LARGE_STRAIGHT",l[l.YAHTZEE=11]="YAHTZEE",l[l.CHANCE=12]="CHANCE",l))(ll||{}),ie=(l=>(l[l.PLAYER=0]="PLAYER",l[l.OPPONENT=1]="OPPONENT",l))(ie||{});const se=()=>({0:[],1:[]}),tl=xe("yahtzeeStore",()=>{const l=Pe(),o=Ve(),r=Ye(),H=Be(),{personalBest:G,highscorePosition:O}=D(r),{firebaseUser:d}=D(o),{onlineGames:V,onlineGamesLoading:ne,onlineGameId:Y,onlineGameCreatorId:B,onlineGameOpponentId:I,onlineGameOpponentActive:U,onlineGameChat:z,isOnlineGameOwner:W,onlineGameOpponentName:ae}=D(H),{fetchOnlineGames:re,startOnlineGame:ce,continueOnlineGame:ue,createOnlineGame:fe,watchOnlineGame:ve,updateOnlineGame:he,leaveOnlineGame:_e,deleteOnlineGame:de}=H,{setPreviousHighscores:M,updateHighscores:me,sortHighscores:pe}=r,ge={onlineGames:Ue(l,ee.GAME_DATA,le.YAHTZEE,ee.ONLINE_GAMES)},m=h(p.SOLO),u=h(0),b=h(!1),_=h(0),E=h(null),k=h(null),A=h(0),Z=h(0),v=h(-1),a=h(oe()),c=ze(se()),C=f(()=>a.value.some(e=>e.isRolling)),Oe=f(()=>v.value===-1&&!a.value.every(e=>e.selected)),Ee=f(()=>v.value>=0&&v.value<2&&!a.value.every(e=>e.selected)),Ae=f(()=>e=>a.value.filter(t=>t.value===e).length),Se=f(()=>J(3)),Te=f(()=>J(4)),Ne=f(()=>F(2)&&F(3)?S[8].trueValue??!1:!1),be=f(()=>K(4)?S[9].trueValue??!1:!1),He=f(()=>K(5)?S[10].trueValue??!1:!1),q=f(()=>F(5)?S[11].trueValue??!1:!1),Ie=f(()=>{let e=0;return a.value.forEach(t=>{e+=t.value}),e}),L=f(()=>(e,t=0)=>{let s=0;return c[t].filter(i=>S[i.row].section===e).forEach(i=>{i.value!==!1&&(s+=i.value)}),s});We(()=>{r.$init(le.YAHTZEE)}),x(c,e=>{e[0].length===13&&(m.value===p.SOLO||e[1].length===13)&&(u.value=5)},{deep:!0}),x(u,e=>{if(e===5){const t=s=>{let i=L.value("top",s);i>=63&&(s===0?A.value+=35:Z.value+=35),i+=L.value("bottom",s),i+=A.value,s===0?E.value=i:k.value=i};t(0),m.value===p.ONLINE?(t(1),(E.value??0)>(k.value??0)&&R()):R(),w(Xe)}}),x([u,_,C],()=>{m.value===p.ONLINE&&j()},{deep:!0});const $=()=>{Y.value=null,B.value=null,I.value=null,U.value=null,z.value=null,m.value=p.SOLO,u.value=0,b.value=!1,_.value=0,E.value=null,A.value=0,v.value=-1,a.value=oe(),Object.assign(c,se()),M()},Ce=e=>{d.value&&(m.value=p.ONLINE,u.value=2,ce(e,X(d.value.uid,e),y,$))},we=e=>{m.value=p.ONLINE,ue(e,y,$)},j=()=>{!d.value||!I.value||_.value===1&&!b.value||he(X(d.value.uid,I.value))},X=(e,t)=>({gameStatus:u.value,activePlayer:_.value===0?e:t,dices:a.value,score:{[e]:c[0],[t]:c[1]}}),y=(e,t)=>{var i;const s=(i=d.value)==null?void 0:i.uid;!s||_.value===0&&!t||(u.value=e.gameStatus,_.value=e.activePlayer===s?0:1,a.value=e.dices,W.value?(c[0]=e.score[e.creatorId],c[1]=e.score[e.opponentId]):(c[0]=e.score[e.opponentId],c[1]=e.score[e.creatorId]))},Q=async()=>{for(;C.value;)await new Promise(e=>setTimeout(e,r.diceRollSpeed*1e3));return!0},J=e=>{for(let t=1;t<=6;t++)if(a.value.filter(s=>s.value===t).length>=e){let s=0;return a.value.forEach(i=>{s+=i.value}),s}return!1},F=e=>{for(let t=1;t<=6;t++)if(a.value.filter(s=>s.value===t).length===e)return!0;return!1},K=e=>{let t=0,s=e;do{e:for(let i=s-e+1;i<=s;i++)if(a.value.some(Re=>Re.value===i))t++;else break e;if(t===e)return!0;t=0,s++}while(s<=6);return!1},De=()=>{u.value=2},Ge=async()=>{const e=r.diceRollSpeed*1e3;v.value++,a.value.forEach(t=>{t.selected||(t.isRolling=!0,setTimeout(()=>{t.value=Me(6),t.isRolling=!1,v.value===2&&(t.selected=!0),a.value.sort((s,i)=>s.value-i.value)},Ze(e,e/3)))}),await Q(),u.value=3,w(qe)},ke=(e,t=0)=>c[t].find(s=>s.row===e),Le=(e,t)=>{let s=t;if(s===!1)return!1;const i=S[e];return i.multiplier?s*=i.multiplier:i.trueValue&&(s=i.trueValue),s},$e=e=>{_.value===0&&v.value>=0&&v.value<2&&(e.selected=!e.selected,w(te))},Fe=(e,t)=>{if(!C.value){if(t!==!1&&q.value){const s=c[0].find(i=>i.row===11);s&&s.value!==!1&&(A.value+=100)}c[0].push({row:e,value:t}),v.value=-1,a.value.forEach(s=>{s.selected=!1}),w(te),m.value===p.ONLINE&&(b.value=!0,u.value=4,setTimeout(async()=>{u.value=2,_.value=1,await je(),b.value=!1},r.diceRollSpeed*1e3))}},R=()=>{E.value&&me({score:E.value,bonus:A.value})};return{collections:ge,onlineGames:V,onlineGamesLoading:ne,onlineGameId:Y,onlineGameCreatorId:B,onlineGameOpponentId:I,onlineGameOpponentActive:U,onlineGameChat:z,isOnlineGameOwner:W,onlineGameOpponentName:ae,gameType:m,gameStatus:u,gameStatusLoading:b,activePlayer:_,score:c,finalScore:E,finalScoreOpponent:k,bonus:A,bonusOpponent:Z,reroll:v,dices:a,isRolling:C,canRoll:Oe,canReroll:Ee,hasOfValue:Ae,hasThreeOfAKind:Se,hasFourOfAKind:Te,hasFullHouse:Ne,hasSmallStraight:be,hasLargeStraight:He,hasYahtzee:q,diceTotal:Ie,scoreTotalOf:L,personalBest:G,highscorePosition:O,$reset:$,start:De,roll:Ge,hasFinishedRolling:Q,getScore:ke,getActualValue:Le,selectDice:$e,selectScore:Fe,setPreviousHighscores:M,updateYahtzeeHighscore:R,sortHighscores:pe,fetchOnlineGames:re,startOnlineGame:Ce,continueOnlineGame:we,createOnlineGame:fe,watchOnlineGame:ve,updateOnlineGame:j,leaveOnlineGame:_e,deleteOnlineGame:de}},{persist:{enabled:!0}}),oe=()=>[{id:1,value:1,selected:!1,isRolling:!1},{id:2,value:2,selected:!1,isRolling:!1},{id:3,value:3,selected:!1,isRolling:!1},{id:4,value:4,selected:!1,isRolling:!1},{id:5,value:5,selected:!1,isRolling:!1}],S={0:{title:"Ones",section:"top"},1:{title:"Twos",section:"top",multiplier:2},2:{title:"Threes",section:"top",multiplier:3},3:{title:"Fours",section:"top",multiplier:4},4:{title:"Fives",section:"top",multiplier:5},5:{title:"Sixes",section:"top",multiplier:6},6:{title:"Three of a Kind",section:"bottom"},7:{title:"Four of a Kind",section:"bottom"},8:{title:"Full House",section:"bottom",trueValue:25},9:{title:"Small Straight",section:"bottom",trueValue:30},10:{title:"Large Straight",section:"bottom",trueValue:40},11:{title:"Yahtzee",section:"bottom",trueValue:50},12:{title:"Chance",section:"bottom"}},sl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},ol=["fill"],il=["fill"],nl=T({__name:"Dice1",props:{color:{},backgroundColor:{}},setup(l){return(o,r)=>(g(),N("svg",sl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:o.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,ol),n("circle",{cx:"50",cy:"50",r:"10",fill:o.color},null,8,il)]))}}),al={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},rl=["fill"],cl=["fill"],ul=["fill"],fl=T({__name:"Dice2",props:{color:{},backgroundColor:{}},setup(l){return(o,r)=>(g(),N("svg",al,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:o.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,rl),n("circle",{cx:"25",cy:"25",r:"10",fill:o.color},null,8,cl),n("circle",{cx:"75",cy:"75",r:"10",fill:o.color},null,8,ul)]))}}),vl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},hl=["fill"],_l=["fill"],dl=["fill"],ml=["fill"],pl=T({__name:"Dice3",props:{color:{},backgroundColor:{}},setup(l){return(o,r)=>(g(),N("svg",vl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:o.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,hl),n("circle",{cx:"25",cy:"25",r:"10",fill:o.color},null,8,_l),n("circle",{cx:"50",cy:"50",r:"10",fill:o.color},null,8,dl),n("circle",{cx:"75",cy:"75",r:"10",fill:o.color},null,8,ml)]))}}),gl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Ol=["fill"],El=["fill"],Al=["fill"],Sl=["fill"],Tl=["fill"],Nl=T({__name:"Dice4",props:{color:{},backgroundColor:{}},setup(l){return(o,r)=>(g(),N("svg",gl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:o.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Ol),n("circle",{cx:"25",cy:"25",r:"10",fill:o.color},null,8,El),n("circle",{cx:"25",cy:"75",r:"10",fill:o.color},null,8,Al),n("circle",{cx:"75",cy:"25",r:"10",fill:o.color},null,8,Sl),n("circle",{cx:"75",cy:"75",r:"10",fill:o.color},null,8,Tl)]))}}),bl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Hl=["fill"],Il=["fill"],Cl=["fill"],wl=["fill"],Dl=["fill"],Gl=["fill"],kl=T({__name:"Dice5",props:{color:{},backgroundColor:{}},setup(l){return(o,r)=>(g(),N("svg",bl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:o.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Hl),n("circle",{cx:"25",cy:"25",r:"10",fill:o.color},null,8,Il),n("circle",{cx:"25",cy:"75",r:"10",fill:o.color},null,8,Cl),n("circle",{cx:"50",cy:"50",r:"10",fill:o.color},null,8,wl),n("circle",{cx:"75",cy:"25",r:"10",fill:o.color},null,8,Dl),n("circle",{cx:"75",cy:"75",r:"10",fill:o.color},null,8,Gl)]))}}),Fl=T({__name:"Dice",props:{dice:{}},setup(l){const o=tl(),{activePlayer:r}=D(o),{selectDice:H}=o,G={1:nl,2:fl,3:pl,4:Nl,5:kl,6:Ke};return(O,d)=>(g(),N("div",{class:Je(["cursor-pointer",{"animate-spin":O.dice.isRolling}])},[(g(),ye(Qe(G[O.dice.value]),{color:"black",backgroundColor:O.dice.selected?P(r)===P(ie).PLAYER?"#2563eb":"#e11d48":"white",width:"40",height:"40",onClick:d[0]||(d[0]=V=>P(H)(O.dice))},null,8,["backgroundColor"]))],2))}});export{el as G,ie as P,ll as S,Fl as _,S as s,tl as u};
