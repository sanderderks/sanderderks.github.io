import{d as le,aQ as me,v as Se,c as ve,s as z,w as Z,f as O,o as ce,g as a,j as l,k as m,l as S,m as u,h as e,C as A,A as _,q as d,P as _e,_ as N,y as oe,L as we,I as y,a3 as k,aR as E,E as Y,aS as ue,ax as fe,z as q,a as Ie,a7 as Ne,R as ke}from"../bundle.js";import{u as ie,s as Oe,G as r,S as P,_ as ge}from"./c-Dice.vue_vue_type_script_setup_true_lang-DP91JKHR.js";import{_ as de,a as Ee}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-BoxH_naQ.js";import{_ as Ae}from"./c-GameChat.vue_vue_type_script_setup_true_lang-BHc_8rRc.js";import{_ as He}from"./c-GameSettingsDialog.vue_vue_type_script_setup_true_lang-B7V19gF1.js";import{u as Te,H as he}from"./c-useScoreInfo-BCYDvVMj.js";import{_ as ye}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import"./c-Dice5.vue_vue_type_script_setup_true_lang-DK-8hWiG.js";import"./c-Dice6.vue_vue_type_script_setup_true_lang-CbzU1YFL.js";import"./c-Dialog.vue_vue_type_script_setup_true_lang-CWtsg3qw.js";const be={class:"w-full flex flex-col gap-3 items-center md:items-start"},xe=le({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(Q,{emit:R}){const G=R,T=me(),v=Se(),$=ve(),{onlineGames:F,onlineGamesLoading:w}=z(T),{onlineUsers:W}=z(v),{firebaseUser:D}=z($),{getPlayerDisplayName:I}=T,n=Z(""),b=O(()=>{var i;return(i=D.value)==null?void 0:i.uid}),V=O(()=>F.value.filter(i=>i.players.find(o=>o.userId===b.value))),L=O(()=>V.value.filter(i=>!i.maxPlayers)),c=O(()=>F.value.filter(i=>(i.maxPlayers??0)>2)),B=i=>{const o=c.value.find(s=>s.id===i);return(o==null?void 0:o.players.find(s=>s.userId===b.value))!==void 0},h=i=>{const o=c.value.find(s=>s.id===i);return o&&o.maxPlayers&&o.players.length<o.maxPlayers||!1},j=i=>{const o=L.value.find(s=>s.players.some(f=>f.userId===i));o?G("continueOnlineGame",o.id):G("createOnlineGame",i)},H=()=>{G("createParty",n.value??null,3)},J=i=>{G("joinParty",i)};return ce(async()=>{await T.fetchOnlineGames()}),(i,o)=>(l(),a(A,null,[m(de,{class:"flex-col items-center md:items-start !gap-3 !pb-5 md:!ps-5 border border-white",title:"Choose 1v1 opponent",listOfUsers:e(W).filter(s=>s.id!==b.value),"custom-click-action":"","get-color":s=>{var f;return e(w)||s===((f=e(D))==null?void 0:f.uid)?"bg-neutral-500":"bg-green-500"},isClickable:s=>{var f;return!e(w)&&s!==((f=e(D))==null?void 0:f.uid)},onClick:o[0]||(o[0]=s=>j(s))},null,8,["listOfUsers","get-color","isClickable"]),L.value.length?(l(),S(de,{key:0,class:"flex-col items-center md:items-start !gap-3 !pb-5 md:!ps-5 border border-white",title:"Active 1v1s",listOfUsers:L.value.flatMap(s=>s.players.filter(f=>{var X;return f.userId!==((X=e(D))==null?void 0:X.uid)}).map(f=>({id:f.userId}))),"custom-click-action":"","get-color":()=>e(w)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!e(w),onClick:o[1]||(o[1]=s=>j(s))},null,8,["listOfUsers","get-color","isClickable"])):u("",!0),i.allowParty?(l(),a(A,{key:1},[m(oe,{class:"w-full min-h-[52px] my-5 flex flex-col flex-wrap gap-5 items-center md:items-start !px-1 md:!ps-5 !py-2 !pb-5 !rounded-primary border border-white"},{default:_(()=>[o[4]||(o[4]=d("p",{class:"mt-1"},"Create party: ",-1)),d("div",be,[m(_e,{class:"w-2/3 sm:w-1/2","input-props":{class:"!bg-neutral-700 !text-blue-200 !font-bold"},name:"partyName",modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=s=>n.value=s),type:"text",placeholder:"My Party Name"},null,8,["modelValue"]),m(N,{class:"w-2/3 sm:w-1/2",label:"Create",variant:"green",onClick:H})])]),_:1,__:[4]}),c.value.length?(l(),S(Ee,{key:0,class:"flex-col items-center md:items-start !gap-3 !pb-5 md:!ps-5 border border-white",title:"Join party",list:c.value.map(s=>({id:s.id,label:s.partyName??s.players.map(f=>e(I)(f.userId)).join(", ")})),"custom-click-action":"","get-color":s=>e(w)?"bg-neutral-500":B(s)?"bg-purple-500 bg-opacity-50":h(s)?"bg-yellow-500 bg-opacity-50":"bg-red-500 bg-opacity-50",isClickable:s=>!e(w)&&(B(s)||h(s)),onClick:o[3]||(o[3]=s=>J(s))},null,8,["list","get-color","isClickable"])):u("",!0)],64)):u("",!0)],64))}}),Pe={class:"h-10"},Ce={class:"w-1/2 md:w-1/3"},Ge={key:0},De={key:1,class:"!ps-1 md:ps-1"},Re={key:2},$e={key:0},Fe={key:1},Le={key:2},Be=le({__name:"ScoreCell",props:{row:{},hasValue:{type:[Number,Boolean]}},setup(Q){const R=Q,G=ie(),{gameType:T,gameStatus:v,activePlayerId:$,myPlayerId:F,onlineGameOpponents:w,reroll:W}=z(G),{selectScore:D,getScore:I,getActualValue:n}=G,b=Z(!1),V=Oe[R.row],L=O(()=>I(R.row,F.value)),c=O(()=>n(R.row,R.hasValue)),B=O(()=>c.value===!1?"X":c.value);return we(()=>c.value,()=>{b.value=!0,setTimeout(()=>{b.value=!1})}),(h,j)=>(l(),a("tr",Pe,[d("th",Ce,y(e(V).title),1),L.value?(l(),a("td",Ge,y(L.value.value===!1?"X":L.value.value),1)):e($)===e(F)&&e(W)>=0&&!b.value?(l(),a("td",De,[m(N,{class:"size-8",variant:c.value===!1||c.value===0?"neutral":void 0,onClick:j[0]||(j[0]=H=>e(D)(h.row,c.value))},{default:_(()=>[k(y(B.value),1)]),_:1},8,["variant"])])):(l(),a("td",Re)),e(T)===e(E).ONLINE?(l(!0),a(A,{key:3},Y(e(w),H=>(l(),a(A,null,[e(I)(h.row,H.userId)?(l(),a("td",$e,y(e(I)(h.row,H.userId).value===!1?"X":e(I)(h.row,H.userId).value),1)):e($)===H.userId&&e(v)>e(r).HAS_STARTED?(l(),a("td",Fe,[m(N,{class:"size-8",variant:c.value===!1||c.value===0?"neutral":"danger"},{default:_(()=>[k(y(B.value),1)]),_:1},8,["variant"])])):(l(),a("td",Le))],64))),256)):u("",!0)]))}}),C=ye(Be,[["__scopeId","data-v-3b0f70c2"]]),Ue={key:0,class:"text-white"},Ve={key:3,class:"h-12 md:h-auto text-red-500"},je={class:"h-12 md:h-auto text-pink-500"},Ye={key:0,class:"text-purple-500 font-bold"},We={key:1,class:"text-red-500 font-bold"},ze={key:2,class:"text-green-500 font-bold"},Me={key:0,class:"h-12 md:h-auto text-red-500 font-bold"},Xe=le({__name:"Scoreboard",setup(Q){const R=ie(),G=me(),{gameType:T,gameStatus:v,myPlayerId:$,bonus:F,hasOfValue:w,hasThreeOfAKind:W,hasFourOfAKind:D,hasFullHouse:I,hasSmallStraight:n,hasLargeStraight:b,hasYahtzee:V,diceTotal:L,scoreTotalOf:c,score:B,finalScore:h}=z(R),{onlineGamePlayers:j,onlineGameOpponents:H}=z(G),{currentHighscorePosition:J,hasImprovedHighscorePosition:i,hasImprovedPersonalBest:o}=Te(ue.YAHTZEE),s=Z(),f=Z(!1),X=O(()=>w.value(1)),ae=O(()=>w.value(2)),se=O(()=>w.value(3)),re=O(()=>w.value(4)),K=O(()=>w.value(5)),x=O(()=>w.value(6)),M=O(()=>c.value("top")),ne=O(()=>c.value("bottom")),ee=O(()=>j.value.map(U=>h.value[U.userId]===Math.max(...Object.values(h.value))?{...U,isWinner:!0}:{player:U,isWinner:!1})),te=O(()=>ee.value.filter(U=>U.isWinner).length>1);return ce(()=>{s.value=setInterval(()=>{f.value=!f.value},500)}),fe(()=>{clearInterval(s.value)}),(U,g)=>(l(),a("table",{class:q(["w-full mt-5 text-sm md:text-base text-left",e(v)===e(r).HAS_FINISHED?"text-neutral-500":"text-white",e(v)===e(r).HAS_NOT_STARTED?f.value?"even":"odd":void 0])},[e(T)===e(E).ONLINE?(l(),a("thead",Ue,[d("tr",null,[g[0]||(g[0]=d("th",null,null,-1)),g[1]||(g[1]=d("th",null,"You",-1)),(l(!0),a(A,null,Y(e(H),t=>(l(),a("th",{key:t.userId,class:q(t.isOnline?"text-green-400":"text-red-400")},y(e(R).getPlayerDisplayName(t.userId)),3))),128))])])):u("",!0),d("tbody",null,[m(C,{row:e(P).ONES,"has-value":X.value},null,8,["row","has-value"]),m(C,{row:e(P).TWOS,"has-value":ae.value},null,8,["row","has-value"]),m(C,{row:e(P).THREES,"has-value":se.value},null,8,["row","has-value"]),m(C,{row:e(P).FOURS,"has-value":re.value},null,8,["row","has-value"]),m(C,{row:e(P).FIVES,"has-value":K.value},null,8,["row","has-value"]),m(C,{row:e(P).SIXES,"has-value":x.value},null,8,["row","has-value"]),e(v)>=e(r).HAS_FINISHED?(l(),a("tr",{key:0,class:q(["h-12 md:h-auto",e(v)===e(r).HAS_FINISHED?"text-white":"text-neutral-500"])},[g[2]||(g[2]=d("th",null,"TOP",-1)),d("td",null,y(e(v)>=e(r).HAS_STARTED?M.value:""),1),e(T)===e(E).ONLINE?(l(!0),a(A,{key:0},Y(e(H),t=>(l(),a("td",null,y(e(v)>=e(r).HAS_STARTED?e(c)("top",t.userId):""),1))),256)):u("",!0)],2)):u("",!0),e(v)>e(r).HAS_NOT_STARTED&&Object.keys(e(B)).some(t=>e(c)("top",t)>=63)?(l(),a("tr",{key:1,class:q(["h-12 md:h-auto",e(v)===e(r).HAS_FINISHED?M.value>=63?"text-yellow-500":"text-white":"text-neutral-500"])},[g[3]||(g[3]=d("th",null,"BONUS",-1)),d("td",null,y(M.value>=63?35:e(v)===e(r).HAS_FINISHED?"X":""),1),e(T)===e(E).ONLINE?(l(!0),a(A,{key:0},Y(e(H),t=>(l(),a("td",null,y(e(c)("top",t.userId)>=63?35:e(v)===e(r).HAS_FINISHED?"X":""),1))),256)):u("",!0)],2)):u("",!0),m(C,{row:e(P).THREE_OF_A_KIND,"has-value":e(W)},null,8,["row","has-value"]),m(C,{row:e(P).FOUR_OF_A_KIND,"has-value":e(D)},null,8,["row","has-value"]),m(C,{row:e(P).FULL_HOUSE,"has-value":e(I)},null,8,["row","has-value"]),m(C,{row:e(P).SMALL_STRAIGHT,"has-value":e(n)},null,8,["row","has-value"]),m(C,{row:e(P).LARGE_STRAIGHT,"has-value":e(b)},null,8,["row","has-value"]),m(C,{row:e(P).YAHTZEE,"has-value":e(V)},null,8,["row","has-value"]),m(C,{row:e(P).CHANCE,"has-value":e(L)},null,8,["row","has-value"]),e(v)>=e(r).HAS_FINISHED?(l(),a("tr",{key:2,class:q(["h-12 md:h-auto",e(v)===e(r).HAS_FINISHED?"text-white":"text-neutral-500"])},[g[4]||(g[4]=d("th",null,"BOTTOM",-1)),d("td",null,y(e(v)>=e(r).HAS_STARTED?ne.value:""),1),e(T)===e(E).ONLINE?(l(!0),a(A,{key:0},Y(e(H),t=>(l(),a("td",null,y(e(v)>=e(r).HAS_STARTED?e(c)("bottom",t.userId):""),1))),256)):u("",!0)],2)):u("",!0),Object.values(e(F)).some(t=>t>=100)?(l(),a("tr",Ve,[g[5]||(g[5]=d("th",null,"YAHTZEE BONUS",-1)),d("td",null,y(e(F)[e($)]),1),e(T)===e(E).ONLINE?(l(!0),a(A,{key:0},Y(e(H),t=>(l(),a("td",null,y(e(F)[t.userId]),1))),256)):u("",!0)])):u("",!0),e(v)===e(r).HAS_FINISHED?(l(),a(A,{key:4},[d("tr",je,[g[6]||(g[6]=d("th",null,"TOTAL",-1)),d("td",null,[k(y(e(h)[e($)])+" ",1),e(i)&&e(J)===1?(l(),a("span",Ye," HIGHSCORE! ")):e(i)?(l(),a("span",We," LEADERBOARD IMPROVEMENT! ")):e(o)?(l(),a("span",ze," PERSONAL BEST! ")):u("",!0)]),e(T)===e(E).ONLINE?(l(!0),a(A,{key:0},Y(e(H),t=>(l(),a("td",null,y(e(h)[t.userId]),1))),256)):u("",!0)]),e(T)===e(E).ONLINE?(l(),a("tr",Me,[g[7]||(g[7]=d("td",null,null,-1)),(l(!0),a(A,null,Y(ee.value,t=>(l(),a("td",null,y(t.isWinner?te.value?"TIE!":"WINNER!":""),1))),256))])):u("",!0)],64)):u("",!0)])],2))}}),Ze=ye(Xe,[["__scopeId","data-v-34b2856b"]]),Je={class:"h-fit flex flex-row-reverse md:flex-col gap-3"},Ke={class:"flex flex-wrap justify-center gap-3"},qe={key:1,class:"w-full"},Qe={class:"flex justify-center"},et={key:2,class:"w-full flex flex-col md:flex-row gap-3 justify-center"},tt={class:"w-full md:w-1/2 flex justify-center gap-3"},lt={class:"w-full md:w-1/2 flex justify-center gap-3"},at={class:"mt-5 flex flex-col md:flex-row gap-3 justify-center"},st={key:3,class:"flex flex-wrap gap-3 mt-3 justify-center"},yt=le({__name:"Yahtzee",setup(Q){const R=Ie(),G=ie(),T=ve(),{onlineGameId:v,onlineGameChat:$,onlineGamePlayers:F,partyName:w,maxPlayers:W,isOnlineGameOwner:D,gameType:I,gameStatus:n,activePlayerId:b,myPlayerId:V,canRoll:L,canReroll:c,dices:B,finalScore:h,personalBest:j}=z(G),{firebaseUser:H}=z(T),{start:J,$reset:i,createOnlineGame:o,continueOnlineGame:s,leaveOnlineGame:f,deleteOnlineGame:X,getPlayerDisplayName:ae,roll:se,updateYahtzeeHighscore:re}=G,K=Z(!1),x=Z(!1),M=O(()=>W.value?W.value-F.value.length:0),ne=()=>{x.value=!1,i()},ee=()=>{x.value=!1,I.value=E.SOLO,J()},te=async()=>{v.value&&await f(),i()},U=async()=>{x.value=!1,v.value&&(D.value?await X():await f()),i()};return fe(async()=>{v.value&&(await f(),i())}),(g,t)=>(l(),S(oe,{class:"!bg-cyan-800 !bg-opacity-50 my-5 !rounded-secondary",title:"Yahtzee",tags:e(I)===e(E).ONLINE&&e(w)?[{value:e(w),severity:"danger"}]:void 0,description:e(I)===e(E).SOLO?e(n)===e(r).HAS_NOT_STARTED?"Play solo or with a friend.":"Play solo.":"Play with a friend."},{right:_(()=>[d("div",Je,[m(N,{class:"border-none h-fit",variant:"neutral",icon:"pi pi-cog",onClick:t[0]||(t[0]=p=>K.value=!0)}),e(D)&&e(n)!==e(r).HAS_FINISHED?(l(),S(N,{key:0,variant:"danger",icon:"pi pi-trash",onClick:U})):u("",!0)])]),default:_(()=>[d("div",Ke,[e(n)===e(r).HAS_NOT_STARTED?(l(),a(A,{key:0},[m(N,{class:"w-full md:w-1/2",onClick:ee},{default:_(()=>t[12]||(t[12]=[k(" Play Solo ")])),_:1,__:[12]}),m(N,{class:"w-full md:w-1/2",variant:"purple",onClick:t[1]||(t[1]=()=>{n.value=e(r).FINDING_OPPONENT,I.value=e(E).ONLINE})},{default:_(()=>t[13]||(t[13]=[k(" Play Online ")])),_:1,__:[13]}),e(n)===e(r).HAS_NOT_STARTED&&!x.value?(l(),S(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:t[2]||(t[2]=p=>x.value=!0)},{default:_(()=>t[14]||(t[14]=[k(" View Highscores ")])),_:1,__:[14]})):e(n)===e(r).HAS_NOT_STARTED?(l(),S(N,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:t[3]||(t[3]=p=>x.value=!1)},{default:_(()=>t[15]||(t[15]=[k(" Go Back ")])),_:1,__:[15]})):u("",!0)],64)):e(n)===e(r).FINDING_OPPONENT?(l(),a("div",qe,[m(xe,{"allow-party":"",onCreateOnlineGame:t[4]||(t[4]=p=>e(o)([{userId:p}])),onContinueOnlineGame:e(s),onCreateParty:t[5]||(t[5]=(p,pe)=>e(o)([],p,pe)),onJoinParty:e(s)},null,8,["onContinueOnlineGame","onJoinParty"]),d("div",Qe,[m(N,{class:"w-full md:w-1/2",variant:"neutral",onClick:te},{default:_(()=>t[16]||(t[16]=[k(" Go Back ")])),_:1,__:[16]})])])):e(n)!==e(r).HAS_FINISHED?(l(),a("div",et,[d("div",tt,[e(I)===e(E).ONLINE||e(L)||e(c)?(l(),S(N,{key:0,class:"w-full",variant:"tertiary",disabled:e(b)!==e(V)||e(n)===e(r).HAS_CHOSEN_DICES||e(n)===e(r).WAITING_FOR_OPPONENTS||e(B).every(p=>p.selected),onClick:e(se)},{default:_(()=>[k(y(M.value?`Waiting for ${M.value} more player${M.value!==1?"s":""}`:e(b)!==e(V)?`${e(ae)(e(b))}'s turn`:e(c)?"Reroll":"Roll"),1)]),_:1},8,["disabled","onClick"])):u("",!0)]),d("div",lt,[(l(!0),a(A,null,Y(e(B),p=>(l(),S(ge,{key:p.id,dice:p},null,8,["dice"]))),128))])])):u("",!0)]),x.value?(l(),S(he,{key:0,"game-id":e(ue).YAHTZEE},null,8,["game-id"])):!x.value&&e(n)!==e(r).FINDING_OPPONENT?(l(),S(Ze,{key:1})):u("",!0),e(I)===e(E).ONLINE&&e(n)>=e(r).HAS_STARTED?(l(),S(Ae,{key:2,chats:e($)??[],onSendChat:t[6]||(t[6]=p=>$.value=[...e($)??[],p])},null,8,["chats"])):u("",!0),d("div",at,[e(n)>=e(r).WAITING_FOR_OPPONENTS&&e(n)<=e(r).HAS_FINISHED?(l(),a(A,{key:0},[e(I)===e(E).SOLO?(l(),S(N,{key:0,class:"w-full md:w-1/2",variant:e(n)===e(r).HAS_FINISHED?"secondary":"neutral",onClick:ne},{default:_(()=>[k(y(e(n)===e(r).HAS_FINISHED?"Play Again":"Restart"),1)]),_:1},8,["variant"])):e(I)===e(E).ONLINE?(l(),a(A,{key:1},[e(D)?(l(),a(A,{key:1},[e(n)!==e(r).HAS_FINISHED?(l(),S(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:te},{default:_(()=>t[17]||(t[17]=[k(" Go Back ")])),_:1,__:[17]})):(l(),S(N,{key:1,class:"w-full md:w-1/2",variant:"danger",onClick:U},{default:_(()=>t[18]||(t[18]=[k(" Play Again ")])),_:1,__:[18]}))],64)):(l(),S(N,{key:0,class:"w-full md:w-1/2",variant:"neutral",onClick:U},{default:_(()=>[k(y(e(n)===e(r).HAS_FINISHED?"Play Again":"Go Back"),1)]),_:1}))],64)):u("",!0)],64)):u("",!0),e(n)===e(r).HAS_FINISHED&&!x.value?(l(),S(N,{key:1,class:"w-full md:w-1/2",variant:"neutral",onClick:t[7]||(t[7]=p=>x.value=!0)},{default:_(()=>t[19]||(t[19]=[k(" View Highscores ")])),_:1,__:[19]})):e(n)===e(r).HAS_FINISHED?(l(),S(N,{key:2,class:"w-full md:w-1/2",variant:"neutral",onClick:t[8]||(t[8]=p=>x.value=!1)},{default:_(()=>t[20]||(t[20]=[k(" View Your Score ")])),_:1,__:[20]})):u("",!0)]),e(n)===e(r).HAS_FINISHED?(l(),a("div",st,[e(H)?e(I)===e(E).SOLO&&e(j)<e(h)[e(V)]?(l(),S(N,{key:1,class:"w-full md:w-1/2",variant:"primary",onClick:t[10]||(t[10]=p=>e(re)())},{default:_(()=>t[23]||(t[23]=[k(" Add To Leaderboard ")])),_:1,__:[23]})):u("",!0):(l(),S(oe,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:_(()=>[t[21]||(t[21]=k(" Please ")),d("a",{class:"cursor-pointer",onClick:t[9]||(t[9]=p=>e(R).push({name:e(ke).LOGIN,params:{redirect:JSON.stringify({name:e(Ne).GAMES_YAHTZEE})}}))}," Login "),t[22]||(t[22]=k(" to add your score to the leaderboard. "))]),_:1,__:[21,22]}))])):u("",!0),m(He,{"game-id":e(ue).YAHTZEE,"is-open":K.value,"onUpdate:isOpen":t[11]||(t[11]=p=>K.value=p)},null,8,["game-id","is-open"])]),_:1},8,["tags","description"]))}});export{yt as default};
