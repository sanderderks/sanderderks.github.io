import{a as $}from"./c-TextField.vue_vue_type_script_setup_true_lang-IXzObKaR.js";import{_ as j}from"./c-validation-Bf-E2UlI.js";import{M as D,bU as I,bV as L,bW as N,aS as t,q as b,ck as T,bQ as q,bC as z,aK as o,u as d,b9 as g,t as i,v as c,s as h,au as A,a4 as E,ar as K,cl as M}from"../bundle.js";const O={class:"m-4"},Q=["for"],W={class:"flex justify-between gap-1"},G=["id","disabled"],H={key:2},J={class:"flex justify-center"},X=["src"],ee=D({__name:"FileUpload",props:{id:{},name:{},label:{},modelValue:{},error:{},isPublic:{type:Boolean},blogPost:{},imageProps:{},imageContainerProps:{}},emits:["update:modelValue","update:error"],setup(_,{expose:y,emit:k}){const l=_,{firebaseUser:f}=I(L()),{fetchFileInfo:V,uploadFile:w,deleteFile:P}=N(),v=t(),s=t(null),n=t(0),r=b(()=>T(l.modelValue||"uploads/"+q())),U=b(()=>r.value.name),u=t(),m=t(""),F=e=>{const a=e.target;a.files&&a.files.length>0&&(s.value=a.files[0],m.value=s.value.name,C())},C=async()=>{var e,a;s.value&&((e=f.value)!=null&&e.uid)&&await w(r.value,s.value,S=>n.value=S,m.value,(a=f.value)==null?void 0:a.uid,l.isPublic,l.blogPost)&&(p("update:modelValue",await M(r.value)),s.value=null,n.value=0)},R=async()=>{await P(r.value)?(window.URL.revokeObjectURL(l.modelValue),v.value.value=null,p("update:modelValue","")):p("update:error","Failed to delete File reference")},B=()=>{};z(()=>l.modelValue,async()=>{var e;u.value=l.modelValue?await V(U.value):void 0,m.value=((e=u.value)==null?void 0:e.name)??""},{immediate:!0});const p=k;return y({test:B}),(e,a)=>(o(),d("div",O,[e.label?(o(),d("label",{key:0,class:"block text-sm font-bold mb-2",for:`${e.id}`},g(e.label),9,Q)):i("",!0),c("div",W,[c("input",{id:`${e.id}`,ref_key:"fileUpload",ref:v,type:"file",accept:"image/*",onChange:F,class:"p-input",disabled:!!u.value},null,40,G),e.modelValue?(o(),h($,{key:0,onClick:R})):i("",!0)]),e.error?(o(),h(j,{key:1,name:e.name,error:e.error},null,8,["name","error"])):i("",!0),n.value>0?(o(),d("div",H,"Uploading: "+g(n.value.toFixed(2))+"%",1)):i("",!0),c("div",J,[c("div",A(E(e.imageContainerProps)),[u.value?(o(),d("img",K({key:0,class:"p-input-file mt-4 w-full min-w-25 md:max-w-fit",src:e.modelValue},e.imageProps),null,16,X)):i("",!0)],16)])]))}});export{ee as _};
