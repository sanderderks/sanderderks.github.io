import{e as U,l as M,m as k,H as G,E as z,r as v,c as d,o as A,au as j,aC as B,aD as E,aE as R,aF as P,aG as W,M as Z,k as r,z as V,t as I,p as S,n as C,G as F}from"../bundle.js";const H=U({__name:"CountdownNumber",props:{time:{},animate:{type:Boolean},direction:{}},setup(D){return(e,n)=>(M(),k("span",{class:z({"animation ease-in animate-timer-up":e.animate&&(e.direction==="up"||e.direction==="current"),"animation ease-in animate-timer-down":e.animate&&e.direction==="down"})},G(e.time),3))}}),O=(D,e)=>{const n=v(0),o=v(0),s=v(0),a=v(0),m=v(0),x=d(()=>n.value===0&&o.value===0&&s.value===0&&a.value===0&&m.value===0),y=d(()=>n.value>0),Y=d(()=>n.value>0||o.value>0||x.value),_=d(()=>n.value>0||o.value>0||s.value>0||x.value),b=d(()=>n.value>0||o.value>0||s.value>0||a.value>0||x.value),w=d(()=>n.value>0||o.value>0||s.value>0||a.value>0||m.value>0||x.value),h=t=>(e==="up"?t=Math.abs(t):t=Math.max(0,t),Math.floor(t)),l=()=>{const t=new Date,i=e==="up"?new Date(j(D)):t,f=e==="up"?t:new Date(j(D));if(e==="up"&&i.getTime()>f.getTime()||e==="down"&&f.getTime()<=i.getTime()){n.value=0,o.value=0,s.value=0,a.value=0,m.value=0;return}else if(e==="current"){n.value=t.getFullYear(),o.value=t.getDate(),s.value=t.getHours(),a.value=t.getMinutes(),m.value=t.getSeconds(),setTimeout(l,1e3);return}let g=f.getFullYear()-i.getFullYear();f.getMonth()>i.getMonth()||f.getMonth()===i.getMonth()&&f.getDate()>=i.getDate()||g--;const p=new Date(i);p.setFullYear(i.getFullYear()+g),n.value=h(g);const $=f.getTime()-p.getTime();o.value=h($/B);const T=$%B;s.value=h(T/E);const L=T%E;a.value=h(L/R);const u=L%R;m.value=h(u/P),setTimeout(l,1e3)};return A(()=>{l()}),{years:n,days:o,hours:s,minutes:a,seconds:m,showYears:y,showDays:Y,showHours:_,showMinutes:b,showSeconds:w}},q=(D,e,n,o,s,a,m)=>{const x=v(0),y=d(()=>e.value===0&&n.value===0&&o.value===0&&s.value===0&&a.value===0),Y=d(()=>m==="down"?n.value===364:n.value===0),_=d(()=>m==="down"?o.value===23:o.value===0),b=d(()=>m==="down"?s.value===59:s.value===0),w=d(()=>m==="down"?a.value===59:a.value===0),h=d(()=>e.value>=0&&Y.value&&_.value&&b.value&&w.value),l=d(()=>n.value>=0&&_.value&&b.value&&w.value),t=d(()=>o.value>=0&&b.value&&w.value),i=d(()=>s.value>=0&&w.value),f=d(()=>!y.value),g=()=>{x.value=D-new Date().getTime(),setTimeout(g,1e3)};return A(()=>{g()}),{animateYears:h,animateDays:l,animateHours:t,animateMinutes:i,animateSeconds:f}},J=()=>{const D="https://api.wikimedia.org/feed/v1/wikipedia/en/onthisday",e=v([]),n=v([]),o=v([]),s=v([]),a=v([]),m=v([]),x=v(!1),y=v(!1),Y=v(),_=l=>{const t=l.getMonth()+1;return t<10?`0${t}`:t},b=l=>l.getDate()<10?`0${l.getDate()}`:l.getDate(),w=(l,t)=>l?l.filter(i=>i.year===t):[],h=async(l,t,i={})=>{var f;if(((f=Y.value)==null?void 0:f.getDate())!==l.getDate()){Y.value=new Date,y.value=!1,x.value=!0;try{const g=_(l),c=b(l),$=await(await fetch(`${D}/${t}/${g}/${c}`)).json(),T=(u,N=!0)=>(i.reverse&&(u==null||u.reverse()),N&&i.limit&&(u=u==null?void 0:u.slice(0,i.limit)),u||[]);e.value=T($.selected),n.value=T($.births),o.value=T($.deaths),s.value=T($.holidays),a.value=T($.events);const L=T([...n.value.map(u=>({...u,type:"births"})),...o.value.map(u=>({...u,type:"deaths"})),...a.value.map(u=>({...u,type:"events"}))].sort((u,N)=>(N.year||0)-(u.year||0)),!1);s.value.forEach(u=>{L.splice(W(L.length),0,{...u,type:"holidays"})}),m.value=L}catch{y.value=!0}finally{const g=[...e.value,...n.value,...o.value,...s.value,...a.value];if((i.retry??3)&&!g.length){h(l,t,{retry:(i.retry??3)-1});return}x.value=!1}}};return{selected:e,births:n,deaths:o,holidays:s,events:a,mixed:m,isLoading:x,hasError:y,fetchData:h,filterByYear:w}},K={key:0,class:"px-4 py-2 xl:p-4 flex justify-center items-center"},Q={class:"grid grid-flow-col text-center"},X={key:0,class:"flex flex-col py-2 px-1 sm:px-2 bg-neutral rounded-box text-neutral-content rounded-primary"},ee={class:"text-xl sm:text-3xl md:text-3xl lg:text-5xl font-mono font-bold sm:font-normal"},te={key:1,class:"flex flex-col py-2 px-1 sm:px-2 bg-neutral rounded-box text-neutral-content rounded-primary"},ne={class:"text-xl sm:text-3xl md:text-3xl lg:text-5xl font-mono font-bold sm:font-normal"},se={key:2,class:"flex flex-col py-2 px-1 sm:px-2 bg-neutral rounded-box text-neutral-content rounded-primary"},ae={class:"text-xl sm:text-3xl md:text-3xl lg:text-5xl font-mono font-bold sm:font-normal"},oe={key:3,class:"flex flex-col py-2 px-1 sm:px-2 bg-neutral rounded-box text-neutral-content rounded-primary"},le={class:"text-xl sm:text-3xl md:text-3xl lg:text-5xl font-mono font-bold sm:font-normal"},ie={key:4,class:"flex flex-col py-2 px-1 sm:px-2 bg-neutral rounded-box text-neutral-content rounded-primary"},ue={class:"text-xl sm:text-3xl md:text-3xl lg:text-5xl font-mono font-bold sm:font-normal"},re={key:1,class:"px-4 py-2 xl:p-4 flex flex-col justify-center gap-3"},ce=U({__name:"Countdown",props:{time:{},direction:{},alignment:{}},setup(D){const e=D,{selected:n,fetchData:o}=J(),{years:s,days:a,hours:m,minutes:x,seconds:y,showYears:Y,showDays:_,showHours:b,showMinutes:w,showSeconds:h}=O(()=>e.time,e.direction),{animateYears:l,animateDays:t,animateHours:i,animateMinutes:f,animateSeconds:g}=q(e.time,s,a,m,x,y,e.direction);return Z([s,a],()=>{s.value>0&&a.value===0&&o(new Date(e.time),"selected",{limit:10})}),(c,p)=>(M(),k("div",{class:z({block:!c.alignment,flex:!!c.alignment,"justify-start":c.alignment==="left","justify-center":c.alignment==="center","justify-end":c.alignment==="right"})},[r(a)===0&&c.$slots.birthdayText?(M(),k("div",K,[V(c.$slots,"birthdayText")])):I("",!0),S("div",Q,[r(Y)?(M(),k("div",X,[S("span",ee,[C(H,{time:r(s),animate:r(l),direction:c.direction},null,8,["time","animate","direction"])]),p[0]||(p[0]=F(" years "))])):I("",!0),r(_)?(M(),k("div",te,[S("span",ne,[C(H,{time:r(a),animate:r(t),direction:c.direction},null,8,["time","animate","direction"])]),p[1]||(p[1]=F(" days "))])):I("",!0),r(b)?(M(),k("div",se,[S("span",ae,[C(H,{time:r(m),animate:r(i),direction:c.direction},null,8,["time","animate","direction"])]),p[2]||(p[2]=F(" hrs "))])):I("",!0),r(w)?(M(),k("div",oe,[S("span",le,[C(H,{time:r(x),animate:r(f),direction:c.direction},null,8,["time","animate","direction"])]),p[3]||(p[3]=F(" mins "))])):I("",!0),r(h)?(M(),k("div",ie,[S("span",ue,[C(H,{time:r(y),animate:r(g),direction:c.direction},null,8,["time","animate","direction"])]),p[4]||(p[4]=F(" secs "))])):I("",!0)]),r(a)===0&&r(n).length?(M(),k("div",re,[V(c.$slots,"onThisDay",{selected:r(n)})])):I("",!0)],2))}});export{ce as _,J as u};
