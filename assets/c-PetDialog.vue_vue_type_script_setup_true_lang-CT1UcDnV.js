import{_ as Y,a as ie}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-lxypY4ur.js";import{D as E}from"./c-DateField-DwZc4feZ.js";import{_ as de}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-D8Ln9Mzp.js";import{_ as A}from"./c-SelectField.vue_vue_type_script_setup_true_lang-BFyx74Rf.js";import{_ as L}from"./c-TextField.vue_vue_type_script_setup_true_lang-BCXugEY6.js";import{e as ee,r as i,c as T,l as V,m as se,n,k as t,p as o,q as g,h as ue,ay as me,s as Z,a as ve,N as ge,t as c,E as v,aA as Ee,aB as De,w as C,aC as fe,z as _e,J as Te,aD as Ve,aJ as be,b as we}from"../bundle.js";import{R as I}from"./c-validation-CO90d-7g.js";import{s as p,a as Q}from"./c-accordiontab.esm-BILpUr6U.js";import{_ as ae}from"./c-Bubble.vue_vue_type_script_setup_true_lang-DwnbaZC0.js";import{D as Pe}from"./c-vuedraggable.umd-CB_ZnmWx.js";const Se={class:"md:px-5"},ce={class:"mt-3 flex justify-evenly font-bold"},pe=ee({__name:"PetLogDialogSection",props:{id:{},log:{}},emits:["error","delete"],setup(U,{expose:y,emit:u}){const b=u,w=i(),D=i(),f=i(),_=i(),F=T(()=>[f.value,_.value].some(e=>!!e));return y({test:async()=>{var e,d;await Promise.all([(e=w.value)==null?void 0:e.test(),(d=D.value)==null?void 0:d.test()]),b("error",F.value)}}),(e,d)=>(V(),se("div",Se,[n(E,{ref_key:"dateField",ref:w,id:e.id,name:"logDate",label:t(o)("PETS_PET_FIELD_WEIGHT_LOG_DATE"),modelValue:e.log.date,"onUpdate:modelValue":d[0]||(d[0]=s=>e.log.date=s),error:f.value,"onUpdate:error":d[1]||(d[1]=s=>f.value=s),"without-time":""},null,8,["id","label","modelValue","error"]),n(L,{ref_key:"weightField",ref:D,id:e.id,name:"logWeight",label:t(o)("PETS_PET_FIELD_WEIGHT")+" (kg)","model-value":`${e.log.weight}`,"onUpdate:modelValue":d[2]||(d[2]=s=>e.log.weight=Number(s)),error:_.value,"onUpdate:error":d[3]||(d[3]=s=>_.value=s),rules:[t(I).Required,t(I).Numeric],"min-value":0,"input-props":{type:"number"}},null,8,["id","label","model-value","error","rules"]),g("div",ce,[n(ae,{class:"w-full sm:w-2/3 md:w-1/2 xl:w-2/3",type:"danger",outlined:"",label:t(o)("GENERAL_DELETE"),onClick:d[4]||(d[4]=s=>e.$emit("delete"))},null,8,["label"])])]))}}),Le={class:"pt-6 mb-4 xl:px-16"},Ie={class:"flex gap-5"},ye={class:"mt-3 flex justify-center"},Fe={class:"basis-full lg:basis-1/2"},Re=ee({__name:"PetDialog",props:{isOpen:{type:Boolean},originalPet:{}},emits:["close"],setup(U,{emit:y}){const u=U,b=y,w=ue(),D=me(),{isMutationLoading:f}=Z(D),{firebaseUser:_}=Z(w),{mutatePet:F}=D,O=r=>({name:{value:(r==null?void 0:r.name)??"",error:""},avatar:{value:(r==null?void 0:r.avatar)??"",error:""},dateOfBirth:{value:r!=null&&r.dateOfBirth?new Date(r.dateOfBirth):null,error:""},type:{value:(r==null?void 0:r.type)??"cat",error:""},breed:{value:(r==null?void 0:r.breed)??"",error:""},breedSize:{value:(r==null?void 0:r.breedSize)??"medium",error:""},gender:{value:(r==null?void 0:r.gender)??"male",error:""},weight:{value:r!=null&&r.weight?r.weight.toString():"",error:""},insideCat:{value:(r==null?void 0:r.insideCat)??!1,error:""},castrated:{value:(r==null?void 0:r.castrated)??!1,error:""},dewormingDate:{value:r!=null&&r.dewormingDate?new Date(r.dewormingDate):null,error:""},vetDate:{value:r!=null&&r.vetDate?new Date(r.vetDate):null,error:""},lastVaccinationDate:{value:r!=null&&r.lastVaccinationDate?new Date(r.lastVaccinationDate):null,error:""},nextVaccinationDate:{value:r!=null&&r.nextVaccinationDate?new Date(r.nextVaccinationDate):null,error:""},weightLog:{value:r!=null&&r.weightLog?r.weightLog.map(a=>({...a,date:new Date(a.date)})):[],error:{}}}),e=ve(O(u.originalPet)),d=T(()=>{var r,a;return{name:e.name.value,userId:((r=u.originalPet)==null?void 0:r.userId)??((a=_.value)==null?void 0:a.uid)??"",avatar:e.avatar.value,dateOfBirth:e.dateOfBirth.value??null,type:e.type.value,breed:e.breed.value,breedSize:e.breedSize.value,gender:e.gender.value,weight:isNaN(+e.weight.value)?null:+e.weight.value,insideCat:e.type.value==="cat"?e.insideCat.value:null,castrated:e.castrated.value,dewormingDate:e.dewormingDate.value??null,vetDate:e.vetDate.value??null,lastVaccinationDate:e.lastVaccinationDate.value??null,nextVaccinationDate:e.nextVaccinationDate.value??null,weightLog:e.weightLog.value}}),s=i(),k=i(),N=i(),B=i(),h=i(),G=i(),x=i(),R=i(),$=i(),z=i(),H=i(),W=i(),j=i(),M=i(),q=i([]),P=T(()=>u.originalPet?be.convert(u.originalPet):null),J=T(()=>!we(P.value,d.value)),K=T(()=>{if(e.name.value)return e.name.value;switch(e.type.value){case"cat":return"Cat";case"dog":return"Dog";default:return"Pet"}}),re=async()=>{var r,a,l,S;await Promise.all([s.value.test(),k.value.test(),N.value.test(),B.value.test(),h.value.test(),(r=G.value)==null?void 0:r.test(),x.value.test(),(a=R.value)==null?void 0:a.test(),(l=$.value)==null?void 0:l.test(),z.value.test(),H.value.test(),j.value.test(),M.value.test(),W.value.test()]);for(const m of q.value)await(m==null?void 0:m.test());e.name.error||e.avatar.error||e.dateOfBirth.error||e.type.error||e.breed.error||e.breedSize.error||e.gender.error||e.weight.error||e.insideCat.error||e.castrated.error||e.dewormingDate.error||e.vetDate.error||e.lastVaccinationDate.error||e.nextVaccinationDate.error||Object.values(e.weightLog.error).some(m=>!!m)||(await F(d.value,(S=u.originalPet)==null?void 0:S.id),b("close"))},le=()=>{e.weightLog.value.push({date:new Date,weight:0})},X=r=>e.weightLog.value.findIndex(a=>a.date.toString()===r),te=r=>{e.weightLog.value.splice(X(r),1)},oe=(r,a)=>{e.weightLog.error[X(a)]=r},ne=()=>{b("close")};return ge(()=>[u.isOpen,u.originalPet],()=>{Object.assign(e,O(u.originalPet))}),(r,a)=>(V(),c(ie,{isOpen:r.isOpen,title:P.value?t(o)("PETS_DIALOG_TITLE_EDIT"):t(o)("PETS_DIALOG_TITLE_ADD"),description:P.value?t(o)("PETS_DIALOG_SUBTITLE_EDIT"):t(o)("PETS_DIALOG_SUBTITLE_ADD"),"confirm-text":P.value?J.value?t(o)("GENERAL_DIALOG_UPDATE"):t(o)("GENERAL_NOTHING_CHANGED"):t(o)("GENERAL_DIALOG_CREATE"),"confirm-loading":t(f),"confirm-props":{disabled:!J.value},onConfirm:re,onCancel:ne},{default:v(()=>[g("form",Le,[n(L,{ref_key:"nameField",ref:s,id:"name",name:"name",label:t(o)("PETS_PET_FIELD_NAME"),placeholder:"Mogu",modelValue:e.name.value,"onUpdate:modelValue":a[0]||(a[0]=l=>e.name.value=l),error:e.name.error,"onUpdate:error":a[1]||(a[1]=l=>e.name.error=l),rules:[t(I).Required],"min-length":3,"max-length":50},null,8,["label","modelValue","error","rules"]),n(t(Q),null,{default:v(()=>[n(t(p),{header:`${K.value}'s ${t(o)("PETS_PET_FIELD_SECTION_DETAILS")}`},{default:v(()=>[n(E,{ref_key:"dateOfBirthField",ref:N,name:"dateOfBirth",label:t(o)("PETS_PET_FIELD_DATE_OF_BIRTH"),modelValue:e.dateOfBirth.value,"onUpdate:modelValue":a[2]||(a[2]=l=>e.dateOfBirth.value=l),error:e.dateOfBirth.error,"onUpdate:error":a[3]||(a[3]=l=>e.dateOfBirth.error=l),"without-time":""},null,8,["label","modelValue","error"]),n(A,{ref_key:"typeField",ref:B,name:"type",label:t(o)("PETS_PET_FIELD_TYPE"),modelValue:e.type.value,"onUpdate:modelValue":a[4]||(a[4]=l=>e.type.value=l),error:e.type.error,"onUpdate:error":a[5]||(a[5]=l=>e.type.error=l),options:t(Ee)()},null,8,["label","modelValue","error","options"]),n(L,{ref_key:"breedField",ref:h,id:"breed",name:"breed",label:t(o)("PETS_PET_FIELD_BREED"),placeholder:e.type.value==="dog"?"Golden Retriever":"Maine Coone",modelValue:e.breed.value,"onUpdate:modelValue":a[6]||(a[6]=l=>e.breed.value=l),error:e.breed.error,"onUpdate:error":a[7]||(a[7]=l=>e.breed.error=l),"min-length":3,"max-length":50},null,8,["label","placeholder","modelValue","error"]),e.type.value==="dog"?(V(),c(A,{key:0,ref_key:"breedSizeField",ref:G,name:"breedSize",label:t(o)("PETS_PET_FIELD_BREEDSIZE"),modelValue:e.breedSize.value,"onUpdate:modelValue":a[8]||(a[8]=l=>e.breedSize.value=l),error:e.breedSize.error,"onUpdate:error":a[9]||(a[9]=l=>e.breedSize.error=l),options:t(De)()},null,8,["label","modelValue","error","options"])):C("",!0),n(A,{ref_key:"genderField",ref:x,name:"gender",label:t(o)("PETS_PET_FIELD_GENDER"),modelValue:e.gender.value,"onUpdate:modelValue":a[10]||(a[10]=l=>e.gender.value=l),error:e.gender.error,"onUpdate:error":a[11]||(a[11]=l=>e.gender.error=l),options:t(fe)()},null,8,["label","modelValue","error","options"])]),_:1},8,["header"]),n(t(p),{header:`${K.value}'s ${t(o)("PETS_PET_FIELD_SECTION_HEALTH")}`},{default:v(()=>[e.weightLog.value.length?C("",!0):(V(),c(L,_e({key:0,ref_key:"weightField",ref:R,name:"weight",label:t(o)("PETS_PET_FIELD_WEIGHT")+" (kg)",modelValue:e.weight.value,"onUpdate:modelValue":a[12]||(a[12]=l=>e.weight.value=l),error:e.weight.error,"onUpdate:error":a[13]||(a[13]=l=>e.weight.error=l)},e.weight.value?{rules:[t(I).Numeric],minValue:0}:void 0,{"input-props":{type:"number"}}),null,16,["label","modelValue","error"])),e.type.value==="cat"?(V(),c(Y,{key:1,ref_key:"insideCatField",ref:$,name:"insideCat",label:t(o)("PETS_PET_FIELD_INSIDE_CAT"),modelValue:e.insideCat.value,"onUpdate:modelValue":a[14]||(a[14]=l=>e.insideCat.value=l)},null,8,["label","modelValue"])):C("",!0),n(Y,{ref_key:"castratedField",ref:z,name:"castrated",label:t(o)("PETS_PET_FIELD_CASTRATED"),modelValue:e.castrated.value,"onUpdate:modelValue":a[15]||(a[15]=l=>e.castrated.value=l)},null,8,["label","modelValue"]),n(E,{ref_key:"vetDateField",ref:W,name:"vetDate",label:t(o)("PETS_PET_FIELD_LAST_VET_VISIT"),modelValue:e.vetDate.value,"onUpdate:modelValue":a[16]||(a[16]=l=>e.vetDate.value=l),error:e.vetDate.error,"onUpdate:error":a[17]||(a[17]=l=>e.vetDate.error=l),"without-time":""},null,8,["label","modelValue","error"]),n(E,{ref_key:"lastVaccinationDateField",ref:j,name:"lastVaccinationDate",label:t(o)("PETS_PET_FIELD_LAST_VACCINATION"),modelValue:e.lastVaccinationDate.value,"onUpdate:modelValue":a[18]||(a[18]=l=>e.lastVaccinationDate.value=l),error:e.lastVaccinationDate.error,"onUpdate:error":a[19]||(a[19]=l=>e.lastVaccinationDate.error=l),"without-time":""},null,8,["label","modelValue","error"]),n(E,{ref_key:"nextVaccinationDateField",ref:M,name:"nextVaccinationDate",label:t(o)("PETS_PET_FIELD_NEXT_VACCINATION"),modelValue:e.nextVaccinationDate.value,"onUpdate:modelValue":a[20]||(a[20]=l=>e.nextVaccinationDate.value=l),error:e.nextVaccinationDate.error,"onUpdate:error":a[21]||(a[21]=l=>e.nextVaccinationDate.error=l),"without-time":""},null,8,["label","modelValue","error"]),n(E,{ref_key:"dewormingDateField",ref:H,name:"dewormingDate",label:t(o)("PETS_PET_FIELD_LAST_DEWORMING"),modelValue:e.dewormingDate.value,"onUpdate:modelValue":a[22]||(a[22]=l=>e.dewormingDate.value=l),error:e.dewormingDate.error,"onUpdate:error":a[23]||(a[23]=l=>e.dewormingDate.error=l),"without-time":""},null,8,["label","modelValue","error"])]),_:1},8,["header"]),n(t(p),{header:t(o)("PETS_PET_FIELD_SECTION_WEIGHT_LOG")},{default:v(()=>[n(t(Pe),{ref:"draggable",modelValue:e.weightLog.value,"onUpdate:modelValue":a[24]||(a[24]=l=>e.weightLog.value=l),itemKey:l=>l.date.toString(),handle:".drag-handle"},{item:v(({element:l,index:S})=>[n(t(Q),null,{default:v(()=>[n(t(p),{pt:{header:{class:"drag-handle"},toggleableContent:{class:"background-gray-dark rounded-t-primary rounded-b-primary pt-3 my-3"}}},{header:v(()=>[g("div",Ie,[a[27]||(a[27]=g("i",{class:"pi pi-arrows-v place-self-center hover:cursor-pointer"},null,-1)),g("p",null,Te(t(Ve)(l.date)),1)])]),default:v(()=>[n(pe,{ref:m=>{q.value[S]=m},id:l.date.toString(),log:l,"is-open":r.isOpen,onDelete:m=>te(l.date.toString()),onError:m=>oe(m,l.date.toString())},null,8,["id","log","is-open","onDelete","onError"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","itemKey"]),g("div",ye,[n(ae,{class:"w-1/2",type:"green",label:t(o)("PETS_PET_FIELD_WEIGHT_LOG_ADD"),onClick:le},null,8,["label"])])]),_:1},8,["header"])]),_:1}),g("div",Fe,[n(de,{ref_key:"avatarField",ref:k,id:"avatar",name:"avatar",label:t(o)("PETS_PET_FIELD_AVATAR"),modelValue:e.avatar.value,"onUpdate:modelValue":a[25]||(a[25]=l=>e.avatar.value=l),error:e.avatar.error,"onUpdate:error":a[26]||(a[26]=l=>e.avatar.error=l),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["label","modelValue","error"])])])]),_:1},8,["isOpen","title","description","confirm-text","confirm-loading","confirm-props"]))}});export{Re as _};
