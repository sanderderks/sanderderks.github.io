import{d as F,ba as Q,G as Y,q,s as w,l as R,b as s,c as o,e as r,g as $,f as a,J as c,h as b,w as T,D as z,af as H,i as K,_ as W,z as G,C as p,P as X,Q as Z,t as A,x as ee}from"../bundle.js";import{_ as J,a as D}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-BPB_A5Rj.js";const le={class:"mb-5 flex flex-col items-center"},te={key:0,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},se={key:1,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},ae={key:2,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},re={class:"w-full xl:w-2/3 flex flex-col md:flex-row justify-between"},ne={key:0,class:"w-full flex flex-col items-center"},oe={class:"w-full flex flex-col gap-3 items-center p-5"},ie={class:"w-full flex flex-col items-center"},ue={key:0,class:"w-full flex flex-col gap-3 items-center p-5"},ce={key:1,class:"w-full flex flex-col gap-3 items-center p-5"},de={class:"w-full flex flex-col gap-3 items-center"},ye=F({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(g,{emit:U}){const v=U,k=Q(),h=Y(),S=q(),{games:f,gamesLoading:i}=w(k),{onlineUsers:_}=w(h),{firebaseUser:m}=w(S),x=G(""),d=G(-1),u=p(()=>{var t;return(t=m.value)==null?void 0:t.uid}),V=p(()=>f.value.filter(t=>t.players.find(l=>l.userId===u.value))),y=p(()=>V.value.filter(t=>t.maxPlayers===null)),I=p(()=>_.value.filter(t=>!y.value.some(l=>l.players.some(e=>e.userId===t.id)))),C=p(()=>f.value.filter(t=>t.maxPlayers!==null)),P=p(()=>C.value.filter(t=>O(t.id))),N=p(()=>C.value.filter(t=>!O(t.id))),O=t=>{const l=C.value.find(e=>e.id===t);return(l==null?void 0:l.players.find(e=>e.userId===u.value))!==void 0},j=t=>{const l=C.value.find(e=>e.id===t);return!!l&&!l.isLocked},M=t=>{const l=y.value.find(e=>e.players.some(n=>n.userId===t));l?v("continueOnlineGame",l.id):v("createOnlineGame",t)},E=()=>{v("createParty",x.value,d.value)},B=t=>{v("joinParty",t)};return R(async()=>{await k.fetchGames()}),(t,l)=>(s(),o("div",le,[y.value.length?(s(),o("div",te,[l[6]||(l[6]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your 1v1s",-1)),y.value.length?(s(),$(J,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:y.value.flatMap(e=>e.players.filter(n=>{var L;return n.userId!==((L=a(m))==null?void 0:L.uid)}).map(n=>({id:n.userId}))),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[0]||(l[0]=e=>M(e))},null,8,["listOfUsers","get-color","isClickable"])):c("",!0)])):c("",!0),P.value.length?(s(),o("div",se,[l[7]||(l[7]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your parties",-1)),P.value.length?(s(),$(D,{key:0,class:"w-full justify-center !gap-3 !my-0 !py-5 border border-white",list:P.value.map(e=>({id:e.id,label:e.partyName||"Unknown Party"})),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[1]||(l[1]=e=>B(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),!y.value.length&&!P.value.length&&!a(_).filter(e=>e.id!==u.value).length?(s(),o("div",ae,[...l[8]||(l[8]=[r("h2",{class:"text-center text-nowrap"},"Nobody is online at the moment",-1)])])):c("",!0),r("div",re,[I.value.filter(e=>e.id!==u.value).length?(s(),o("div",ne,[r("div",oe,[l[9]||(l[9]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a 1v1",-1)),b(J,{class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:I.value.filter(e=>e.id!==u.value),"custom-click-action":"","get-color":e=>{var n;return a(i)||e===((n=a(m))==null?void 0:n.uid)?"bg-neutral-500":"bg-green-500"},isClickable:e=>{var n;return!a(i)&&e!==((n=a(m))==null?void 0:n.uid)},onClick:l[2]||(l[2]=e=>M(e))},null,8,["listOfUsers","get-color","isClickable"])])])):c("",!0),r("div",ie,[g.allowParty&&N.value.length?(s(),o("div",ue,[l[10]||(l[10]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Join a party",-1)),N.value.length?(s(),$(D,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",list:N.value.map(e=>({id:e.id,label:(e.partyName||"Unknown Party")+(e.isLocked?" (full)":"")})),"custom-click-action":"","get-color":e=>a(i)?"bg-neutral-500":j(e)?"bg-green-500":"bg-neutral-500",isClickable:e=>!a(i)&&j(e),onClick:l[3]||(l[3]=e=>B(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),g.allowParty?(s(),o("div",ce,[l[11]||(l[11]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a party",-1)),b(W,{class:"w-full min-h-[52px] flex flex-col flex-wrap gap-5 items-center !px-1 !py-2 !pb-5 !rounded-primary border border-white"},{default:T(()=>[r("div",de,[b(z,{class:"w-2/3","input-props":{class:"!placeholder-neutral-600"},name:"partyName",label:"Name",modelValue:x.value,"onUpdate:modelValue":l[4]||(l[4]=e=>x.value=e),type:"text",placeholder:"My Party"},null,8,["modelValue"]),b(H,{class:"w-2/3",name:"partyAmount",label:"Players",modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=e=>d.value=e),options:[{value:-1,label:"any"},{value:2,label:"2 players"},{value:3,label:"3 players"},{value:4,label:"4 players"},{value:5,label:"5 players"},{value:10,label:"10 players"}]},null,8,["modelValue"]),b(K,{class:"w-2/3",label:"Create",variant:"green",onClick:E})])]),_:1})])):c("",!0)])])]))}}),fe={key:0,class:"mt-3 md:ms-10 flex flex-col gap-3"},me={class:"flex gap-2"},pe={class:"font-bold"},be=F({__name:"GameChat",props:{chats:{}},emits:["sendChat"],setup(g,{emit:U}){const v=q(),k=Y(),{firebaseUser:h}=w(v),{combinedUsers:S}=w(k),f=G(""),i=()=>{if(h.value&&f.value){const m={userId:h.value.uid,message:f.value};_("sendChat",m),f.value=""}},_=U;return(m,x)=>(s(),o("form",{class:"w-full my-10 flex flex-wrap items-center justify-center",action:"",onSubmit:ee(i,["prevent"])},[b(z,{name:"chat",class:"w-full md:w-1/2",inputProps:{autocomplete:"off"},placeholder:"chat...",modelValue:f.value,"onUpdate:modelValue":x[0]||(x[0]=d=>f.value=d)},null,8,["modelValue"]),g.chats.length?(s(),o("div",fe,[(s(!0),o(X,null,Z([...g.chats].reverse().filter((d,u)=>u<3),d=>{var u;return s(),o("div",me,[r("p",pe,A(((u=a(S).find(V=>V.id===d.userId))==null?void 0:u.displayName)??"unknown")+":",1),r("p",null,A(d.message),1)])}),256))])):c("",!0)],32))}});export{ye as _,be as a};
