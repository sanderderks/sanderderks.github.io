import{d as Y,aR as q,v as z,c as D,s as P,w as j,f as u,o as E,g as c,j as r,m as n,q as o,l as C,h as s,k as m,A as F,P as L,T as H,_ as K,y as Q}from"../bundle.js";import{_ as $,a as B}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-Bw1DkFfV.js";const W={class:"mb-5 flex flex-col items-center"},X={key:0,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},Z={key:1,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},ee={key:2,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},le={class:"w-full xl:w-2/3 flex flex-col md:flex-row justify-between"},te={key:0,class:"w-full flex flex-col items-center"},ae={class:"w-full flex flex-col gap-3 items-center p-5"},se={class:"w-full flex flex-col items-center"},re={key:0,class:"w-full flex flex-col gap-3 items-center p-5"},oe={key:1,class:"w-full flex flex-col gap-3 items-center p-5"},ne={class:"w-full flex flex-col gap-3 items-center"},de=Y({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(ie,{emit:A}){const p=A,b=q(),M=z(),J=D(),{onlineGames:_,onlineGamesLoading:i}=P(b),{onlineUsers:h}=P(M),{firebaseUser:y}=P(J),{getPlayerDisplayName:G}=b,g=j(""),w=j(3),f=u(()=>{var t;return(t=y.value)==null?void 0:t.uid}),R=u(()=>_.value.filter(t=>t.players.find(l=>l.userId===f.value))),d=u(()=>R.value.filter(t=>!t.maxPlayers)),N=u(()=>h.value.filter(t=>!d.value.some(l=>l.players.some(e=>e.userId===t.id)))),x=u(()=>_.value.filter(t=>!!t.maxPlayers)),v=u(()=>x.value.filter(t=>O(t.id))),k=u(()=>x.value.filter(t=>!O(t.id))),O=t=>{const l=x.value.find(e=>e.id===t);return(l==null?void 0:l.players.find(e=>e.userId===f.value))!==void 0},I=t=>{const l=x.value.find(e=>e.id===t);return l&&l.maxPlayers&&l.players.length<l.maxPlayers||!1},S=t=>{const l=d.value.find(e=>e.players.some(a=>a.userId===t));l?p("continueOnlineGame",l.id):p("createOnlineGame",t)},T=()=>{p("createParty",g.value,w.value)},U=t=>{p("joinParty",t)};return E(async()=>{await b.fetchOnlineGames()}),(t,l)=>(r(),c("div",W,[d.value.length?(r(),c("div",X,[l[6]||(l[6]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your 1v1s",-1)),d.value.length?(r(),C($,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:d.value.flatMap(e=>e.players.filter(a=>{var V;return a.userId!==((V=s(y))==null?void 0:V.uid)}).map(a=>({id:a.userId}))),"custom-click-action":"","get-color":()=>s(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!s(i),onClick:l[0]||(l[0]=e=>S(e))},null,8,["listOfUsers","get-color","isClickable"])):n("",!0)])):n("",!0),v.value.length?(r(),c("div",Z,[l[7]||(l[7]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your parties",-1)),v.value.length?(r(),C(B,{key:0,class:"w-full justify-center !gap-3 !my-0 !py-5 border border-white",list:v.value.map(e=>({id:e.id,label:e.partyName||e.players.map(a=>s(G)(a.userId)).join(", ")})),"custom-click-action":"","get-color":()=>s(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!s(i),onClick:l[1]||(l[1]=e=>U(e))},null,8,["list","get-color","isClickable"])):n("",!0)])):n("",!0),!d.value.length&&!v.value.length&&!s(h).filter(e=>e.id!==f.value).length?(r(),c("div",ee,l[8]||(l[8]=[o("h2",{class:"text-center text-nowrap"},"Nobody is online at the moment",-1)]))):n("",!0),o("div",le,[N.value.filter(e=>e.id!==f.value).length?(r(),c("div",te,[o("div",ae,[l[9]||(l[9]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a 1v1",-1)),m($,{class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:N.value.filter(e=>e.id!==f.value),"custom-click-action":"","get-color":e=>{var a;return s(i)||e===((a=s(y))==null?void 0:a.uid)?"bg-neutral-500":"bg-green-500"},isClickable:e=>{var a;return!s(i)&&e!==((a=s(y))==null?void 0:a.uid)},onClick:l[2]||(l[2]=e=>S(e))},null,8,["listOfUsers","get-color","isClickable"])])])):n("",!0),o("div",se,[t.allowParty&&k.value.length?(r(),c("div",re,[l[10]||(l[10]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Join a party",-1)),k.value.length?(r(),C(B,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",list:k.value.map(e=>({id:e.id,label:e.partyName||e.players.map(a=>s(G)(a.userId)).join(", ")})),"custom-click-action":"","get-color":e=>s(i)?"bg-neutral-500":I(e)?"bg-green-500":"bg-neutral-500",isClickable:e=>!s(i)&&I(e),onClick:l[3]||(l[3]=e=>U(e))},null,8,["list","get-color","isClickable"])):n("",!0)])):n("",!0),t.allowParty?(r(),c("div",oe,[l[11]||(l[11]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a party",-1)),m(Q,{class:"w-full min-h-[52px] flex flex-col flex-wrap gap-5 items-center !px-1 !py-2 !pb-5 !rounded-primary border border-white"},{default:F(()=>[o("div",ne,[m(L,{class:"w-2/3","input-props":{class:"!placeholder-neutral-600"},name:"partyName",label:"Name",modelValue:g.value,"onUpdate:modelValue":l[4]||(l[4]=e=>g.value=e),type:"text",placeholder:"My Party Name"},null,8,["modelValue"]),m(H,{class:"w-2/3",name:"partyAmount",label:"Size",modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=e=>w.value=e),options:[{value:2,label:"2 players"},{value:3,label:"3 players"},{value:4,label:"4 players"},{value:5,label:"5 players"},{value:10,label:"10 players"}]},null,8,["modelValue"]),m(K,{class:"w-2/3",label:"Create",variant:"green",onClick:T})])]),_:1})])):n("",!0)])])]))}});export{de as _};
