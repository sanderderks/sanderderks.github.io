import{d as J,aR as z,v as L,c as R,s as g,w as I,f as p,o as D,g as n,j as s,m as c,q as r,l as N,h as a,k as b,A as H,P as T,T as K,_ as Q,y as W,C as X,E as Z,I as A,am as ee}from"../bundle.js";import{_ as E,a as F}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-Bw1DkFfV.js";const le={class:"mb-5 flex flex-col items-center"},te={key:0,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},se={key:1,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},ae={key:2,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},re={class:"w-full xl:w-2/3 flex flex-col md:flex-row justify-between"},oe={key:0,class:"w-full flex flex-col items-center"},ne={class:"w-full flex flex-col gap-3 items-center p-5"},ie={class:"w-full flex flex-col items-center"},ue={key:0,class:"w-full flex flex-col gap-3 items-center p-5"},ce={key:1,class:"w-full flex flex-col gap-3 items-center p-5"},de={class:"w-full flex flex-col gap-3 items-center"},xe=J({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(Y,{emit:P}){const y=P,w=z(),k=L(),U=R(),{games:f,gamesLoading:i}=g(w),{onlineUsers:h}=g(k),{firebaseUser:d}=g(U),v=I(""),m=I(3),u=p(()=>{var t;return(t=d.value)==null?void 0:t.uid}),S=p(()=>f.value.filter(t=>t.players.find(l=>l.userId===u.value))),x=p(()=>S.value.filter(t=>!t.maxPlayers)),$=p(()=>h.value.filter(t=>!x.value.some(l=>l.players.some(e=>e.userId===t.id)))),_=p(()=>f.value.filter(t=>!!t.maxPlayers)),C=p(()=>_.value.filter(t=>O(t.id))),V=p(()=>_.value.filter(t=>!O(t.id))),O=t=>{const l=_.value.find(e=>e.id===t);return(l==null?void 0:l.players.find(e=>e.userId===u.value))!==void 0},G=t=>{const l=_.value.find(e=>e.id===t);return l&&l.maxPlayers&&l.players.length<l.maxPlayers||!1},j=t=>{const l=x.value.find(e=>e.players.some(o=>o.userId===t));l?y("continueOnlineGame",l.id):y("createOnlineGame",t)},q=()=>{y("createParty",v.value,m.value)},M=t=>{y("joinParty",t)};return D(async()=>{await w.fetchGames()}),(t,l)=>(s(),n("div",le,[x.value.length?(s(),n("div",te,[l[6]||(l[6]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your 1v1s",-1)),x.value.length?(s(),N(E,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:x.value.flatMap(e=>e.players.filter(o=>{var B;return o.userId!==((B=a(d))==null?void 0:B.uid)}).map(o=>({id:o.userId}))),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[0]||(l[0]=e=>j(e))},null,8,["listOfUsers","get-color","isClickable"])):c("",!0)])):c("",!0),C.value.length?(s(),n("div",se,[l[7]||(l[7]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your parties",-1)),C.value.length?(s(),N(F,{key:0,class:"w-full justify-center !gap-3 !my-0 !py-5 border border-white",list:C.value.map(e=>({id:e.id,label:e.partyName||"Unknown Party"})),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[1]||(l[1]=e=>M(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),!x.value.length&&!C.value.length&&!a(h).filter(e=>e.id!==u.value).length?(s(),n("div",ae,l[8]||(l[8]=[r("h2",{class:"text-center text-nowrap"},"Nobody is online at the moment",-1)]))):c("",!0),r("div",re,[$.value.filter(e=>e.id!==u.value).length?(s(),n("div",oe,[r("div",ne,[l[9]||(l[9]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a 1v1",-1)),b(E,{class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:$.value.filter(e=>e.id!==u.value),"custom-click-action":"","get-color":e=>{var o;return a(i)||e===((o=a(d))==null?void 0:o.uid)?"bg-neutral-500":"bg-green-500"},isClickable:e=>{var o;return!a(i)&&e!==((o=a(d))==null?void 0:o.uid)},onClick:l[2]||(l[2]=e=>j(e))},null,8,["listOfUsers","get-color","isClickable"])])])):c("",!0),r("div",ie,[t.allowParty&&V.value.length?(s(),n("div",ue,[l[10]||(l[10]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Join a party",-1)),V.value.length?(s(),N(F,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",list:V.value.map(e=>({id:e.id,label:e.partyName||"Unknown Party"})),"custom-click-action":"","get-color":e=>a(i)?"bg-neutral-500":G(e)?"bg-green-500":"bg-neutral-500",isClickable:e=>!a(i)&&G(e),onClick:l[3]||(l[3]=e=>M(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),t.allowParty?(s(),n("div",ce,[l[11]||(l[11]=r("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a party",-1)),b(W,{class:"w-full min-h-[52px] flex flex-col flex-wrap gap-5 items-center !px-1 !py-2 !pb-5 !rounded-primary border border-white"},{default:H(()=>[r("div",de,[b(T,{class:"w-2/3","input-props":{class:"!placeholder-neutral-600"},name:"partyName",label:"Name",modelValue:v.value,"onUpdate:modelValue":l[4]||(l[4]=e=>v.value=e),type:"text",placeholder:"My Party Name"},null,8,["modelValue"]),b(K,{class:"w-2/3",name:"partyAmount",label:"Size",modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value=e),options:[{value:2,label:"2 players"},{value:3,label:"3 players"},{value:4,label:"4 players"},{value:5,label:"5 players"},{value:10,label:"10 players"}]},null,8,["modelValue"]),b(Q,{class:"w-2/3",label:"Create",variant:"green",onClick:q})])]),_:1})])):c("",!0)])])]))}}),me={key:0,class:"mt-3 md:ms-10 flex flex-col gap-3"},fe={class:"flex gap-2"},pe={class:"font-bold"},be=J({__name:"GameChat",props:{chats:{}},emits:["sendChat"],setup(Y,{emit:P}){const y=R(),w=L(),{firebaseUser:k}=g(y),{combinedUsers:U}=g(w),f=I(""),i=()=>{if(k.value&&f.value){const d={userId:k.value.uid,message:f.value};h("sendChat",d),f.value=""}},h=P;return(d,v)=>(s(),n("form",{class:"w-full my-10 flex flex-wrap items-center justify-center",action:"",onSubmit:ee(i,["prevent"])},[b(T,{name:"chat",class:"w-full md:w-1/2",inputProps:{autocomplete:"off"},placeholder:"chat...",modelValue:f.value,"onUpdate:modelValue":v[0]||(v[0]=m=>f.value=m)},null,8,["modelValue"]),d.chats.length?(s(),n("div",me,[(s(!0),n(X,null,Z([...d.chats].reverse().filter((m,u)=>u<3),m=>{var u;return s(),n("div",fe,[r("p",pe,A(((u=a(U).find(S=>S.id===m.userId))==null?void 0:u.displayName)??"unknown")+":",1),r("p",null,A(m.message),1)])}),256))])):c("",!0)],32))}});export{xe as _,be as a};
