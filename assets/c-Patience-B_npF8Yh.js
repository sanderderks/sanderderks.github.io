import{u as ie,b as ue,a as se,_ as K}from"./c-Bubble.vue_vue_type_script_setup_true_lang-bYHBWxaz.js";import{bO as Ae,cI as we,cJ as te,bX as Z,aS as U,aQ as Ce,q as C,bC as pe,cK as ae,cP as Ie,cL as Te,cO as Oe,aK as a,u as m,v as f,M as oe,s as S,bH as N,aZ as le,H as $,b9 as Y,at as G,av as De,F as fe,aV as He,bi as e,t as D,bV as Pe,bT as Ne,I as y,b_ as Le,cq as $e}from"../bundle.js";import{_ as Re}from"./c-GameSettingsDialog.vue_vue_type_script_setup_true_lang-BxDvgQjP.js";import{u as Be,H as Me}from"./c-useScoreInfo-CdrYgX0T.js";import{_ as ne}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import{S as ke}from"./c-Spades-CYpo1pQt.js";import"./c-SwitchField.vue_vue_type_script_setup_true_lang-BLC6R9kK.js";import"./c-SelectField.vue_vue_type_script_setup_true_lang-DejAEVFU.js";import"./c-validation-Bf-E2UlI.js";var I=(t=>(t.HEARTS="hearts",t.SPADES="spades",t.DIAMONDS="diamonds",t.CLUBS="clubs",t))(I||{});const ee={hearts:{label:"Hearts",color:"red"},spades:{label:"Spades",color:"black"},diamonds:{label:"Diamonds",color:"red"},clubs:{label:"Clubs",color:"black"}};var p=(t=>(t.STOCK_CLOSED="stock_closed",t.STOCK_OPEN="stock_open",t.PILE1="pile1",t.PILE2="pile2",t.PILE3="pile3",t.PILE4="pile4",t.PILE5="pile5",t.PILE6="pile6",t.PILE7="pile7",t.HEARTS="hearts",t.SPADES="spades",t.DIAMONDS="diamonds",t.CLUBS="clubs",t))(p||{}),b=(t=>(t[t.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",t[t.HAS_STARTED=1]="HAS_STARTED",t[t.HAS_FINISHED=2]="HAS_FINISHED",t))(b||{});const de=()=>{const t=Fe();return Ie(t),{pile1:t.splice(0,1).map(l=>({...l,deck:"pile1"})),pile2:t.splice(0,2).map((l,c)=>c<1?{...l,hidden:!0,deck:"pile2"}:{...l,deck:"pile2"}),pile3:t.splice(0,3).map((l,c)=>c<2?{...l,hidden:!0,deck:"pile3"}:{...l,deck:"pile3"}),pile4:t.splice(0,4).map((l,c)=>c<3?{...l,hidden:!0,deck:"pile4"}:{...l,deck:"pile4"}),pile5:t.splice(0,5).map((l,c)=>c<4?{...l,hidden:!0,deck:"pile5"}:{...l,deck:"pile5"}),pile6:t.splice(0,6).map((l,c)=>c<5?{...l,hidden:!0,deck:"pile6"}:{...l,deck:"pile6"}),pile7:t.splice(0,7).map((l,c)=>c<6?{...l,hidden:!0,deck:"pile7"}:{...l,deck:"pile7"}),stock_closed:t.map(l=>({...l,hidden:!0,deck:"stock_closed"})),stock_open:[],hearts:[],spades:[],diamonds:[],clubs:[]}},re=Ae("patienceStore",()=>{const t=we(te.PATIENCE)(),{personalBest:l,highscorePosition:c}=Z(t),{setPreviousHighscores:h,fetchGameData:R,updateHighscores:B,sortHighscores:u}=t,A=U(0),T=U(0),k=U(0),H=U(0),O=U(0),L=U(),o=Ce(de()),x=C(()=>Object.keys(o).flatMap(s=>o[s])),_=1e3,w=10,M=10,j=C(()=>{const s=k.value%10===0?k.value:Math.floor(k.value/10)*10,d=T.value*w,n=O.value*w,i=s+d+n,E=H.value*M;return Math.max(0,_-(i-E))}),F=C(()=>{const s=Math.floor(k.value/60),d=k.value%60;return`${String(s).padStart(2,"0")}:${String(d).padStart(2,"0")}`}),X=C(()=>o.hearts.length===13&&o.spades.length===13&&o.diamonds.length===13&&o.clubs.length===13);pe(X,()=>{P(),A.value=2,B(j.value,{score:j.value,bonus:H.value,time:k.value,turns:T.value,penalty:O.value}),ae(Te)});const q=()=>{P(),T.value=0,k.value=0,H.value=0,O.value=0,A.value=0,Object.assign(o,de()),t.setPreviousHighscores()},z=()=>{r(),A.value=1},r=()=>{k.value=0,L.value&&P(),L.value=setInterval(()=>{k.value++},1e3)},P=()=>{clearInterval(L.value)},Se=()=>{const s=o.stock_open;s.length&&(s.reverse(),Q(s[0],!1,d=>{d.deck="stock_closed",d.hidden=!0,o.stock_closed.push(d)}),s.splice(0,s.length),V(1))},xe=s=>{const d=x.value.filter(n=>n.selected);if(s.deck==="stock_closed"){const n=o.stock_closed,i=n.indexOf(s),E=i-2;if(i===n.length-1){const g=E<0?0:E;Q(n[g],!1,W=>{W.deck="stock_open",W.hidden=!1,o.stock_open.push(W)}),o.stock_closed.splice(g,3),d.length&&Q(d[0],!1),V(0)}}else if(s.deck==="stock_open"){const n=o.stock_open;n.indexOf(s)===n.length-1&&(s.selected=!s.selected,d.length&&Q(d[0],!1))}else if(d.length){const n=d[0],i=n.deck,E=o[i].indexOf(n);n===s?Q(s,!1):ce(s.deck)&&_e(n,s)?s.value===n.value+1&&(Q(n,!1,g=>{g.deck=s.deck,o[s.deck].push(g)}),o[i].splice(E,d.length),J(i),V(4)):be(s.deck)&&Ee(n,s)&&s.value===n.value-1&&(Q(n,!1,g=>{g.deck=s.deck,o[s.deck].push(g)}),o[i].splice(E,d.length),J(i),V(3))}else Q(s,!0)},ge=s=>{const d=x.value.filter(n=>n.selected);if(d.length){const n=d[0],i=n.deck,E=o[i].indexOf(n);n.value===13&&(Q(n,!1,g=>{g.deck=s,o[s].push(g)}),o[i].splice(E,d.length),J(i),V(i==="stock_open"?2:4))}},he=s=>{const d=x.value.filter(n=>n.selected);if(d.length===1){const n=d[0],i=n.deck,E=n.type,g=o[i].indexOf(n);!o[s].length&&E===s&&n.value===1&&(o[i].splice(g,1),J(i),n.deck=s,n.selected=!1,o[s].push(n),V(3))}},V=s=>{switch(T.value++,s){case 0:{O.value+=2;break}case 1:{O.value+=5;break}case 2:{H.value+=10;break}case 3:{H.value+=20;break}}ae(Oe)},Q=(s,d,n)=>{const i=o[s.deck].indexOf(s);o[s.deck].forEach((E,g)=>{g>=i&&(E.selected=d,n==null||n(E))})},J=s=>{o[s].length&&(o[s][o[s].length-1].hidden=!1)},_e=(s,d)=>s.color!==d.color,Ee=(s,d)=>s.type===d.type,ce=s=>["pile1","pile2","pile3","pile4","pile5","pile6","pile7"].includes(s),be=s=>["hearts","spades","diamonds","clubs"].includes(s);return{gameStatus:A,score:j,turns:T,cards:o,allCards:x,formattedTime:F,personalBest:l,highscorePosition:c,$reset:q,isPlayDeck:ce,start:z,shuffle:Se,selectCard:xe,selectEmptyDeck:ge,selectFinalDeck:he,setPreviousHighscores:h,fetchGameData:R,updateHighscores:B,sortHighscores:u}},{persist:{enabled:!0}}),Fe=()=>Object.keys(ee).flatMap(t=>{const l=t,c=[];for(let h=0;h<13;h++){const R={type:l,label:ee[l].label,color:ee[l].color,value:h+1,hidden:!1,selected:!1};c.push(R)}return c}),Qe={},je={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function Ke(t,l){return a(),m("svg",je,l[0]||(l[0]=[f("path",{d:"M50 35 Q40 25 50 15 Q60 25 50 35 Z M35 50 Q25 40 35 30 Q45 40 35 50 Z M65 50 Q75 40 65 30 Q55 40 65 50 Z M50 40 Q65 55 50 65 Q35 55 50 40 Z M45 65 Q45 80 55 80 Q55 65 45 65 Z",fill:"black"},null,-1)]))}const me=ne(Qe,[["render",Ke]]),Ue={},Ve={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function Ge(t,l){return a(),m("svg",Ve,l[0]||(l[0]=[f("polygon",{points:"50,10 80,50 50,90 20,50",fill:"red"},null,-1)]))}const ye=ne(Ue,[["render",Ge]]),Ze={},qe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"100",height:"100"};function ze(t,l){return a(),m("svg",qe,l[0]||(l[0]=[f("path",{d:"M50 70 Q20 50 20 30 Q20 10 40 10 Q50 10 50 20 Q50 10 60 10 Q80 10 80 30 Q80 50 50 70 Z",fill:"red"},null,-1)]))}const ve=ne(Ze,[["render",ze]]),Je={key:0,class:"w-full h-full flex justify-center"},Ye={key:1,class:"relative w-full flex"},Xe={class:"relative flex text-xs md:text-md lg:text-lg font-bold"},We=oe({__name:"Card",props:{card:{},index:{}},emits:["select"],setup(t,{emit:l}){const c=t,h=l,B=ie(ue).greaterOrEqual("lg"),u=re(),{cards:A}=Z(u),{isPlayDeck:T}=u,k=C(()=>{if(c.card.hidden)return"";switch(c.card.value){case 13:return"K";case 12:return"Q";case 11:return"J";case 1:return"A";default:return`${c.card.value}`}}),H=C(()=>c.card.hidden?"text-primary":c.card.color==="black"?"text-black":"text-red-500"),O=C(()=>c.index===A.value[c.card.deck].length-1),L=C(()=>O.value||!c.card.hidden),o=C(()=>T(c.card.deck)||B.value&&c.card.deck===p.STOCK_CLOSED),x=C(()=>T(c.card.deck)?20:10),_={[I.HEARTS]:ve,[I.SPADES]:ke,[I.DIAMONDS]:ye,[I.CLUBS]:me};return(w,M)=>(a(),S(se,{class:G(["z-10 absolute h-[90px] w-[40px] xs:h-[100px] xs:w-[50px] sm:h-[110px] sm:w-[60px] lg:h-[120px] lg:w-[80px] !p-1 !pt-0 bg-opacity-100 !rounded-primary flex justify-center border border-white",[H.value,w.card.hidden?"bg-violet-950":"bg-neutral-300",w.card.selected?"border-[3px] !border-red-600":"!border-black"]]),style:De({top:o.value?`${x.value*w.index}px`:0}),"title-props":{class:"text-xl"},clickable:L.value,onClick:M[0]||(M[0]=j=>h("select"))},{fullControl:N(()=>[w.card.hidden?(a(),m("div",Je,M[1]||(M[1]=[f("div",{class:"flex flex-col justify-center"},[f("p",{class:"mb-2 text-xs md:text-md lg:text-lg text-neutral-300"},"?")],-1)]))):(a(),m("div",Ye,[f("div",Xe,[(a(),S(le(_[w.card.type]),{class:"mt-[5px] sm:mt-[1px] h-[10px] w-[10px] sm:h-[20px] sm:w-[20px] md:h-[25px] md:w-[25px]"})),$(" "+Y(k.value),1)]),(a(),S(le(_[w.card.type]),{class:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[25px] sm:w-[35px] md:w-[50px]"}))]))]),_:1},8,["class","style","clickable"]))}}),v=oe({__name:"CardDeck",props:{deckType:{},cardType:{}},setup(t){const l=t,c=re(),{cards:h}=Z(c),{shuffle:R,selectCard:B,selectEmptyDeck:u,selectFinalDeck:A}=c,T={[I.HEARTS]:ve,[I.SPADES]:ke,[I.DIAMONDS]:ye,[I.CLUBS]:me},k=C(()=>h.value[l.deckType]),H=C(()=>!k.value.length&&!l.cardType),O=C(()=>H.value&&l.deckType!==p.STOCK_OPEN),L=()=>{O.value&&u(l.deckType)};return(o,x)=>(a(),m("div",{class:G(["relative h-[90px] w-[40px] xs:h-[100px] xs:w-[50px] sm:h-[110px] sm:w-[60px] lg:h-[120px] lg:w-[80px]",{"border border-neutral-500":k.value.length===0,"cursor-pointer":O.value}]),onClick:L},[k.value.length?(a(!0),m(fe,{key:0},He(k.value,(_,w)=>(a(),S(We,{key:`${_.type}.s${_.value}`,card:_,index:w,onSelect:M=>e(B)(_)},null,8,["card","index","onSelect"]))),128)):o.cardType?(a(),S(le(T[o.cardType]),{key:1,class:"absolute left-1/2 transform -translate-x-1/2 w-[50px] cursor-pointer",onClick:x[0]||(x[0]=_=>e(A)(o.deckType))})):o.deckType===e(p).STOCK_CLOSED?(a(),m("div",{key:2,class:"w-full h-full flex justify-center",onClick:x[1]||(x[1]=(..._)=>e(R)&&e(R)(..._))},x[2]||(x[2]=[f("div",{class:"flex flex-col justify-center"},[f("p",{class:"text-neutral-300 text-xs md:text-md lg:text-lg mb-2"},"Shuffle")],-1)]))):D("",!0)],2))}}),es={class:"flex justify-center"},ss={key:0,class:"w-full flex flex-wrap gap-3 justify-center"},ts={key:1,class:"w-full flex flex-col gap-3"},ls={class:"my-3"},os={key:0,class:"w-full grid grid-cols-4 gap-1 justify-items-center"},ns={key:1,class:"text-center text-xl md:text-3xl font-bold"},rs={key:0,class:"text-blue-500 font-bold"},cs={key:1,class:"text-blue-500 font-bold"},as={key:2,class:"text-blue-500 font-bold"},ds={key:3,class:"text-blue-500 font-bold"},is={class:"mt-5 flex flex-wrap gap-3 justify-center"},us={key:0,class:"flex flex-wrap gap-3 mt-3 justify-center"},hs=oe({__name:"Patience",setup(t){const l=ie(ue),c=l.greaterOrEqual("md"),h=l.greaterOrEqual("lg"),R=Ne(),B=re(),{gameStatus:u,score:A,turns:T,formattedTime:k,personalBest:H}=Z(B),{currentHighscorePosition:O,hasImprovedHighscorePosition:L,hasImprovedPersonalBest:o}=Be(te.PATIENCE),{start:x,$reset:_,updateHighscores:w}=B,{firebaseUser:M}=Z(Pe()),j=U(!1),F=U(!1),X=()=>{F.value=!1,x()},q=()=>{F.value=!1,_()};return pe(u,z=>{b.HAS_FINISHED}),(z,r)=>(a(),S(se,{class:"!bg-cyan-800 !bg-opacity-50 my-5 !rounded-secondary",title:"Patience",description:"Play solo."},{right:N(()=>[y(K,{class:"border-none h-fit",type:"neutral",icon:"pi pi-cog",onClick:r[0]||(r[0]=P=>j.value=!0)})]),default:N(()=>[f("div",es,[e(u)===e(b).HAS_NOT_STARTED?(a(),m("div",ss,[y(K,{class:"w-full md:w-1/2",onClick:X},{default:N(()=>r[7]||(r[7]=[$(" Start ")])),_:1})])):e(u)!==e(b).HAS_FINISHED?(a(),m("div",ts,[f("div",ls,[f("p",null,"Time: "+Y(e(k)),1),f("p",null,"Turns: "+Y(e(T)),1),f("p",null,"Score: "+Y(e(A)),1)]),e(c)?D("",!0):(a(),m("div",os,[y(v,{class:"col-start-2","deck-type":e(p).STOCK_OPEN},null,8,["deck-type"]),y(v,{"deck-type":e(p).STOCK_CLOSED},null,8,["deck-type"])])),f("div",{class:G(["w-full grid gap-1 justify-items-center",e(h)?"grid-cols-8":e(c)?"grid-cols-7":"grid-cols-4"])},[e(c)?(a(),m(fe,{key:0},[y(v,{"deck-type":e(p).STOCK_OPEN},null,8,["deck-type"]),e(h)?D("",!0):(a(),S(v,{key:0,"deck-type":e(p).STOCK_CLOSED},null,8,["deck-type"])),r[8]||(r[8]=f("div",null,null,-1))],64)):D("",!0),y(v,{"deck-type":e(p).HEARTS,"card-type":e(I).HEARTS},null,8,["deck-type","card-type"]),y(v,{"deck-type":e(p).SPADES,"card-type":e(I).SPADES},null,8,["deck-type","card-type"]),y(v,{"deck-type":e(p).DIAMONDS,"card-type":e(I).DIAMONDS},null,8,["deck-type","card-type"]),y(v,{"deck-type":e(p).CLUBS,"card-type":e(I).CLUBS},null,8,["deck-type","card-type"])],2),f("div",{class:G(["w-full grid gap-1 justify-items-center",e(h)?"grid-cols-8":"grid-cols-7"])},[e(h)?(a(),S(v,{key:0,"deck-type":e(p).STOCK_CLOSED},null,8,["deck-type"])):D("",!0),y(v,{"deck-type":e(p).PILE1},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE2},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE3},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE4},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE5},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE6},null,8,["deck-type"]),y(v,{"deck-type":e(p).PILE7},null,8,["deck-type"])],2)])):D("",!0)]),F.value?(a(),S(Me,{key:0,"game-id":e(te).PATIENCE},null,8,["game-id"])):e(u)===e(b).HAS_FINISHED?(a(),m("div",ns,[e(L)&&e(O)===1?(a(),m("p",rs," HIGHSCORE! ")):e(L)?(a(),m("p",cs," LEADERBOARD IMPROVEMENT! ")):e(o)?(a(),m("p",as," PERSONAL BEST! ")):e(o)?(a(),m("p",ds," PERSONAL BEST! ")):D("",!0)])):D("",!0),f("div",{class:G(["flex flex-col",{"h-[50vh] justify-end":e(u)===e(b).HAS_STARTED}])},[f("div",is,[e(u)!==e(b).HAS_NOT_STARTED&&e(u)!==e(b).HAS_FINISHED?(a(),S(K,{key:0,class:"w-full md:w-1/2",type:"neutral",onClick:q},{default:N(()=>r[9]||(r[9]=[$(" Restart ")])),_:1})):e(u)===e(b).HAS_FINISHED?(a(),S(K,{key:1,class:"w-full md:w-1/2",type:"secondary",onClick:q},{default:N(()=>r[10]||(r[10]=[$(" Play Again ")])),_:1})):D("",!0),!F.value&&(e(u)===e(b).HAS_NOT_STARTED||e(u)===e(b).HAS_FINISHED)?(a(),S(K,{key:2,class:"w-full md:w-1/2",type:"neutral",onClick:r[1]||(r[1]=P=>F.value=!0)},{default:N(()=>r[11]||(r[11]=[$(" View Highscores ")])),_:1})):e(u)===e(b).HAS_NOT_STARTED?(a(),S(K,{key:3,class:"w-full md:w-1/2",type:"neutral",onClick:r[2]||(r[2]=P=>F.value=!1)},{default:N(()=>r[12]||(r[12]=[$(" Go Back ")])),_:1})):e(u)===e(b).HAS_FINISHED?(a(),S(K,{key:4,class:"w-full md:w-1/2",type:"neutral",onClick:r[3]||(r[3]=P=>F.value=!1)},{default:N(()=>r[13]||(r[13]=[$(" View Your Score ")])),_:1})):D("",!0)]),e(u)===e(b).HAS_FINISHED?(a(),m("div",us,[e(M)?e(A)&&e(H)<e(A)?(a(),S(K,{key:1,class:"w-full md:w-1/2",type:"primary",onClick:r[5]||(r[5]=P=>e(w)(e(A)))},{default:N(()=>r[16]||(r[16]=[$(" Add To Leaderboard ")])),_:1})):D("",!0):(a(),S(se,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:N(()=>[r[14]||(r[14]=$(" Please ")),f("a",{class:"cursor-pointer",onClick:r[4]||(r[4]=P=>e(R).push({name:e(Le).LOGIN,params:{redirect:JSON.stringify({name:e($e).GAMES_PATIENCE})}}))}," Login "),r[15]||(r[15]=$(" to add your score to the leaderboard. "))]),_:1}))])):D("",!0)],2),y(Re,{"is-open":j.value,"onUpdate:isOpen":r[6]||(r[6]=P=>j.value=P)},null,8,["is-open"])]),_:1}))}});export{hs as default};
