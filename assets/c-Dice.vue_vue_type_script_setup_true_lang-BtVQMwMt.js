import{aW as Re,bl as xe,c as Pe,aX as Ve,aR as Ye,s as D,bm as Be,bn as J,aS as b,w as _,aQ as m,a9 as Ue,f,o as ze,L as x,b0 as Ze,b1 as We,aY as G,b2 as Me,a$ as K,aq as Xe,aZ as je,d as N,g as H,j as g,q as n,l as qe,aT as ye,h as P,z as Qe}from"../bundle.js";import{_ as Je}from"./c-Dice6.vue_vue_type_script_setup_true_lang-CbzU1YFL.js";var Ke=(l=>(l[l.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",l[l.FINDING_OPPONENT=1]="FINDING_OPPONENT",l[l.HAS_STARTED=2]="HAS_STARTED",l[l.HAS_THROWN_DICES=3]="HAS_THROWN_DICES",l[l.HAS_CHOSEN_DICES=4]="HAS_CHOSEN_DICES",l[l.HAS_FINISHED=5]="HAS_FINISHED",l))(Ke||{}),el=(l=>(l[l.ONES=0]="ONES",l[l.TWOS=1]="TWOS",l[l.THREES=2]="THREES",l[l.FOURS=3]="FOURS",l[l.FIVES=4]="FIVES",l[l.SIXES=5]="SIXES",l[l.THREE_OF_A_KIND=6]="THREE_OF_A_KIND",l[l.FOUR_OF_A_KIND=7]="FOUR_OF_A_KIND",l[l.FULL_HOUSE=8]="FULL_HOUSE",l[l.SMALL_STRAIGHT=9]="SMALL_STRAIGHT",l[l.LARGE_STRAIGHT=10]="LARGE_STRAIGHT",l[l.YAHTZEE=11]="YAHTZEE",l[l.CHANCE=12]="CHANCE",l))(el||{}),te=(l=>(l[l.PLAYER=0]="PLAYER",l[l.OPPONENT=1]="OPPONENT",l))(te||{});const ee=()=>({0:[],1:[]}),ll=Re("yahtzeeStore",()=>{const l=xe(),s=Pe(),r=Ve(),p=Ye(),{personalBest:L,highscorePosition:O}=D(r),{firebaseUser:E}=D(s),{onlineGames:V,onlineGamesLoading:oe,onlineGameId:se,onlineGameCreatorId:ie,onlineGameOpponentId:Y,onlineGameOpponentActive:ne,onlineGameChat:ae,isInitializingOnlineGame:B,isOnlineGameOwner:U,onlineGameOpponentName:re}=D(p),{fetchOnlineGames:ce,createOnlineGame:ue,continueOnlineGame:fe,updateOnlineGame:ve,leaveOnlineGame:he,deleteOnlineGame:_e}=p,{setPreviousHighscores:z,updateHighscores:de,sortHighscores:me}=r,pe={onlineGames:Be(l,J.GAME_DATA,b.YAHTZEE,J.ONLINE_GAMES)},d=_(m.SOLO),c=_(0),I=_(!1),v=_(0),A=_(null),w=_(null),T=_(0),Z=_(0),h=_(-1),a=_(le()),u=Ue(ee()),C=f(()=>a.value.some(e=>e.isRolling)),ge=f(()=>h.value===-1&&!a.value.every(e=>e.selected)),Oe=f(()=>h.value>=0&&h.value<2&&!a.value.every(e=>e.selected)),Ee=f(()=>e=>a.value.filter(t=>t.value===e).length),Ae=f(()=>y(3)),Te=f(()=>y(4)),Se=f(()=>F(2)&&F(3)?S[8].trueValue??!1:!1),Ne=f(()=>Q(4)?S[9].trueValue??!1:!1),He=f(()=>Q(5)?S[10].trueValue??!1:!1),W=f(()=>F(5)?S[11].trueValue??!1:!1),Ie=f(()=>{let e=0;return a.value.forEach(t=>{e+=t.value}),e}),$=f(()=>(e,t=0)=>{let o=0;return u[t].filter(i=>S[i.row].section===e).forEach(i=>{i.value!==!1&&(o+=i.value)}),o});ze(()=>{r.$init(b.YAHTZEE)}),x(u,e=>{e[0].length===13&&(d.value===m.SOLO||e[1].length===13)&&(c.value=5)},{deep:!0}),x(c,e=>{if(e===5){const t=o=>{let i=$.value("top",o);i>=63&&(o===0?T.value+=35:Z.value+=35),i+=$.value("bottom",o),i+=T.value,o===0?A.value=i:w.value=i};t(0),d.value===m.ONLINE?(t(1),(A.value??0)>(w.value??0)&&R()):R(),G(je)}}),x([c,v,C],()=>{d.value===m.ONLINE&&(console.log("CHANGE IN LOCAL DATA DETECTED",c.value,v.value,C.value),M())},{deep:!0});const k=()=>{p.$reset(),d.value=m.SOLO,c.value=0,I.value=!1,v.value=0,A.value=null,T.value=0,h.value=-1,a.value=le(),Object.assign(u,ee()),z()},Ce=e=>{E.value&&(d.value=m.ONLINE,c.value=2,p.$init(b.YAHTZEE,j,X,k),ue(e))},be=e=>{d.value=m.ONLINE,p.$init(b.YAHTZEE,j,X,k),fe(e)},M=()=>{console.log("updateOnlineGameCustom.1"),!(!E.value||!Y.value||v.value===1&&!I.value&&!B.value)&&(console.log("updateOnlineGameCustom.2"),ve())},X=(e,t)=>({gameStatus:c.value,activePlayer:v.value===0?e:t,dices:a.value,score:{[e]:u[0],[t]:u[1]}}),j=e=>{var o;console.log("updateLocalGameState.1");const t=(o=E.value)==null?void 0:o.uid;!t||v.value===0&&!B.value||(console.log("updateLocalGameState.2"),c.value=e.gameStatus,v.value=e.activePlayer===t?0:1,a.value=e.dices,U.value?(u[0]=e.score[e.creatorId],u[1]=e.score[e.opponentId]):(u[0]=e.score[e.opponentId],u[1]=e.score[e.creatorId]))},q=async()=>{for(;C.value;)await new Promise(e=>setTimeout(e,r.diceRollSpeed*1e3));return!0},y=e=>{for(let t=1;t<=6;t++)if(a.value.filter(o=>o.value===t).length>=e){let o=0;return a.value.forEach(i=>{o+=i.value}),o}return!1},F=e=>{for(let t=1;t<=6;t++)if(a.value.filter(o=>o.value===t).length===e)return!0;return!1},Q=e=>{let t=0,o=e;do{e:for(let i=o-e+1;i<=o;i++)if(a.value.some(Fe=>Fe.value===i))t++;else break e;if(t===e)return!0;t=0,o++}while(o<=6);return!1},Ge=()=>{c.value=2},De=async()=>{const e=r.diceRollSpeed*1e3;h.value++,a.value.forEach(t=>{t.selected||(t.isRolling=!0,setTimeout(()=>{t.value=Ze(6),t.isRolling=!1,h.value===2&&(t.selected=!0),a.value.sort((o,i)=>o.value-i.value)},We(e,e/3)))}),await q(),c.value=3,G(Me)},Le=(e,t=0)=>u[t].find(o=>o.row===e),we=(e,t)=>{let o=t;if(o===!1)return!1;const i=S[e];return i.multiplier?o*=i.multiplier:i.trueValue&&(o=i.trueValue),o},$e=e=>{v.value===0&&h.value>=0&&h.value<2&&(e.selected=!e.selected,G(K))},ke=(e,t)=>{if(!C.value){if(t!==!1&&W.value){const o=u[0].find(i=>i.row===11);o&&o.value!==!1&&(T.value+=100)}u[0].push({row:e,value:t}),h.value=-1,a.value.forEach(o=>{o.selected=!1}),G(K),d.value===m.ONLINE&&(I.value=!0,c.value=4,setTimeout(async()=>{c.value=2,v.value=1,await Xe(),I.value=!1},r.diceRollSpeed*1e3))}},R=()=>{A.value&&de({score:A.value,bonus:T.value})};return{collections:pe,onlineGames:V,onlineGamesLoading:oe,onlineGameId:se,onlineGameCreatorId:ie,onlineGameOpponentId:Y,onlineGameOpponentActive:ne,onlineGameChat:ae,isOnlineGameOwner:U,onlineGameOpponentName:re,gameType:d,gameStatus:c,gameStatusLoading:I,activePlayer:v,score:u,finalScore:A,finalScoreOpponent:w,bonus:T,bonusOpponent:Z,reroll:h,dices:a,isRolling:C,canRoll:ge,canReroll:Oe,hasOfValue:Ee,hasThreeOfAKind:Ae,hasFourOfAKind:Te,hasFullHouse:Se,hasSmallStraight:Ne,hasLargeStraight:He,hasYahtzee:W,diceTotal:Ie,scoreTotalOf:$,personalBest:L,highscorePosition:O,$reset:k,start:Ge,roll:De,hasFinishedRolling:q,getScore:Le,getActualValue:we,selectDice:$e,selectScore:ke,setPreviousHighscores:z,updateYahtzeeHighscore:R,sortHighscores:me,fetchOnlineGames:ce,createOnlineGame:Ce,continueOnlineGame:be,updateOnlineGame:M,leaveOnlineGame:he,deleteOnlineGame:_e}},{persist:{enabled:!0}}),le=()=>[{id:1,value:1,selected:!1,isRolling:!1},{id:2,value:2,selected:!1,isRolling:!1},{id:3,value:3,selected:!1,isRolling:!1},{id:4,value:4,selected:!1,isRolling:!1},{id:5,value:5,selected:!1,isRolling:!1}],S={0:{title:"Ones",section:"top"},1:{title:"Twos",section:"top",multiplier:2},2:{title:"Threes",section:"top",multiplier:3},3:{title:"Fours",section:"top",multiplier:4},4:{title:"Fives",section:"top",multiplier:5},5:{title:"Sixes",section:"top",multiplier:6},6:{title:"Three of a Kind",section:"bottom"},7:{title:"Four of a Kind",section:"bottom"},8:{title:"Full House",section:"bottom",trueValue:25},9:{title:"Small Straight",section:"bottom",trueValue:30},10:{title:"Large Straight",section:"bottom",trueValue:40},11:{title:"Yahtzee",section:"bottom",trueValue:50},12:{title:"Chance",section:"bottom"}},tl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},ol=["fill"],sl=["fill"],il=N({__name:"Dice1",props:{color:{},backgroundColor:{}},setup(l){return(s,r)=>(g(),H("svg",tl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,ol),n("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,sl)]))}}),nl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},al=["fill"],rl=["fill"],cl=["fill"],ul=N({__name:"Dice2",props:{color:{},backgroundColor:{}},setup(l){return(s,r)=>(g(),H("svg",nl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,al),n("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,rl),n("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,cl)]))}}),fl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},vl=["fill"],hl=["fill"],_l=["fill"],dl=["fill"],ml=N({__name:"Dice3",props:{color:{},backgroundColor:{}},setup(l){return(s,r)=>(g(),H("svg",fl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,vl),n("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,hl),n("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,_l),n("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,dl)]))}}),pl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},gl=["fill"],Ol=["fill"],El=["fill"],Al=["fill"],Tl=["fill"],Sl=N({__name:"Dice4",props:{color:{},backgroundColor:{}},setup(l){return(s,r)=>(g(),H("svg",pl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,gl),n("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,Ol),n("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,El),n("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,Al),n("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,Tl)]))}}),Nl={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Hl=["fill"],Il=["fill"],Cl=["fill"],bl=["fill"],Gl=["fill"],Dl=["fill"],Ll=N({__name:"Dice5",props:{color:{},backgroundColor:{}},setup(l){return(s,r)=>(g(),H("svg",Nl,[n("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Hl),n("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,Il),n("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,Cl),n("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,bl),n("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,Gl),n("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,Dl)]))}}),kl=N({__name:"Dice",props:{dice:{}},setup(l){const s=ll(),{activePlayer:r}=D(s),{selectDice:p}=s,L={1:il,2:ul,3:ml,4:Sl,5:Ll,6:Je};return(O,E)=>(g(),H("div",{class:Qe(["cursor-pointer",{"animate-spin":O.dice.isRolling}])},[(g(),qe(ye(L[O.dice.value]),{color:"black",backgroundColor:O.dice.selected?P(r)===P(te).PLAYER?"#2563eb":"#e11d48":"white",width:"40",height:"40",onClick:E[0]||(E[0]=V=>P(p)(O.dice))},null,8,["backgroundColor"]))],2))}});export{Ke as G,te as P,el as S,kl as _,S as s,ll as u};
