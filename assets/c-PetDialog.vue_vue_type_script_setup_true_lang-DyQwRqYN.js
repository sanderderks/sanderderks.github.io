import{_ as K,a as le}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-C6J-GyL9.js";import{D as B}from"./c-DateField-CWvNIfkF.js";import{_ as te}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-DbzAxtwG.js";import{_ as c}from"./c-SelectField.vue_vue_type_script_setup_true_lang-BanvuRMQ.js";import{_ as h}from"./c-TextField.vue_vue_type_script_setup_true_lang-aj-wueri.js";import{e as _,r as d,c as p,l as D,m as oe,n as t,k as i,p as m,h as ie,av as de,s as T,a as ne,M as se,q as P,D as u,aw as ue,ax as me,t as W,ay as ge,y as ve,H as fe,az as pe,aF as we,b as be}from"../bundle.js";import{R as F}from"./c-validation-DokkLKHB.js";import{s as V,a as H}from"./c-accordiontab.esm-CX-DBziB.js";import{_ as J}from"./c-Bubble.vue_vue_type_script_setup_true_lang-BShtm6_i.js";import{D as ye}from"./c-vuedraggable.umd-CzRFyTns.js";const Ve={class:"md:px-5"},he={class:"mt-3 flex justify-evenly font-bold"},De=_({__name:"PetLogDialogSection",props:{id:{},log:{}},emits:["error","delete"],setup(O,{expose:U,emit:s}){const w=s,b=d(),g=d(),v=d(),f=d(),k=p(()=>[v.value,f.value].some(e=>!!e));return U({test:async()=>{var e,o;await Promise.all([(e=b.value)==null?void 0:e.test(),(o=g.value)==null?void 0:o.test()]),w("error",k.value)}}),(e,o)=>(D(),oe("div",Ve,[t(B,{ref_key:"dateField",ref:b,id:e.id,name:"logDate",label:"Date",modelValue:e.log.date,"onUpdate:modelValue":o[0]||(o[0]=n=>e.log.date=n),error:v.value,"onUpdate:error":o[1]||(o[1]=n=>v.value=n),"without-time":""},null,8,["id","modelValue","error"]),t(h,{ref_key:"weightField",ref:g,id:e.id,name:"logWeight",label:"Weight (kg)","model-value":`${e.log.weight}`,"onUpdate:modelValue":o[2]||(o[2]=n=>e.log.weight=Number(n)),error:f.value,"onUpdate:error":o[3]||(o[3]=n=>f.value=n),rules:[i(F).Required,i(F).Numeric],"min-value":0,"input-props":{type:"number"}},null,8,["id","model-value","error","rules"]),m("div",he,[t(J,{class:"w-full sm:w-2/3 md:w-1/2 xl:w-2/3",type:"danger",outlined:"",label:"Delete",onClick:o[4]||(o[4]=n=>e.$emit("delete"))})])]))}}),Fe={class:"pt-6 mb-4 xl:px-16"},Ue={class:"flex gap-5"},ke={class:"mt-3 flex justify-center"},Ce={class:"basis-full lg:basis-1/2"},Ee=_({__name:"PetDialog",props:{isOpen:{type:Boolean},originalPet:{}},emits:["close"],setup(O,{emit:U}){const s=O,w=U,b=ie(),g=de(),{isMutationLoading:v}=T(g),{firebaseUser:f}=T(b),{mutatePet:k}=g,C=a=>({name:{value:(a==null?void 0:a.name)??"",error:""},avatar:{value:(a==null?void 0:a.avatar)??"",error:""},dateOfBirth:{value:a!=null&&a.dateOfBirth?new Date(a.dateOfBirth):null,error:""},type:{value:(a==null?void 0:a.type)??"cat",error:""},breed:{value:(a==null?void 0:a.breed)??"",error:""},breedSize:{value:(a==null?void 0:a.breedSize)??"medium",error:""},gender:{value:(a==null?void 0:a.gender)??"male",error:""},weight:{value:a!=null&&a.weight?a.weight.toString():"",error:""},insideCat:{value:(a==null?void 0:a.insideCat)??!1,error:""},castrated:{value:(a==null?void 0:a.castrated)??!1,error:""},dewormingDate:{value:a!=null&&a.dewormingDate?new Date(a.dewormingDate):null,error:""},weightLog:{value:a!=null&&a.weightLog?a.weightLog.map(r=>({...r,date:new Date(r.date)})):[],error:{}}}),e=ne(C(s.originalPet)),o=p(()=>{var a,r;return{name:e.name.value,userId:((a=s.originalPet)==null?void 0:a.userId)??((r=f.value)==null?void 0:r.uid)??"",avatar:e.avatar.value,dateOfBirth:e.dateOfBirth.value??null,type:e.type.value,breed:e.breed.value,breedSize:e.breedSize.value,gender:e.gender.value,weight:isNaN(+e.weight.value)?null:+e.weight.value,insideCat:e.type.value==="cat"?e.insideCat.value:null,castrated:e.castrated.value,dewormingDate:e.dewormingDate.value??null,weightLog:e.weightLog.value}}),n=d(),L=d(),z=d(),$=d(),N=d(),x=d(),E=d(),I=d(),R=d(),j=d(),q=d(),Q=d([]),S=p(()=>s.originalPet?we.convert(s.originalPet):null),M=p(()=>!be(S.value,o.value)),A=p(()=>{if(e.name.value)return e.name.value;switch(e.type.value){case"cat":return"Cat";case"dog":return"Dog";default:return"Pet"}}),X=async()=>{var a,r,l;await Promise.all([n.value.test(),L.value.test(),z.value.test(),$.value.test(),N.value.test(),(a=x.value)==null?void 0:a.test(),E.value.test(),I.value.test(),(r=R.value)==null?void 0:r.test(),j.value.test(),q.value.test()]),!(e.name.error||e.avatar.error||e.dateOfBirth.error||e.type.error||e.breed.error||e.breedSize.error||e.gender.error||e.weight.error||e.insideCat.error||e.castrated.error||e.dewormingDate.error)&&(await k(o.value,(l=s.originalPet)==null?void 0:l.id),w("close"))},Y=()=>{e.weightLog.value.push({date:new Date,weight:0})},G=a=>e.weightLog.value.findIndex(r=>r.date.toString()===a),Z=a=>{e.weightLog.value.splice(G(a),1)},ee=(a,r)=>{e.weightLog.error[G(r)]=a},re=()=>{w("close")};return se(()=>[s.isOpen,s.originalPet],()=>{Object.assign(e,C(s.originalPet))}),(a,r)=>(D(),P(le,{isOpen:a.isOpen,title:S.value?"Update Pet":"Create Pet",description:"Keep in mind that pet data is visible to all authenticated users.","confirm-text":S.value?M.value?"Update":"Nothing changed":"Create","confirm-loading":i(v),"confirm-props":{disabled:!M.value},onConfirm:X,onCancel:re},{default:u(()=>[m("form",Fe,[t(h,{ref_key:"nameField",ref:n,id:"name",name:"name",label:"Name",placeholder:"Mogu",modelValue:e.name.value,"onUpdate:modelValue":r[0]||(r[0]=l=>e.name.value=l),error:e.name.error,"onUpdate:error":r[1]||(r[1]=l=>e.name.error=l),rules:[i(F).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),t(i(H),null,{default:u(()=>[t(i(V),{header:`${A.value}'s Details`},{default:u(()=>[t(B,{ref_key:"dateOfBirthField",ref:z,name:"dateOfBirth",label:"Date of birth",modelValue:e.dateOfBirth.value,"onUpdate:modelValue":r[2]||(r[2]=l=>e.dateOfBirth.value=l),error:e.dateOfBirth.error,"onUpdate:error":r[3]||(r[3]=l=>e.dateOfBirth.error=l),"without-time":""},null,8,["modelValue","error"]),t(c,{ref_key:"typeField",ref:$,name:"type",label:"Type",modelValue:e.type.value,"onUpdate:modelValue":r[4]||(r[4]=l=>e.type.value=l),error:e.type.error,"onUpdate:error":r[5]||(r[5]=l=>e.type.error=l),options:i(ue)},null,8,["modelValue","error","options"]),t(h,{ref_key:"breedField",ref:N,id:"breed",name:"breed",label:"Breed",placeholder:e.type.value==="dog"?"Golden Retriever":"Maine Coone",modelValue:e.breed.value,"onUpdate:modelValue":r[6]||(r[6]=l=>e.breed.value=l),error:e.breed.error,"onUpdate:error":r[7]||(r[7]=l=>e.breed.error=l),"min-length":3,"max-length":50},null,8,["placeholder","modelValue","error"]),e.type.value==="dog"?(D(),P(c,{key:0,ref_key:"breedSizeField",ref:x,name:"breedSize",label:"Breed Size",modelValue:e.breedSize.value,"onUpdate:modelValue":r[8]||(r[8]=l=>e.breedSize.value=l),error:e.breedSize.error,"onUpdate:error":r[9]||(r[9]=l=>e.breedSize.error=l),options:i(me)},null,8,["modelValue","error","options"])):W("",!0),t(c,{ref_key:"genderField",ref:E,name:"gender",label:"Gender",modelValue:e.gender.value,"onUpdate:modelValue":r[10]||(r[10]=l=>e.gender.value=l),error:e.gender.error,"onUpdate:error":r[11]||(r[11]=l=>e.gender.error=l),options:i(ge)},null,8,["modelValue","error","options"])]),_:1},8,["header"]),t(i(V),{header:`${A.value}'s Health`},{default:u(()=>[t(h,ve({ref_key:"weightField",ref:I,name:"weight",label:"Weight (kg)",modelValue:e.weight.value,"onUpdate:modelValue":r[12]||(r[12]=l=>e.weight.value=l),error:e.weight.error,"onUpdate:error":r[13]||(r[13]=l=>e.weight.error=l)},e.weight.value?{rules:[i(F).Numeric],minValue:0}:void 0,{"input-props":{type:"number"}}),null,16,["modelValue","error"]),e.type.value==="cat"?(D(),P(K,{key:0,ref_key:"insideCatField",ref:R,name:"insideCat",label:"Inside Cat",modelValue:e.insideCat.value,"onUpdate:modelValue":r[14]||(r[14]=l=>e.insideCat.value=l)},null,8,["modelValue"])):W("",!0),t(K,{ref_key:"castratedField",ref:j,name:"castrated",label:"Castrated or Sterilized",modelValue:e.castrated.value,"onUpdate:modelValue":r[15]||(r[15]=l=>e.castrated.value=l)},null,8,["modelValue"]),t(B,{ref_key:"dewormingDateField",ref:q,name:"dewormingDate",label:"Last deworming date",modelValue:e.dewormingDate.value,"onUpdate:modelValue":r[16]||(r[16]=l=>e.dewormingDate.value=l),error:e.dewormingDate.error,"onUpdate:error":r[17]||(r[17]=l=>e.dewormingDate.error=l),"without-time":""},null,8,["modelValue","error"])]),_:1},8,["header"]),t(i(V),{header:"Log"},{default:u(()=>[t(i(ye),{ref:"draggable",modelValue:e.weightLog.value,"onUpdate:modelValue":r[18]||(r[18]=l=>e.weightLog.value=l),itemKey:l=>l.date.toString(),handle:".drag-handle"},{item:u(({element:l,index:ae})=>[t(i(H),null,{default:u(()=>[t(i(V),{pt:{header:{class:"drag-handle"},toggleableContent:{class:"background-gray-dark rounded-t-primary rounded-b-primary pt-3 my-3"}}},{header:u(()=>[m("div",Ue,[r[21]||(r[21]=m("i",{class:"pi pi-arrows-v place-self-center hover:cursor-pointer"},null,-1)),m("p",null,fe(i(pe)(l.date)),1)])]),default:u(()=>[t(De,{ref:y=>{Q.value[ae]=y},id:l.date.toString(),log:l,"is-open":a.isOpen,onDelete:y=>Z(l.date.toString()),onError:y=>ee(y,l.date.toString())},null,8,["id","log","is-open","onDelete","onError"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","itemKey"]),m("div",ke,[t(J,{class:"w-1/2",type:"green",label:"Add Log",onClick:Y})])]),_:1})]),_:1}),m("div",Ce,[t(te,{ref_key:"avatarField",ref:L,id:"avatar",name:"avatar",label:"Avatar",modelValue:e.avatar.value,"onUpdate:modelValue":r[19]||(r[19]=l=>e.avatar.value=l),error:e.avatar.error,"onUpdate:error":r[20]||(r[20]=l=>e.avatar.error=l),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["modelValue","error"])])])]),_:1},8,["isOpen","title","confirm-text","confirm-loading","confirm-props"]))}});export{Ee as _};
