import{d as R,aR as T,v as Y,c as q,s as P,w as j,f as u,o as z,g as c,j as r,m as n,q as o,l as C,h as s,k as m,A as E,P as F,T as L,_ as H,y as K}from"../bundle.js";import{_ as G,a as $}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-Bw1DkFfV.js";const Q={class:"mb-5 flex flex-col items-center"},W={key:0,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},X={key:1,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},Z={key:2,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},ee={class:"w-full xl:w-2/3 flex flex-col md:flex-row justify-between"},le={key:0,class:"w-full flex flex-col items-center"},te={class:"w-full flex flex-col gap-3 items-center p-5"},ae={class:"w-full flex flex-col items-center"},se={key:0,class:"w-full flex flex-col gap-3 items-center p-5"},re={key:1,class:"w-full flex flex-col gap-3 items-center p-5"},oe={class:"w-full flex flex-col gap-3 items-center"},ce=R({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(ne,{emit:B}){const p=B,y=T(),M=Y(),A=q(),{games:_,gamesLoading:i}=P(y),{onlineUsers:h}=P(M),{firebaseUser:x}=P(A),g=j(""),w=j(3),f=u(()=>{var t;return(t=x.value)==null?void 0:t.uid}),D=u(()=>_.value.filter(t=>t.players.find(l=>l.userId===f.value))),d=u(()=>D.value.filter(t=>!t.maxPlayers)),N=u(()=>h.value.filter(t=>!d.value.some(l=>l.players.some(e=>e.userId===t.id)))),v=u(()=>_.value.filter(t=>!!t.maxPlayers)),b=u(()=>v.value.filter(t=>I(t.id))),k=u(()=>v.value.filter(t=>!I(t.id))),I=t=>{const l=v.value.find(e=>e.id===t);return(l==null?void 0:l.players.find(e=>e.userId===f.value))!==void 0},O=t=>{const l=v.value.find(e=>e.id===t);return l&&l.maxPlayers&&l.players.length<l.maxPlayers||!1},S=t=>{const l=d.value.find(e=>e.players.some(a=>a.userId===t));l?p("continueOnlineGame",l.id):p("createOnlineGame",t)},J=()=>{p("createParty",g.value,w.value)},U=t=>{p("joinParty",t)};return z(async()=>{await y.fetchGames()}),(t,l)=>(r(),c("div",Q,[d.value.length?(r(),c("div",W,[l[6]||(l[6]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your 1v1s",-1)),d.value.length?(r(),C(G,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:d.value.flatMap(e=>e.players.filter(a=>{var V;return a.userId!==((V=s(x))==null?void 0:V.uid)}).map(a=>({id:a.userId}))),"custom-click-action":"","get-color":()=>s(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!s(i),onClick:l[0]||(l[0]=e=>S(e))},null,8,["listOfUsers","get-color","isClickable"])):n("",!0)])):n("",!0),b.value.length?(r(),c("div",X,[l[7]||(l[7]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your parties",-1)),b.value.length?(r(),C($,{key:0,class:"w-full justify-center !gap-3 !my-0 !py-5 border border-white",list:b.value.map(e=>({id:e.id,label:e.partyName||e.players.map(a=>s(y).getPlayerDisplayName(a.userId)).join(", ")})),"custom-click-action":"","get-color":()=>s(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!s(i),onClick:l[1]||(l[1]=e=>U(e))},null,8,["list","get-color","isClickable"])):n("",!0)])):n("",!0),!d.value.length&&!b.value.length&&!s(h).filter(e=>e.id!==f.value).length?(r(),c("div",Z,l[8]||(l[8]=[o("h2",{class:"text-center text-nowrap"},"Nobody is online at the moment",-1)]))):n("",!0),o("div",ee,[N.value.filter(e=>e.id!==f.value).length?(r(),c("div",le,[o("div",te,[l[9]||(l[9]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a 1v1",-1)),m(G,{class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:N.value.filter(e=>e.id!==f.value),"custom-click-action":"","get-color":e=>{var a;return s(i)||e===((a=s(x))==null?void 0:a.uid)?"bg-neutral-500":"bg-green-500"},isClickable:e=>{var a;return!s(i)&&e!==((a=s(x))==null?void 0:a.uid)},onClick:l[2]||(l[2]=e=>S(e))},null,8,["listOfUsers","get-color","isClickable"])])])):n("",!0),o("div",ae,[t.allowParty&&k.value.length?(r(),c("div",se,[l[10]||(l[10]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Join a party",-1)),k.value.length?(r(),C($,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",list:k.value.map(e=>({id:e.id,label:e.partyName||e.players.map(a=>s(y).getPlayerDisplayName(a.userId)).join(", ")})),"custom-click-action":"","get-color":e=>s(i)?"bg-neutral-500":O(e)?"bg-green-500":"bg-neutral-500",isClickable:e=>!s(i)&&O(e),onClick:l[3]||(l[3]=e=>U(e))},null,8,["list","get-color","isClickable"])):n("",!0)])):n("",!0),t.allowParty?(r(),c("div",re,[l[11]||(l[11]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a party",-1)),m(K,{class:"w-full min-h-[52px] flex flex-col flex-wrap gap-5 items-center !px-1 !py-2 !pb-5 !rounded-primary border border-white"},{default:E(()=>[o("div",oe,[m(F,{class:"w-2/3","input-props":{class:"!placeholder-neutral-600"},name:"partyName",label:"Name",modelValue:g.value,"onUpdate:modelValue":l[4]||(l[4]=e=>g.value=e),type:"text",placeholder:"My Party Name"},null,8,["modelValue"]),m(L,{class:"w-2/3",name:"partyAmount",label:"Size",modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=e=>w.value=e),options:[{value:2,label:"2 players"},{value:3,label:"3 players"},{value:4,label:"4 players"},{value:5,label:"5 players"},{value:10,label:"10 players"}]},null,8,["modelValue"]),m(H,{class:"w-2/3",label:"Create",variant:"green",onClick:J})])]),_:1})])):n("",!0)])])]))}});export{ce as _};
