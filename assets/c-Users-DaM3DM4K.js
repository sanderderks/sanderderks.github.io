import{d as T,q as x,ag as M,u as B,F as V,G as F,ah as j,s as i,c as q,h as t,w as s,f as e,O as z,z as S,C as g,b as u,_ as G,ai as J,aj as o,g as y,e as H,n as K,R as c,J as b,k as C,t as h,$ as Q,A as W,i as X}from"../bundle.js";import{_ as Y}from"./c-Dialog.vue_vue_type_script_setup_true_lang-DhUst3eP.js";import{_ as Z}from"./c-Page.vue_vue_type_script_setup_true_lang-3zQkaq1W.js";const ee=["src"],ie=T({__name:"Users",setup(ae){const k=x(),L=M(),$=B(),m=V(),f=F(),w=j(),{firebaseUser:D}=i(k),{combinedUsers:p}=i(L),{isMutationLoading:N}=i(m),{isMutationLoading:O}=i(f),{routeLoading:R,routeLoadingId:E}=i($),r=S(!1),n=S(null),l=g(()=>p.value.find(d=>d.id===n.value)),I=g(()=>l.value?`${l.value.id} ${l.value.firstName??""} ${l.value.lastName??""}`:"Unknown user");function A(d){n.value=d,r.value=!0}async function P(){n.value&&(await w.deleteOnlineUser(n.value),await m.deletePrivateUser(n.value),await f.deletePublicUser(n.value)),r.value=!1}return(d,_)=>{const v=W("RouterLink");return u(),q(z,null,[t(Z,null,{content:s(()=>[t(G,{class:"!bg-primary-500 !bg-opacity-35 my-5",title:"Users"},{default:s(()=>[t(e(J),{value:e(p),tableStyle:"min-width: 50rem"},{default:s(()=>[t(e(o),null,{body:s(({data:a})=>[a.avatar?(u(),y(v,{key:0,to:{name:e(c).USER_DETAILS,params:{userId:a.id}}},{default:s(()=>[H("img",{class:K(["rounded-full h-12 w-12 min-w-12 aspect-square object-cover",{"animate-spin":e(R)===e(c).USER_DETAILS&&e(E)===a.id}]),src:a.avatar},null,10,ee)]),_:2},1032,["to"])):b("",!0)]),_:1}),t(e(o),{header:"Displayname"},{body:s(({data:a})=>[t(v,{to:{name:e(c).USER_DETAILS,params:{userId:a.id}}},{default:s(()=>[C(h(a.displayName),1)]),_:2},1032,["to"])]),_:1}),t(e(o),{field:"firstName",header:"First name"}),t(e(o),{field:"lastName",header:"Last name"}),t(e(o),{header:"Last online"},{body:s(({data:a})=>[C(h(a!=null&&a.lastOnline?e(Q)(a.lastOnline):""),1)]),_:1}),t(e(o),null,{body:s(({data:a})=>{var U;return[a.id!==((U=e(D))==null?void 0:U.uid)?(u(),y(X,{key:0,variant:"danger",icon:"pi pi-trash",onClick:te=>A(a.id)},null,8,["onClick"])):b("",!0)]}),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(Y,{title:"Delete User",isOpen:r.value,description:[`Are you sure you want to delete user ${I.value}?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},"confirm-loading":e(N)||e(O),onConfirm:P,onCancel:_[0]||(_[0]=a=>r.value=!1)},null,8,["isOpen","description","confirm-loading"])],64)}}});export{ie as default};
