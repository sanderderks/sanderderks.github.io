import{q as se,G as ve,s as G,z as W,C as c,X as j,d as ne,b as a,c as b,e as y,Y as ae,t as I,T as ce,l as pe,g as i,w as $,Z as fe,f as e,h as k,R as z,_ as le,J as s,$ as P,a0 as re,a1 as ye,a2 as me,a3 as ge,O as Y,Q as be,a4 as he,i as N,k as ue,j as we,a5 as xe,B as ke}from"../bundle.js";import{_ as De}from"./c-BackButton.vue_vue_type_script_setup_true_lang-DVCFWGtb.js";import{D as L,u as _e,_ as Se}from"./c-useDateChart-PiIwI4ec.js";import{_ as Ae}from"./c-Dialog.vue_vue_type_script_setup_true_lang-DhUst3eP.js";import{_ as Oe}from"./c-Page.vue_vue_type_script_setup_true_lang-3zQkaq1W.js";import{u as Ce}from"./c-useCatCalc-BRiekmHA.js";import{_ as Be}from"./c-PetDialog.vue_vue_type_script_setup_true_lang-i29L5IF1.js";import{_ as Pe}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";import"./c-useUsers-Rsmxr7ei.js";const U=h=>{const d=se(),_=ve(),{isOwner:C,firebaseUser:r}=G(d),{publicUsers:D}=G(_),S=1e3*60*60*24*365.25,A=W(L.MONTHS),n=c(()=>j(h)),w=c(()=>{var u;return(u=n.value)!=null&&u.dateOfBirth?(new Date().getTime()-new Date(n.value.dateOfBirth).getTime())/S:0}),o=c(()=>w.value*12),p=c(()=>w.value*52),t=c(()=>D.value.find(u=>{var f;return u.id===((f=n.value)==null?void 0:f.userId)})),O=c(()=>D.value.find(u=>{var f;return u.id===((f=n.value)==null?void 0:f.coOwnerId)})),T=c(()=>{var u,f;return((u=n.value)==null?void 0:u.userId)===((f=r.value)==null?void 0:f.uid)||C.value}),V=c(()=>{var u;return((u=n.value)==null?void 0:u.weightLog.map(f=>({date:new Date(f.date),value:f.weight})))??[]}),{headers:q,filteredData:R}=_e(V,A),E=c(()=>{if(!n.value||!n.value.dateOfBirth)return null;const u=n.value.vetDate?new Date(n.value.vetDate):null;if(u)return w.value<=7?g(u,1,1):g(u,2,1);if(n.value.type==="cat")return g(new Date(n.value.dateOfBirth),52,10);if(n.value.type==="dog")return g(new Date(n.value.dateOfBirth),52,4)}),F=c(()=>{if(!n.value||!n.value.dateOfBirth)return null;const u=n.value.dewormingDate?new Date(n.value.dewormingDate):null;if(u){if(p.value<=9)return g(u,52,2);if(o.value<=3)return g(u,12,3);if(o.value<=6)return g(u,12,1);if(n.value.type==="cat")return g(u,12,n.value.insideCat?6:3);if(n.value.type==="dog")return g(u,12,3)}else return g(new Date(n.value.dateOfBirth),52,3)}),g=(u,f,M)=>new Date(u.getTime()+S/f*M);return{weightLogPeriod:A,petAgeYears:w,petAgeMonths:o,petAgeWeeks:p,petOwner:t,petCoOwner:O,isMyPet:T,nextVetVisit:E,nextDeworming:F,chartHeaders:q,chartData:R}},Le=h=>{var w;const d=c(()=>j(h)),{petAgeYears:_,petAgeMonths:C}=U(d),r=c(()=>{var p,t;if(((p=d.value)==null?void 0:p.type)!=="cat"||!((t=d.value)!=null&&t.dateOfBirth))return null;const o=_.value;switch(!0){case o<1:return{value:"kitten",label:"Kitten (0-12 months)"};case(o>=1&&o<3):return{value:"junior",label:"Junior (1-2 years)"};case(o>=3&&o<7):return{value:"adult",label:"Adult (3-6 years)"};case(o>=7&&o<11):return{value:"mature",label:"Mature (7-10 years)"};case(o>=11&&o<15):return{value:"senior",label:"Senior (11-14 years)"};case o>=15:return{value:"geriatric",label:"Geriatric (15+ years)"};default:return null}}),D=c(()=>d.value?d.value.weightLog.length?d.value.weightLog.map(p=>({...p,date:new Date(p.date).getTime()})).sort((p,t)=>t.date-p.date)[0].weight:d.value.weight??null:null),S=c(()=>{var o,p,t;if(!((o=d.value)!=null&&o.dateOfBirth))return null;switch((p=r.value)==null?void 0:p.value){case"kitten":return C.value<=4?"kitten0.4":"kitten1";default:return(t=d.value)!=null&&t.castrated?"castrated":"default"}}),{requiredCaloriesByWeightAndAgeAndSize:A,requiredFoodDry:n}=Ce("average",D.value??"",S.value??"default",((w=d.value)==null?void 0:w.gender)??"male","35","default");return{catLifeStage:r,petWeight:D,requiredCaloriesByWeightAndAgeAndSize:r?A:null,requiredFoodDry:r?n:null}},$e=h=>{const d=c(()=>j(h)),{petAgeYears:_}=U(d);return{dogLifeStage:c(()=>{var D,S,A;if(((D=d.value)==null?void 0:D.type)!=="dog"||!((S=d.value)!=null&&S.dateOfBirth)||!((A=d.value)!=null&&A.breedSize))return null;const r=_.value;switch(d.value.breedSize){case"small":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<8?{value:"adult",label:"Adult (3-7 years)"}:r<11?{value:"mature",label:"Mature (8-10 years)"}:r<15?{value:"senior",label:"Senior (11-14 years)"}:{value:"geriatric",label:"Geriatric (15+ years)"};case"medium":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<7?{value:"adult",label:"Adult (3-6 years)"}:r<10?{value:"mature",label:"Mature (7-9 years)"}:r<13?{value:"senior",label:"Senior (10-12 years)"}:{value:"geriatric",label:"Geriatric (13+ years)"};case"large":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<3?{value:"young_adult",label:"Young Adult (1-2 years)"}:r<6?{value:"adult",label:"Adult (3-5 years)"}:r<9?{value:"mature",label:"Mature (6-8 years)"}:r<12?{value:"senior",label:"Senior (9-11 years)"}:{value:"geriatric",label:"Geriatric (12+ years)"};case"giant":return r<1?{value:"puppy",label:"Puppy (0-12 months)"}:r<2?{value:"young_adult",label:"Young Adult (1-1.5 years)"}:r<5?{value:"adult",label:"Adult (2-4 years)"}:r<8?{value:"mature",label:"Mature (5-7 years)"}:r<10?{value:"senior",label:"Senior (8-9 years)"}:{value:"geriatric",label:"Geriatric (10+ years)"};default:return null}})}},Te={class:"ms-5 max-sm:mt-3 md:ms-10 grid grid-cols-1 sm:grid-cols-[1fr_2fr] gap-1 sm:gap-3 justify-between"},v=ne({__name:"KeyValuePair",props:{title:{},value:{},titleProps:{},valueProps:{}},setup(h){return(d,_)=>(a(),b("div",Te,[y("p",ae({class:"font-bold text-nowrap"},h.titleProps),I(h.title),17),y("p",ae({class:"text-neutral-300"},h.valueProps),I(h.value),17)]))}}),Ve={class:"break-words text-neutral-300"},Ye={class:"flex flex-col gap-10"},Ne={key:2,class:"max-sm:mt-5 ms-5 md:ms-10 pi pi-sync animate-spin text-neutral-300"},Ie={key:0,class:"flex flex-wrap md:flex-nowrap gap-3 justify-around"},Re={class:"flex flex-col md:items-center"},Ee={class:"text-indigo-300 font-bold"},Me={class:"text-gray-300 italic"},ze={class:"mt-3 flex justify-center gap-3"},Ge={key:0,class:"w-full text-neutral-300"},qe={key:1,class:"flex gap-3"},Fe={key:1,class:"flex justify-center"},He=ne({__name:"Pet",setup(h){const d=ke(),_=we(),C=ce(),r=se(),{pets:D}=G(C),{isLoggedIn:S}=G(r),{deletePet:A}=C,n=xe("statisticsRef"),w=W(!1),o=W(!1),p=c(()=>d.params.petId),t=c(()=>D.value.find(B=>B.id===p.value)),{weightLogPeriod:O,petOwner:T,petCoOwner:V,isMyPet:q,nextVetVisit:R,nextDeworming:E,chartHeaders:F,chartData:g}=U(t),{catLifeStage:u,petWeight:f,requiredCaloriesByWeightAndAgeAndSize:M,requiredFoodDry:J}=Le(t),{dogLifeStage:K}=$e(t),{births:Q,holidays:X,isLoading:ie,fetchData:oe}=fe(),de=async B=>{await A(B),_.push({name:z.PET_OVERVIEW})};return pe(()=>{var B;(B=t.value)!=null&&B.dateOfBirth&&setTimeout(()=>{oe(new Date(t.value.dateOfBirth),"all",{reverse:!0})},1e3)}),(B,l)=>(a(),i(Oe,null,{content:$(()=>[e(S)?(a(),b(Y,{key:0},[k(De,{"back-route":e(z).PET_OVERVIEW,label:"Back to all pets"},null,8,["back-route"]),t.value?(a(),i(le,{key:0,class:"!bg-primary-500 !bg-opacity-35 my-5",title:t.value.name,"title-props":{class:"text-3xl md:text-5xl"},"title-wrapper-props":{class:"ms-5"},avatar:t.value.avatar??void 0,"avatar-props":{class:"h-20 w-20 md:h-32 md:w-32"}},{underTitle:$(()=>[y("p",Ve,I(t.value.description),1)]),default:$(()=>{var H,Z,ee,te;return[y("div",Ye,[y("div",null,[l[9]||(l[9]=y("h3",null,"Details",-1)),e(T)?(a(),i(v,{key:0,title:e(V)?"Owners:":"Owner:",value:e(V)?`${e(T).displayName} & ${e(V).displayName}`:e(T).displayName},null,8,["title","value"])):s("",!0),t.value.dateOfBirth?(a(),i(v,{key:1,title:"Date of birth:",value:e(P)(t.value.dateOfBirth)},null,8,["value"])):s("",!0),e(ie)?(a(),b("i",Ne)):s("",!0),e(X).length?(a(),i(v,{key:3,title:"On this date:",value:`~ ${e(re)(e(X)).text}`,"title-props":{class:"text-yellow-300 italic"},"value-props":{class:"max-sm:ms-0 ms-2 text-neutral-100 italic"}},null,8,["value"])):s("",!0),e(Q).length?(a(),i(v,{key:4,class:"max-sm:ms-3",title:"",value:`~ ${e(re)(e(Q)).text} was born`,"title-props":{class:"hidden sm:block"},"value-props":{class:"ms-2 text-neutral-100 italic"}},null,8,["value"])):s("",!0),t.value.type?(a(),i(v,{key:5,title:"Type:",value:((H=e(ye).find(({value:m})=>{var x;return m===((x=t.value)==null?void 0:x.type)}))==null?void 0:H.label)??""},null,8,["value"])):s("",!0),t.value.breed?(a(),i(v,{key:6,title:"Breed:",value:t.value.breed},null,8,["value"])):s("",!0),t.value.breedSize&&t.value.type==="dog"?(a(),i(v,{key:7,title:"Breed size:",value:((Z=e(me).find(({value:m})=>{var x;return m===((x=t.value)==null?void 0:x.breedSize)}))==null?void 0:Z.label)??""},null,8,["value"])):s("",!0),t.value.gender?(a(),i(v,{key:8,title:"Gender:",value:((ee=e(ge).find(({value:m})=>{var x;return m===((x=t.value)==null?void 0:x.gender)}))==null?void 0:ee.label)??""},null,8,["value"])):s("",!0),l[10]||(l[10]=y("h3",null,"Health",-1)),e(f)?(a(),i(v,{key:9,title:"Weight:",value:e(f)+"kg"},null,8,["value"])):s("",!0),typeof t.value.insideCat=="boolean"?(a(),i(v,{key:10,title:"Inside Cat:",value:t.value.insideCat?"Yes":"No"},null,8,["value"])):s("",!0),t.value.castrated!==void 0?(a(),i(v,{key:11,title:"Castrated:",value:t.value.castrated?"Yes":"No"},null,8,["value"])):s("",!0),t.value.vetDate?(a(),i(v,{key:12,title:"Last vet visit:",value:e(P)(t.value.vetDate)},null,8,["value"])):s("",!0),t.value.lastVaccinationDate?(a(),i(v,{key:13,title:"Last vaccination:",value:e(P)(t.value.lastVaccinationDate)},null,8,["value"])):s("",!0),t.value.dewormingDate?(a(),i(v,{key:14,title:"Last deworming:",value:e(P)(t.value.dewormingDate)},null,8,["value"])):s("",!0)]),t.value.dateOfBirth?(a(),b("div",Ie,[k(he,{class:"w-full md:w-3/4 text-neutral-300 bg-neutral-900 rounded-secondary",time:new Date(t.value.dateOfBirth).getTime(),direction:"up"},{birthdayText:$(()=>[...l[11]||(l[11]=[y("h4",{class:"text-xl xl:text-3xl text-pink-500 font-bold italic"},"Happy birthday!",-1)])]),onThisDay:$(({selected:m})=>[l[12]||(l[12]=y("h5",{class:"place-self-center xl:text-xl text-slate-400 font-bold"},"Also on this day:",-1)),(a(!0),b(Y,null,be(m,x=>(a(),b("div",Re,[y("p",Ee,I(x.year),1),y("p",Me,I(x.text),1)]))),256))]),_:1},8,["time"])])):s("",!0),y("div",null,[l[13]||(l[13]=y("h3",null,"Statistics",-1)),y("div",{ref_key:"statisticsRef",ref:n},[t.value.type==="cat"?(a(),b(Y,{key:0},[e(u)?(a(),i(v,{key:0,title:"Life stage:",value:e(u).label},null,8,["value"])):s("",!0),e(M)?(a(),i(v,{key:1,title:"Required energy per day:",value:e(M).toFixed(1)+" kcal"},null,8,["value"])):s("",!0),e(J)?(a(),i(v,{key:2,title:"Required dry food per day:",value:e(J).toFixed(1)+" g"},null,8,["value"])):s("",!0)],64)):t.value.type==="dog"?(a(),b(Y,{key:1},[e(K)?(a(),i(v,{key:0,title:"Life stage:",value:e(K).label},null,8,["value"])):s("",!0)],64)):s("",!0),e(R)?(a(),i(v,{key:2,title:"Next vet visit:",value:e(P)(e(R))},null,8,["value"])):s("",!0),t.value.nextVaccinationDate?(a(),i(v,{key:3,title:"Next vaccination:",value:e(P)(new Date(t.value.nextVaccinationDate))},null,8,["value"])):s("",!0),e(E)?(a(),i(v,{key:4,title:"Next deworming:",value:e(P)(e(E))},null,8,["value"])):s("",!0),t.value.weightLog.length?(a(),b(Y,{key:5},[y("div",ze,[k(N,{variant:"neutral",label:"1 Year",outlined:e(O)===e(L).MONTHS,onClick:l[0]||(l[0]=m=>O.value=e(L).MONTHS)},null,8,["outlined"]),k(N,{variant:"neutral",label:"3 Years",outlined:e(O)===e(L).YEARS_HALF,onClick:l[1]||(l[1]=m=>O.value=e(L).YEARS_HALF)},null,8,["outlined"]),k(N,{variant:"neutral",label:"10 Years",outlined:e(O)===e(L).YEARS,onClick:l[2]||(l[2]=m=>O.value=e(L).YEARS)},null,8,["outlined"])]),k(Se,{headers:e(F),datasets:[{label:`${t.value.name}'s weight (kg)`,fill:!1,borderColor:"red",yAxisID:"y",tension:.4,data:e(g),spanGaps:!0}]},null,8,["headers","datasets"])],64)):s("",!0)],512),(te=n.value)!=null&&te.childElementCount?s("",!0):(a(),b("p",Ge," Nothing to show yet. "))]),e(q)?(a(),b("div",qe,[k(N,{label:"Edit",outlined:"",onClick:l[3]||(l[3]=m=>w.value=!0)}),k(N,{label:"Delete",variant:"danger",outlined:"",onClick:l[4]||(l[4]=m=>o.value=!0)})])):s("",!0),k(Be,{"is-open":w.value,"original-pet":t.value??null,onClose:l[5]||(l[5]=m=>w.value=!1)},null,8,["is-open","original-pet"]),k(Ae,{"is-open":o.value,title:"Delete Pet",description:"Are you sure you want to delete your pet?","confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},onConfirm:l[6]||(l[6]=m=>de(t.value.id)),onCancel:l[7]||(l[7]=m=>o.value=!1)},null,8,["is-open"])])]}),_:1},8,["title","avatar"])):s("",!0)],64)):(a(),b("div",Fe,[k(le,{class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:$(()=>[l[14]||(l[14]=ue(" Please ",-1)),y("a",{class:"cursor-pointer",onClick:l[8]||(l[8]=H=>e(_).push({name:e(z).LOGIN,params:{redirect:JSON.stringify({name:e(z).PET_DETAILS,params:{petId:p.value}})}}))}," Login "),l[15]||(l[15]=ue(" to view this pet. ",-1))]),_:1})]))]),_:1}))}}),tt=Pe(He,[["__scopeId","data-v-de03ee83"]]);export{tt as default};
