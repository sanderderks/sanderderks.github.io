import{_ as N}from"./c-Bubble.vue_vue_type_script_setup_true_lang-iHAaGDxw.js";import{e as U,A as V,aG as P,s as p,r as D,o as x,as as A,M as C,l as a,m as r,p as o,k as g,w as m,O as L,H as n,G as d,t as S,C as T,n as $,h as M,c as b}from"../bundle.js";import{_ as j}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"w-full mt-5 text-sm md:text-base text-left"},F={key:1},O={key:2},R={class:"mt-5 flex justify-center"},q=U({__name:"Highscores",props:{gameId:{},unit:{}},setup(i){const f=i,y=V(),c=P(f.gameId)(),{publicUsers:I}=p(y),{allGameData:h,fetchLoading:v}=p(c),{fetchGameData:l,fetchHighscores:_,fetchScores:k}=c,e=D("highscores"),H=D(),w=u=>{var t;return((t=I.value.find(s=>s.id===u))==null?void 0:t.displayName)??"Unknown"},B=()=>{e.value==="highscores"?_():k()};return x(()=>{l(),H.value=setInterval(()=>{l()},1e3*60*5)}),A(()=>{clearInterval(H.value)}),C(e,()=>{h.value[f.gameId].gameData[e.value].length||B()}),(u,t)=>(a(),r(m,null,[o("table",E,[o("tbody",null,[g(h)[u.gameId].gameData[e.value].length?(a(!0),r(m,{key:0},L(g(h)[u.gameId].gameData[e.value],(s,G)=>(a(),r("tr",null,[o("th",null,n(G+1),1),o("th",null,n(w(s.userId??s.id)),1),o("td",null,[d(n(s.score)+" ",1),u.unit?(a(),r(m,{key:0},[d(n(u.unit),1),s.score!==1?(a(),r(m,{key:0},[d("s")],64)):S("",!0),t[1]||(t[1]=d(" "+n(" ")))],64)):S("",!0),s.bonus?(a(),r(m,{key:1},[d("("+n(s.bonus)+" bonus)",1)],64)):S("",!0)]),o("td",null,n(g(T)(s.date)),1)]))),256)):g(v)?(a(),r("tr",F,t[2]||(t[2]=[o("th",null,"Loading highscores...",-1)]))):(a(),r("tr",O,[o("th",null,"There are no "+n(e.value==="highscores"?"highscores":"scores")+" yet.",1)]))])]),o("div",R,[$(N,{class:"w-full md:w-1/2",label:`View ${e.value==="highscores"?"All Scores":"Highscores"}`,type:"secondary",onClick:t[0]||(t[0]=s=>e.value==="highscores"?e.value="scores":e.value="highscores")},null,8,["label"])])],64))}}),Q=j(q,[["__scopeId","data-v-f1f1cfc2"]]),W=i=>{const f=M(),y=P(i)(),{allGameData:c,highscorePosition:I,personalBest:h}=p(y),{firebaseUser:v}=p(f),l=b(()=>v.value?I.value:null),_=b(()=>{const e=c.value[i].previousHighscorePosition;return l.value&&e?e>l.value:!1}),k=b(()=>{const e=c.value[i].previousPersonalBest;return v.value&&e?e<h.value:!1});return{currentHighscorePosition:l,hasImprovedHighscorePosition:_,hasImprovedPersonalBest:k}};export{Q as H,W as u};
