import{d as F,aR as q,v as J,c as L,s as w,w as V,f as p,o as z,g as n,j as r,m as c,q as o,l as U,h as a,k as b,A as H,P as R,T as K,_ as Q,y as W,C as X,E as Z,I as A,am as ee}from"../bundle.js";import{_ as D,a as E}from"./c-UsersBar.vue_vue_type_script_setup_true_lang-Bw1DkFfV.js";const le={class:"mb-5 flex flex-col items-center"},te={key:0,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},se={key:1,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},ae={key:2,class:"w-full xl:w-2/3 flex flex-col gap-3 items-center p-5"},re={class:"w-full xl:w-2/3 flex flex-col md:flex-row justify-between"},oe={key:0,class:"w-full flex flex-col items-center"},ne={class:"w-full flex flex-col gap-3 items-center p-5"},ie={class:"w-full flex flex-col items-center"},ue={key:0,class:"w-full flex flex-col gap-3 items-center p-5"},ce={key:1,class:"w-full flex flex-col gap-3 items-center p-5"},de={class:"w-full flex flex-col gap-3 items-center"},xe=F({__name:"FindOpponent",props:{allowParty:{type:Boolean}},emits:["createOnlineGame","continueOnlineGame","createParty","joinParty"],setup(T,{emit:P}){const y=P,v=q(),h=J(),N=L(),{games:f,gamesLoading:i}=w(v),{onlineUsers:k}=w(h),{firebaseUser:d}=w(N),x=V(""),m=V(3),u=p(()=>{var t;return(t=d.value)==null?void 0:t.uid}),S=p(()=>f.value.filter(t=>t.players.find(l=>l.userId===u.value))),g=p(()=>S.value.filter(t=>!t.maxPlayers)),$=p(()=>k.value.filter(t=>!g.value.some(l=>l.players.some(e=>e.userId===t.id)))),_=p(()=>f.value.filter(t=>!!t.maxPlayers)),C=p(()=>_.value.filter(t=>j(t.id))),I=p(()=>_.value.filter(t=>!j(t.id))),j=t=>{const l=_.value.find(e=>e.id===t);return(l==null?void 0:l.players.find(e=>e.userId===u.value))!==void 0},O=t=>{const l=_.value.find(e=>e.id===t);return l&&l.maxPlayers&&l.players.length<l.maxPlayers||!1},G=t=>{const l=g.value.find(e=>e.players.some(s=>s.userId===t));l?y("continueOnlineGame",l.id):y("createOnlineGame",t)},Y=()=>{y("createParty",x.value,m.value)},M=t=>{y("joinParty",t)};return z(async()=>{await v.fetchGames()}),(t,l)=>(r(),n("div",le,[g.value.length?(r(),n("div",te,[l[6]||(l[6]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your 1v1s",-1)),g.value.length?(r(),U(D,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:g.value.flatMap(e=>e.players.filter(s=>{var B;return s.userId!==((B=a(d))==null?void 0:B.uid)}).map(s=>({id:s.userId}))),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[0]||(l[0]=e=>G(e))},null,8,["listOfUsers","get-color","isClickable"])):c("",!0)])):c("",!0),C.value.length?(r(),n("div",se,[l[7]||(l[7]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Your parties",-1)),C.value.length?(r(),U(E,{key:0,class:"w-full justify-center !gap-3 !my-0 !py-5 border border-white",list:C.value.map(e=>({id:e.id,label:e.partyName||e.players.map(s=>a(v).getPlayerDisplayName(s.userId)).join(", ")})),"custom-click-action":"","get-color":()=>a(i)?"bg-neutral-500":"bg-purple-500 bg-opacity-50",isClickable:()=>!a(i),onClick:l[1]||(l[1]=e=>M(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),!g.value.length&&!C.value.length&&!a(k).filter(e=>e.id!==u.value).length?(r(),n("div",ae,l[8]||(l[8]=[o("h2",{class:"text-center text-nowrap"},"Nobody is online at the moment",-1)]))):c("",!0),o("div",re,[$.value.filter(e=>e.id!==u.value).length?(r(),n("div",oe,[o("div",ne,[l[9]||(l[9]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a 1v1",-1)),b(D,{class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",listOfUsers:$.value.filter(e=>e.id!==u.value),"custom-click-action":"","get-color":e=>{var s;return a(i)||e===((s=a(d))==null?void 0:s.uid)?"bg-neutral-500":"bg-green-500"},isClickable:e=>{var s;return!a(i)&&e!==((s=a(d))==null?void 0:s.uid)},onClick:l[2]||(l[2]=e=>G(e))},null,8,["listOfUsers","get-color","isClickable"])])])):c("",!0),o("div",ie,[t.allowParty&&I.value.length?(r(),n("div",ue,[l[10]||(l[10]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Join a party",-1)),I.value.length?(r(),U(E,{key:0,class:"w-full flex-col items-center !gap-3 !my-0 !pb-5 border border-white",list:I.value.map(e=>({id:e.id,label:e.partyName||e.players.map(s=>a(v).getPlayerDisplayName(s.userId)).join(", ")})),"custom-click-action":"","get-color":e=>a(i)?"bg-neutral-500":O(e)?"bg-green-500":"bg-neutral-500",isClickable:e=>!a(i)&&O(e),onClick:l[3]||(l[3]=e=>M(e))},null,8,["list","get-color","isClickable"])):c("",!0)])):c("",!0),t.allowParty?(r(),n("div",ce,[l[11]||(l[11]=o("h2",{class:"text-2xl font-bold text-center text-nowrap"},"Start a party",-1)),b(W,{class:"w-full min-h-[52px] flex flex-col flex-wrap gap-5 items-center !px-1 !py-2 !pb-5 !rounded-primary border border-white"},{default:H(()=>[o("div",de,[b(R,{class:"w-2/3","input-props":{class:"!placeholder-neutral-600"},name:"partyName",label:"Name",modelValue:x.value,"onUpdate:modelValue":l[4]||(l[4]=e=>x.value=e),type:"text",placeholder:"My Party Name"},null,8,["modelValue"]),b(K,{class:"w-2/3",name:"partyAmount",label:"Size",modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value=e),options:[{value:2,label:"2 players"},{value:3,label:"3 players"},{value:4,label:"4 players"},{value:5,label:"5 players"},{value:10,label:"10 players"}]},null,8,["modelValue"]),b(Q,{class:"w-2/3",label:"Create",variant:"green",onClick:Y})])]),_:1})])):c("",!0)])])]))}}),me={key:0,class:"mt-3 md:ms-10 flex flex-col gap-3"},fe={class:"flex gap-2"},pe={class:"font-bold"},ge=F({__name:"GameChat",props:{chats:{}},emits:["sendChat"],setup(T,{emit:P}){const y=L(),v=J(),{firebaseUser:h}=w(y),{combinedUsers:N}=w(v),f=V(""),i=()=>{if(h.value&&f.value){const d={userId:h.value.uid,message:f.value};k("sendChat",d),f.value=""}},k=P;return(d,x)=>(r(),n("form",{class:"w-full my-10 flex flex-wrap items-center justify-center",action:"",onSubmit:ee(i,["prevent"])},[b(R,{name:"chat",class:"w-full md:w-1/2",inputProps:{autocomplete:"off"},placeholder:"chat...",modelValue:f.value,"onUpdate:modelValue":x[0]||(x[0]=m=>f.value=m)},null,8,["modelValue"]),d.chats.length?(r(),n("div",me,[(r(!0),n(X,null,Z([...d.chats].reverse().filter((m,u)=>u<3),m=>{var u;return r(),n("div",fe,[o("p",pe,A(((u=a(N).find(S=>S.id===m.userId))==null?void 0:u.displayName)??"unknown")+":",1),o("p",null,A(m.message),1)])}),256))])):c("",!0)],32))}});export{xe as _,ge as a};
