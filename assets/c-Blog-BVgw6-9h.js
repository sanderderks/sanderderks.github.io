import{_ as Oe}from"./c-Dialog.vue_vue_type_script_setup_true_lang-D_A3Y3YO.js";import{_ as ze}from"./c-Page.vue_vue_type_script_setup_true_lang-DcLJYCJi.js";import{d as We,r as n,a as He,c as D,I as H,b as de,v as Je,e as Ye,f as q,u as Qe,g as Me,h as Ce,i as le,j as se,s as O,o as Le,k as Ke,F as Xe,R as J,l as B,m as o,n as i,p as d,_ as j,q as T,t as h,w as U,x as K,B as Ze,y as eo,z as W,A as ee,C as Pe,D as we,E as be,G as oe,H as L,J as Se,K as oo,L as $e,M as pe,N as to,O as he,P as lo,Q as ke,S as ie,T as ce,U as Ae,V as ao,W as re,X as _e,Y as Fe,Z as te,$ as no,a0 as Ue,a1 as ro,a2 as Ve,a3 as so,a4 as G,a5 as me,a6 as io,a7 as Ie,a8 as Be,a9 as ve,aa as uo,ab as Ee,ac as po}from"../bundle.js";import{_ as Re,s as ge,a as Te,b as De,u as co}from"./c-BlogPost.vue_vue_type_script_setup_true_lang-DSDj_EHL.js";const ye=e=>(e==null?void 0:e.id)??Je(),fe=e=>{var c;return{content:(e==null?void 0:e.content.slice().map(Ye.mapOutgoing))??[],date:e!=null&&e.date?new Date(e.date):new Date,dateUpdated:e!=null&&e.dateUpdated?new Date(e.dateUpdated):new Date,title:(e==null?void 0:e.title)??"",description:(e==null?void 0:e.description)??"",descriptionFooter:(e==null?void 0:e.descriptionFooter)??"",coverImageUrl:(e==null?void 0:e.coverImageUrl)??"",timer:e!=null&&e.timer?new Date(e.timer):null,countdown:e!=null&&e.countdown?new Date(e.countdown):null,table:(e==null?void 0:e.table)??"",sections:((c=e==null?void 0:e.sections)==null?void 0:c.slice().map(b=>({...b,bullets:b.bullets.slice(),timer:b.timer?new Date(b.timer):null,countdown:b.countdown?new Date(b.countdown):null})))??[],alignment:(e==null?void 0:e.alignment)??"center",tableAlignment:(e==null?void 0:e.tableAlignment)??"left",colorPrimary:(e==null?void 0:e.colorPrimary)??"",colorSecondary:(e==null?void 0:e.colorSecondary)??"",colorTertiary:(e==null?void 0:e.colorTertiary)??"",opacityPrimary:(e==null?void 0:e.opacityPrimary)??"",opacitySecondary:(e==null?void 0:e.opacitySecondary)??"",opacityTertiary:(e==null?void 0:e.opacityTertiary)??"",locked:(e==null?void 0:e.locked)??!1,allowedUserIds:(e==null?void 0:e.allowedUserIds)??[],archived:(e==null?void 0:e.archived)??!1,datePinned:e!=null&&e.datePinned?new Date(e.datePinned):null}},ae=We("blogPostDialogStore",()=>{const e=n(!1),c=n(null),b=n(ye(null)),m=n(fe(null)),f=He({hasContentChanges:!1,hasStylingChanges:!1,hasSettingsChanges:!1}),r=D(()=>c.value?H.convert(c.value):null),v=D(()=>f.hasContentChanges),E=D(()=>f.hasStylingChanges),w=D(()=>f.hasSettingsChanges),S=()=>{c.value=null,b.value=ye(null),m.value=fe(null),f.hasContentChanges=!1,f.hasStylingChanges=!1,f.hasSettingsChanges=!1},y=a=>{c.value=a,b.value=ye(a),m.value=fe(a),e.value=!0},I=()=>{e.value=!1,S()},P=()=>H.Content.convert(m.value),p=()=>H.Styling.convert(m.value),C=()=>H.Settings.convert(m.value);return{isOpen:e,blogPostOriginal:c,blogPostMutationId:b,blogPostMutation:m,blogPostMutationChanges:f,blogPostOriginalMutation:r,hasBlogPostMutationContentChanges:v,hasBlogPostMutationStylingChanges:E,hasBlogPostMutationSettingsChanges:w,$reset:S,openWith:y,close:I,getBlogPostMutationContent:P,getBlogPostMutationStyling:p,getBlogPostMutationSettings:C,isMutationEqual:async()=>{r.value&&(f.hasContentChanges=!de(H.Content.convert(r.value),P()),f.hasStylingChanges=!de(H.Styling.convert(r.value),p()),f.hasSettingsChanges=!de(H.Settings.convert(r.value),C()))}}}),mo={key:0,class:"flex justify-center mt-5"},vo={class:"grid grid-cols-6 mb-5 gap-5"},go=q({__name:"BlogDetails",emits:["createClicked","editClicked","deleteClicked"],setup(e){const c=Qe(),b=Me(),m=Ce(),f=le(),r=se(),{routeLoading:v}=O(m),{isLoggedIn:E}=O(f),{blogPosts:w,blogReactions:S,isBlogPostsFetchLoading:y}=O(r),{fetchBlogPost:I}=r,P=D(()=>c.params.postId);return Le(async()=>{var p;if(S.value.unread=[],P.value)if(((p=w.value.data.single)==null?void 0:p.id)!==P.value){const C=await I(P.value);if(Ke(C)&&C===Xe.PERMISSION_DENIED&&!E.value){b.push({name:J.LOGIN,params:{redirect:JSON.stringify({name:J.BLOG_DETAILS,params:{postId:P.value}})}});return}}else w.value.data.single}),(p,C)=>o(y)?(i(),B("div",mo,[d(j,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:"",label:"Loading..."})])):(i(),B(K,{key:1},[T("div",vo,[d(j,{class:"col-span-full md:col-span-4 lg:col-span-2",type:"tertiary",route:o(J).BLOG,loading:o(v)===o(J).BLOG,label:"Back to other posts",icon:"pi pi-arrow-up-left"},null,8,["route","loading"])]),o(w).data.single?(i(),h(Re,{key:0,post:o(w).data.single,onEditClicked:C[0]||(C[0]=t=>p.$emit("editClicked",o(w).data.single)),onDeleteClicked:C[1]||(C[1]=t=>p.$emit("deleteClicked",o(w).data.single))},null,8,["post"])):U("",!0)],64))}});var yo={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},fo=Ze.extend({name:"card",classes:yo}),bo={name:"BaseCard",extends:eo,style:fo},Ne={name:"Card",extends:bo,inheritAttrs:!1};function ko(e,c,b,m,f,r){return i(),B("div",W({class:e.cx("root")},e.ptmi("root")),[e.$slots.header?(i(),B("div",W({key:0,class:e.cx("header")},e.ptm("header")),[ee(e.$slots,"header")],16)):U("",!0),T("div",W({class:e.cx("body")},e.ptm("body")),[e.$slots.title||e.$slots.subtitle?(i(),B("div",W({key:0,class:e.cx("caption")},e.ptm("caption")),[e.$slots.title?(i(),B("div",W({key:0,class:e.cx("title")},e.ptm("title")),[ee(e.$slots,"title")],16)):U("",!0),e.$slots.subtitle?(i(),B("div",W({key:1,class:e.cx("subtitle")},e.ptm("subtitle")),[ee(e.$slots,"subtitle")],16)):U("",!0)],16)):U("",!0),T("div",W({class:e.cx("content")},e.ptm("content")),[ee(e.$slots,"content")],16),e.$slots.footer?(i(),B("div",W({key:1,class:e.cx("footer")},e.ptm("footer")),[ee(e.$slots,"footer")],16)):U("",!0)],16)],16)}Ne.render=ko;const Co={class:"flex gap-3"},Po={class:"min-h-[50vh] flex flex-col"},wo={class:"flex justify-between h-fit mt-2 gap-2"},So={class:"flex flex-wrap gap-3"},$o={class:"relative mt-5 min-h-[20vh] max-h-screen flex flex-col justify-end"},ho={class:"relative min-h-[20vh] max-h-full flex-grow"},Uo={class:"w-full"},Vo={key:3,class:"w-full"},Io={class:"flex justify-center mt-5"},Bo={class:"flex justify-center mt-3"},Eo=q({__name:"BlogPostOverview",props:{post:{}},emits:["editClicked","deleteClicked"],setup(e){const c=e,b=Ce(),m=le(),f=Pe(),{routeLoading:r,routeLoadingId:v}=O(b),{publicUsers:E}=O(f),{isOwner:w}=O(m),S=n(c.post.archived),y=D(()=>{var t;return(t=c.post.allowedUserIds)!=null&&t.length?E.value.filter(a=>{var s;return(s=c.post.allowedUserIds)==null?void 0:s.includes(a.id)}):[]}),I=D(()=>{const t=we(c.post.date);return c.post.dateUpdated?t+` - updated ${we(c.post.dateUpdated)}`:t}),P=D(()=>{const t=[];return c.post.datePinned&&t.push({value:"Pinned",severity:"success",rounded:!1}),c.post.locked&&t.push({value:"Locked",severity:"danger",rounded:!1,icon:"pi pi-lock"}),c.post.archived&&t.push({value:"Archived",severity:"warning",rounded:!1,icon:"pi pi-file-excel"}),t}),p=D(()=>c.post.sections.length?c.post.sections[0]:null),C=()=>{const t=document.createElement("textarea"),{protocol:a,hostname:s,port:$}=window.location,k=`${a}//${s}`+(s==="localhost"?`:${$}`:"");t.value=`${k}#${lo.BLOG.path}/${c.post.id}`,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),ke.success("Copied link!")};return(t,a)=>(i(),h(be,{id:t.post.id,class:oe([{"min-h-[50vh]":!S.value},"border-4 border-transparent","!rounded-primary",t.post.colorSecondary||t.post.colorPrimary||"bg-secondary-900",t.post.opacitySecondary||"bg-opacity-50"]),title:t.post.title,subTitle:I.value,tags:P.value,loading:t.post.loading,isCollapsed:S.value,clickable:"",route:{name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}},{right:L(()=>[T("div",Co,[S.value?o(w)?(i(),h(Te,{key:1,onEditClicked:a[0]||(a[0]=s=>t.$emit("editClicked")),onDeleteClicked:a[1]||(a[1]=s=>t.$emit("deleteClicked"))})):U("",!0):(i(),h(j,{key:0,class:"border-none h-fit",type:"neutral",icon:"pi pi-copy",onClick:C}))])]),default:L(()=>{var s;return[T("div",Po,[T("div",wo,[T("div",So,[y.value.length?(i(),B(K,{key:0},[d(o(ge),{class:"h-fit !p-0 !px-4 !py-1 bg-red-800 bg-opacity-50",icon:"pi pi-user",label:y.value[0].displayName,rounded:""},null,8,["label"]),y.value.length>1?(i(),h(o(ge),{key:0,class:"h-fit !p-0 !px-4 !py-1 bg-red-800 bg-opacity-50",icon:"pi pi-user",label:"You",rounded:""})):U("",!0),y.value.length>2?(i(),h(o(ge),{key:1,class:"h-fit !p-0 !px-4 !py-1 bg-red-800 bg-opacity-50",label:`${y.value.length-2} others`,rounded:""},null,8,["label"])):U("",!0)],64)):U("",!0)]),o(w)?(i(),B("div",{key:0,class:oe(["flex justify-end ms-5",(s=t.post.allowedUserIds)!=null&&s.length?"flex-col md:flex-row":"flex-row"])},[d(Te,{onEditClicked:a[2]||(a[2]=$=>t.$emit("editClicked")),onDeleteClicked:a[3]||(a[3]=$=>t.$emit("deleteClicked"))})],2)):U("",!0)]),T("div",$o,[a[6]||(a[6]=T("div",{class:"absolute inset-0 rounded-primary bg-gradient-to-t from-neutral-500 to-transparent"},null,-1)),T("div",ho,[d(o(Ne),{class:oe(["z-10 min-h-[20vh] p-5 text-neutral-300",t.post.colorPrimary,t.post.opacityPrimary||"bg-opacity-50"])},{header:L(()=>[t.post.coverImageUrl?(i(),h(to,{key:0,post:t.post,"cover-image-url":t.post.coverImageUrl,thumb:""},null,8,["post","cover-image-url"])):U("",!0)]),content:L(()=>[T("div",{class:oe(["flex relative",t.post.countdown||t.post.alignment==="center"?"flex justify-between":""])},[T("div",Uo,[t.post.countdown?(i(),h(Se,{key:0,time:new Date(t.post.countdown).getTime(),direction:"down",alignment:t.post.alignment},null,8,["time","alignment"])):U("",!0),t.post.timer?(i(),h(Se,{key:1,time:new Date(t.post.timer).getTime(),direction:"up",alignment:t.post.alignment},null,8,["time","alignment"])):U("",!0),t.post.description?(i(),h(oo,{key:2,description:t.post.description.substring(0,150)+(t.post.description.length>=150?"...":"")},null,8,["description"])):p.value?(i(),B("div",Vo,[p.value.title?(i(),h(De,{key:0,alignment:p.value.alignment},{default:L(()=>[$e(pe(p.value.subTitle?p.value.title:`${p.value.title}...`),1)]),_:1},8,["alignment"])):U("",!0),p.value.subTitle?(i(),h(De,{key:1,alignment:p.value.alignment,"is-sub-title":""},{default:L(()=>[$e(pe(p.value.subTitle)+"... ",1)]),_:1},8,["alignment"])):U("",!0)])):U("",!0)])],2)]),_:1},8,["class"])])]),T("div",Io,[d(j,{class:"w-full md:w-1/2",type:"neutral",label:"Read more",loading:o(r)===o(J).BLOG_DETAILS&&o(v)===t.post.id,onClick:a[4]||(a[4]=$=>o(he).push({name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}))},null,8,["loading"])]),T("div",Bo,[T("p",{class:oe(t.post.reactions.length?"text-yellow-400 hover:text-yellow-500 cursor-pointer":"text-neutral-200"),onClick:a[5]||(a[5]=$=>o(he).push({name:o(J).BLOG_DETAILS,params:{postId:t.post.id}}))},pe(t.post.reactions.length)+" replies ",3)])])]}),_:1},8,["id","class","title","subTitle","tags","loading","isCollapsed","route"]))}}),To={key:0,class:"grid grid-cols-6 mb-5 gap-5"},Do={key:1,class:"grid grid-cols-6 lg:hidden mb-5"},Oo={class:"grid gap-4 md:gap-10 xl:gap-20"},Mo={key:2,class:"flex justify-center mt-5"},Lo=q({__name:"BlogPosts",props:{single:{type:Boolean}},emits:["createClicked","editClicked","deleteClicked"],setup(e){const c=le(),b=se(),{blogPosts:m,visibleBlogPosts:f,isBlogPostsFetchLoading:r}=O(b),{firebaseUser:v,isLoggedIn:E,isOwner:w}=O(c),{fetchBlogPosts:S}=b;co();const y=n(),I=n(),P=n(),p=async t=>{var a;m.value.visibility!==t&&(m.value.data[t].length||await S((a=v.value)==null?void 0:a.uid,{visibility:t}),m.value.visibility=t,m.value.isLastPage=!1,ce(y.value))},C=async()=>{var a;const t=f.value.length;await S((a=v.value)==null?void 0:a.uid),f.value[t]&&ce(I.value[t])};return Le(()=>{m.value.loadedOnce||(E.value?p("private"):m.value.visibility!=="public"&&p("public"),m.value.loadedOnce=!0)}),ie(()=>{var t;return(t=I.value)==null?void 0:t.length},()=>{var t;if((t=I.value)!=null&&t.length&&P.value){const a=f.value.find(s=>s.id===P.value);if(a){const s=f.value.indexOf(a);ce(I.value[s]),P.value=void 0}}}),(t,a)=>(i(),B("div",{ref_key:"container",ref:y},[o(E)?(i(),B("div",To,[d(j,{class:"hidden lg:block col-span-2",type:"secondary",outlined:o(m).visibility!=="public",loading:o(m).isLoading.public.fetch,label:"Public Posts",onClick:a[0]||(a[0]=s=>p("public"))},null,8,["outlined","loading"]),o(w)?(i(),h(j,{key:0,class:"col-span-full md:col-start-2 md:col-span-4 lg:col-start-3 lg:col-span-2",type:"tertiary",label:"New Post",onClick:a[1]||(a[1]=s=>t.$emit("createClicked"))})):U("",!0),d(j,{class:"hidden lg:block col-start-5 col-span-2",type:"secondary",outlined:o(m).visibility!=="private",loading:o(m).isLoading.private.fetch,label:"Private Posts",onClick:a[2]||(a[2]=s=>p("private"))},null,8,["outlined","loading"])])):U("",!0),o(E)?(i(),B("div",Do,[d(j,{class:"col-span-3 md:col-start-2 md:col-span-2 rounded-r-none",type:"secondary",outlined:o(m).visibility!=="public",loading:o(m).isLoading.public.fetch,label:"Public Posts",onClick:a[3]||(a[3]=s=>p("public"))},null,8,["outlined","loading"]),d(j,{class:"col-span-3 md:col-start-4 md:col-span-2 rounded-l-none",type:"secondary",outlined:o(m).visibility!=="private",loading:o(m).isLoading.private.fetch,label:"Private Posts",onClick:a[4]||(a[4]=s=>p("private"))},null,8,["outlined","loading"])])):U("",!0),T("div",Oo,[o(f).length?(i(!0),B(K,{key:0},Ae(o(f),(s,$)=>(i(),B("div",{key:s.id,ref_for:!0,ref_key:"posts",ref:I},[$===0||s.datePinned?(i(),h(Re,{key:0,post:s,onEditClicked:k=>t.$emit("editClicked",s),onDeleteClicked:k=>t.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"])):(i(),h(Eo,{key:1,post:s,onEditClicked:k=>t.$emit("editClicked",s),onDeleteClicked:k=>t.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"]))]))),128)):o(r)?(i(),h(be,{key:1,class:"!bg-neutral-600 !bg-opacity-40 !rounded-primary",title:"Loading..."})):(i(),h(be,{key:2,class:"!bg-red-900 !bg-opacity-40 !rounded-primary",title:"No posts"}))]),o(m).isLastPage?U("",!0):(i(),B("div",Mo,[d(j,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:o(f).length>0&&o(r),label:"Load more posts",onClick:C},null,8,["loading"])]))],512))}}),Ao=q({__name:"BlogPostContentDialogDeprecated",emits:["update:selected","error"],setup(e,{expose:c,emit:b}){const m=b,f=ae(),{blogPostOriginal:r,blogPostMutation:v,isOpen:E}=O(f),w=n(),S=n(),y=n(),I=n(),P=n(),p=n(),C=n([]),t=n(),a=n(),s=n(),$=n(),k=n(!1),V=n(!1),M=n({}),Y=D(()=>[t.value,a.value,s.value,$.value,k.value,V.value,Object.values(M.value).some(A=>A)].some(A=>!!A));return c({test:async()=>{for(const A of C.value)await A.test();await Promise.all([w.value.test(),S.value.test(),y.value.test(),P.value.test(),p.value.test()]),m("error",Y.value),M.value={}}}),(A,g)=>(i(),B(K,null,[d(ao,{ref_key:"title",ref:w,name:"title",label:"Title",placeholder:"Amazing Post",modelValue:o(v).title,"onUpdate:modelValue":g[0]||(g[0]=l=>o(v).title=l),error:t.value,"onUpdate:error":g[1]||(g[1]=l=>t.value=l),rules:[o(re).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),o(E)?(i(),h(o(_e),{key:0,onTabOpen:o(Fe)},{default:L(()=>[d(o(te),{header:"Modules"},{default:L(()=>[d(no,{modelValue:o(v).content,"onUpdate:modelValue":g[2]||(g[2]=l=>o(v).content=l)},null,8,["modelValue"])]),_:1}),d(o(te),{header:"Deprecated Content"},{default:L(()=>[d(Ue,{ref_key:"description",ref:S,name:"description",label:"Description",placeholder:"Something about my post...",modelValue:o(v).description,"onUpdate:modelValue":g[3]||(g[3]=l=>o(v).description=l),error:a.value,"onUpdate:error":g[4]||(g[4]=l=>a.value=l),"max-length":1e4},null,8,["modelValue","error"]),d(ro,{ref_key:"coverImageUrl",ref:I,id:"coverImageUrl",name:"coverImageUrl",label:"Cover image",modelValue:o(v).coverImageUrl,"onUpdate:modelValue":g[5]||(g[5]=l=>o(v).coverImageUrl=l),error:$.value,"onUpdate:error":g[6]||(g[6]=l=>$.value=l),"blog-post":o(r)??void 0},null,8,["modelValue","error","blog-post"]),d(Ue,{ref_key:"descriptionFooter",ref:y,name:"descriptionFooter",label:"Footer",placeholder:"Some beautiful ending...",modelValue:o(v).descriptionFooter,"onUpdate:modelValue":g[7]||(g[7]=l=>o(v).descriptionFooter=l),error:s.value,"onUpdate:error":g[8]||(g[8]=l=>s.value=l),"max-length":1e4},null,8,["modelValue","error"]),d(Ve,{ref_key:"countdown",ref:P,name:"countdown",label:"Countdown",modelValue:o(v).countdown,"onUpdate:modelValue":g[9]||(g[9]=l=>o(v).countdown=l),error:k.value,"onUpdate:error":g[10]||(g[10]=l=>k.value=l)},null,8,["modelValue","error"]),d(Ve,{ref_key:"timer",ref:p,name:"timer",label:"Timer",modelValue:o(v).timer,"onUpdate:modelValue":g[11]||(g[11]=l=>o(v).timer=l),error:V.value,"onUpdate:error":g[12]||(g[12]=l=>V.value=l)},null,8,["modelValue","error"]),d(so,{name:"table",label:"Table",modelValue:o(v).table,"onUpdate:modelValue":g[13]||(g[13]=l=>o(v).table=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["onTabOpen"])):U("",!0)],64))}}),_o=q({__name:"BlogPostSettingsDialog",emits:["error"],setup(e,{expose:c,emit:b}){const m=b,f=le(),r=Pe(),v=ae(),{publicUser:E,publicUsers:w}=O(r),{firebaseUser:S}=O(f),{blogPostMutation:y}=O(v),{allowedPublicUsers:I}=r,P=n(),p=n(),C=n(),t=n(),a=D({get(){return!!y.value.datePinned},set(l){y.value.datePinned=l?new Date:null}}),s=n(),$=n(),k=n(),V=n(),M=D(()=>[s.value,$.value,k.value,V.value].some(l=>!!l)),Y=D(()=>w.value.map(({id:l,displayName:u})=>({value:l,label:u}))),z=n([]),A=l=>{y.value.allowedUserIds=l},g=async()=>{y.value.allowedUserIds.length&&!z.value.length&&(s.value="Invalid user ID's"),await Promise.all([p.value.test(),C.value.test(),t.value.test()]),m("error",M.value)};return ie(()=>y.value.allowedUserIds,async l=>{z.value=await I(l)},{immediate:!0}),c({test:g}),(l,u)=>(i(),B(K,null,[d(G,{ref_key:"allowedUsers",ref:P,name:"allowedUserIds",label:"Allowed users",placeholder:"This post is public","model-value":o(y).allowedUserIds,error:s.value,"onUpdate:error":u[0]||(u[0]=_=>s.value=_),"onUpdate:arrayValue":A,options:[{value:o(S).uid,label:o(E).displayName},...Y.value.filter(({value:_})=>{var ne;return _!==((ne=o(S))==null?void 0:ne.uid)})],multiple:""},null,8,["model-value","error","options"]),d(me,{ref_key:"pinned",ref:t,name:"pinned",label:"Pinned",modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=_=>a.value=_)},null,8,["modelValue"]),d(me,{ref_key:"locked",ref:p,name:"locked",label:"Locked for commenting",modelValue:o(y).locked,"onUpdate:modelValue":u[2]||(u[2]=_=>o(y).locked=_)},null,8,["modelValue"]),d(me,{ref_key:"archived",ref:C,name:"archived",label:"Archived",modelValue:o(y).archived,"onUpdate:modelValue":u[3]||(u[3]=_=>o(y).archived=_)},null,8,["modelValue"])],64))}}),Fo=q({__name:"BlogPostStylingDialog",emits:["error"],setup(e,{expose:c,emit:b}){const m=b,f=ae(),{blogPostMutation:r}=O(f),v=n(),E=n(),w=n(),S=n(),y=n(),I=n(),P=n(),p=n(),C=n(),t=n(),a=n(),s=n(),$=n(),k=n(),V=n(),M=n(),Y=D(()=>[C.value,t.value,a.value,s.value,$.value,k.value,V.value,M.value].some(g=>!!g)),z=D(()=>io(Ie.find(g=>g.value===r.value.colorPrimary)));return c({test:async()=>{await Promise.all([v.value.test(),E.value.test(),w.value.test(),S.value.test(),y.value.test(),I.value.test(),P.value.test(),p.value.test()]),m("error",Y.value)}}),(g,l)=>(i(),B(K,null,[d(G,{ref_key:"alignment",ref:v,name:"alignment",label:"Alignment",modelValue:o(r).alignment,"onUpdate:modelValue":l[0]||(l[0]=u=>o(r).alignment=u),error:C.value,"onUpdate:error":l[1]||(l[1]=u=>C.value=u),options:o(Be),rules:[o(re).Required]},null,8,["modelValue","error","options","rules"]),d(G,{ref_key:"tableAlignment",ref:E,name:"tableAlignment",label:"Table Alignment",modelValue:o(r).tableAlignment,"onUpdate:modelValue":l[2]||(l[2]=u=>o(r).tableAlignment=u),error:t.value,"onUpdate:error":l[3]||(l[3]=u=>t.value=u),options:o(Be),rules:[o(re).Required]},null,8,["modelValue","error","options","rules"]),d(G,{ref_key:"colorPrimary",ref:w,name:"colorPrimary",label:"Primary Style",modelValue:o(r).colorPrimary,"onUpdate:modelValue":l[4]||(l[4]=u=>o(r).colorPrimary=u),error:a.value,"onUpdate:error":l[5]||(l[5]=u=>a.value=u),options:o(Ie),rules:[o(re).Required]},null,8,["modelValue","error","options","rules"]),d(G,{ref_key:"opacityPrimary",ref:I,name:"opacityPrimary",label:"Primary Opacity",modelValue:o(r).opacityPrimary,"onUpdate:modelValue":l[6]||(l[6]=u=>o(r).opacityPrimary=u),error:k.value,"onUpdate:error":l[7]||(l[7]=u=>k.value=u),options:o(ve)},null,8,["modelValue","error","options"]),d(G,{ref_key:"colorSecondary",ref:S,name:"colorSecondary",label:"Secondary Style",modelValue:o(r).colorSecondary,"onUpdate:modelValue":l[8]||(l[8]=u=>o(r).colorSecondary=u),error:s.value,"onUpdate:error":l[9]||(l[9]=u=>s.value=u),options:z.value},null,8,["modelValue","error","options"]),d(G,{ref_key:"opacitySecondary",ref:P,name:"opacitySecondary",label:"Secondary Opacity",modelValue:o(r).opacitySecondary,"onUpdate:modelValue":l[10]||(l[10]=u=>o(r).opacitySecondary=u),error:V.value,"onUpdate:error":l[11]||(l[11]=u=>V.value=u),options:o(ve)},null,8,["modelValue","error","options"]),d(G,{ref_key:"colorTertiary",ref:y,name:"colorTertiary",label:"Tertiary Style",modelValue:o(r).colorTertiary,"onUpdate:modelValue":l[12]||(l[12]=u=>o(r).colorTertiary=u),error:$.value,"onUpdate:error":l[13]||(l[13]=u=>$.value=u),options:o(uo)},null,8,["modelValue","error","options"]),d(G,{ref_key:"opacityTertiary",ref:p,name:"opacityTertiary",label:"Tertiary Opacity",modelValue:o(r).opacityTertiary,"onUpdate:modelValue":l[14]||(l[14]=u=>o(r).opacityTertiary=u),error:M.value,"onUpdate:error":l[15]||(l[15]=u=>M.value=u),options:o(ve)},null,8,["modelValue","error","options"])],64))}}),Ro=q({__name:"BlogPostDialog",emits:["scroll-to-updated"],setup(e,{emit:c}){const b=c,m=le(),f=se(),r=ae(),{firebaseUser:v}=O(m),{isBlogPostsMutationLoading:E}=O(f),{createBlogPost:w,updateBlogPost:S,deleteFilesOfBlogPost:y,toggleBlogPostVisibility:I}=f,{getBlogPostMutationContent:P,getBlogPostMutationStyling:p,getBlogPostMutationSettings:C}=r,{isOpen:t,blogPostOriginal:a,blogPostMutationId:s,blogPostMutation:$,hasBlogPostMutationContentChanges:k,hasBlogPostMutationStylingChanges:V,hasBlogPostMutationSettingsChanges:M}=O(r),Y=n(),z=n(),A=n(),g=n(),l=n(!1),u=n(!1),_=n(!1),ne=D(()=>{var F,R,N,X,Z,x;return!!((R=(F=a.value)==null?void 0:F.allowedUserIds)!=null&&R.length)&&!((N=C().allowedUserIds)!=null&&N.length)||!((Z=(X=a.value)==null?void 0:X.allowedUserIds)!=null&&Z.length)&&!!((x=C().allowedUserIds)!=null&&x.length)}),xe=D(()=>{const F=[];return k.value&&F.push("Content"),V.value&&F.push("Styling"),M.value&&F.push("Settings"),F.length?"Update "+Ee(F):void 0}),ue=D(()=>po(a.value)),je=async()=>{var F,R,N,X,Z;if(await Promise.all([z.value.test(),A.value.test(),g.value.test()]),!(l.value||u.value||_.value))if(!a.value)await w(s.value,$.value,(F=v.value)==null?void 0:F.uid)&&(r.close(),b("scroll-to-updated",s.value));else if(ne.value){const x=s.value;r.isOpen=!1,await I(x,H.convert($.value),a.value.reactions,$.value.allowedUserIds.length?"private":"public",(R=v.value)==null?void 0:R.uid)&&(r.close(),ke.success("Successfully updated Post Visibility"),b("scroll-to-updated",x))}else{const x=s.value;let Q=[];k.value&&Q.push(await S(x,P(),ue.value,(N=v.value)==null?void 0:N.uid)),V.value&&Q.push(await S(x,p(),ue.value,(X=v.value)==null?void 0:X.uid)),M.value&&(Q.push(await S(x,C(),ue.value,(Z=v.value)==null?void 0:Z.uid)),b("scroll-to-updated",x)),Q=Q.filter(qe=>typeof qe=="string"),Q.length&&(ke.success(`Successfully updated Post ${Ee(Q)}`),r.close())}},Ge=async()=>{y($.value,a.value??void 0),r.close()};return ie($,()=>{r.isMutationEqual()},{deep:!0}),(F,R)=>(i(),h(Oe,{isOpen:o(t),title:o(a)?"Update Post":"Create Post",description:o(a)?"Update this post":"Create a new post","confirm-text":o(a)?xe.value:"Create","confirm-loading":o(E),onConfirm:je,onCancel:Ge},{default:L(()=>[T("form",{ref_key:"dialog",ref:Y,class:"pt-6 mb-4 xl:px-16"},[o(t)?(i(),h(o(_e),{key:0,"active-index":0,onTabOpen:o(Fe)},{default:L(()=>[d(o(te),{header:"Content"},{default:L(()=>[d(Ao,{ref_key:"content",ref:z,onError:R[0]||(R[0]=N=>l.value=N)},null,512)]),_:1}),d(o(te),{header:"Styling"},{default:L(()=>[d(Fo,{ref_key:"styling",ref:A,onError:R[1]||(R[1]=N=>u.value=N)},null,512)]),_:1}),d(o(te),{header:"Settings"},{default:L(()=>[d(_o,{ref_key:"settings",ref:g,onError:R[2]||(R[2]=N=>_.value=N)},null,512)]),_:1})]),_:1},8,["onTabOpen"])):U("",!0)],512)]),_:1},8,["isOpen","title","description","confirm-text","confirm-loading"]))}}),No={class:"grid mt-10 md:mt-15"},xo={class:"grid justify-center"},jo={class:"text-lg md:text-xl text-white"},Go=["innerHTML"],qo={class:"grid my-5 xl:px-20"},zo=q({__name:"Blog",setup(e){const c=Me(),b=Ce(),m=Pe(),f=se(),r=ae(),{menuItems:v,content:E}=O(b),{publicUser:w}=O(m),{deleteBlogPost:S}=f,y=n(null),I=n(),P=n(!1),p=n(c.currentRoute.value.params.postId),C=D(()=>{var k;return w.value?[...E.value.blogDescriptionUser.map(V=>V.replace("%USER%",w.value.displayName||"Unknown user")),...((k=v.value.find(V=>V.id==="nfNQM4SMESU2VOkJtcgY"))==null?void 0:k.description)||[]]:E.value.blogDescriptionGuest}),t=()=>{r.openWith(null)},a=k=>{r.openWith(k)},s=k=>{y.value=k,P.value=!0},$=async k=>{await S(k)&&(P.value=!1,y.value=null)};return ie(c.currentRoute,k=>{p.value=k.params.postId}),(k,V)=>(i(),h(ze,null,{content:L(()=>[T("div",No,[T("div",xo,[(i(!0),B(K,null,Ae(C.value,M=>(i(),B("h1",jo,[T("span",{innerHTML:M},null,8,Go)]))),256))]),T("div",qo,[p.value?(i(),h(go,{key:0,onEditClicked:a,onDeleteClicked:s})):(i(),h(Lo,{key:1,onCreateClicked:t,onEditClicked:a,onDeleteClicked:s})),d(Ro,{onScrollToUpdated:V[0]||(V[0]=M=>I.value=M)}),y.value?(i(),h(Oe,{key:2,title:"Delete Post",isOpen:P.value,description:[` Are you sure you want to delete this post called ' ${y.value.title}'?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{type:"danger",outlined:!0},onConfirm:V[1]||(V[1]=M=>$(y.value.id)),onCancel:V[2]||(V[2]=M=>P.value=!1)},null,8,["isOpen","description"])):U("",!0)])])]),_:1}))}}),Qo=q({__name:"Blog",setup(e){return(c,b)=>(i(),h(zo))}});export{Qo as default};
