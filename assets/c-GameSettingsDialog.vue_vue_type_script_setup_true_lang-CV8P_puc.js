import{_ as he}from"./c-Dialog.vue_vue_type_script_setup_true_lang-BZM7B_wv.js";import{a$ as ke,b0 as W,s as M,w as k,a9 as ge,f as E,o as le,aS as m,L as Se,b1 as Q,b3 as be,b2 as Ae,b4 as Ie,d as Ee,aZ as Ce,a_ as _e,aT as Oe,l as H,j as R,A as Pe,k as Te,m as w,h as g,an as D,U as X,T as ee}from"../bundle.js";var He=(s=>(s.HEARTS="hearts",s.SPADES="spades",s.DIAMONDS="diamonds",s.CLUBS="clubs",s))(He||{});const j={hearts:{label:"Hearts",color:"red"},spades:{label:"Spades",color:"black"},diamonds:{label:"Diamonds",color:"red"},clubs:{label:"Clubs",color:"black"}};var Re=(s=>(s.STOCK_CLOSED="stock_closed",s.STOCK_OPEN="stock_open",s.PILE1="pile1",s.PILE2="pile2",s.PILE3="pile3",s.PILE4="pile4",s.PILE5="pile5",s.PILE6="pile6",s.PILE7="pile7",s.HEARTS="hearts",s.SPADES="spades",s.DIAMONDS="diamonds",s.CLUBS="clubs",s))(Re||{}),De=(s=>(s[s.HAS_NOT_STARTED=0]="HAS_NOT_STARTED",s[s.HAS_STARTED=1]="HAS_STARTED",s[s.HAS_FINISHED=2]="HAS_FINISHED",s))(De||{});const Me={easy:.5,hard:1},se=()=>{const s=Le();return be(s),{pile1:s.splice(0,1).map(a=>({...a,deck:"pile1"})),pile2:s.splice(0,2).map((a,c)=>c<1?{...a,hidden:!0,deck:"pile2"}:{...a,deck:"pile2"}),pile3:s.splice(0,3).map((a,c)=>c<2?{...a,hidden:!0,deck:"pile3"}:{...a,deck:"pile3"}),pile4:s.splice(0,4).map((a,c)=>c<3?{...a,hidden:!0,deck:"pile4"}:{...a,deck:"pile4"}),pile5:s.splice(0,5).map((a,c)=>c<4?{...a,hidden:!0,deck:"pile5"}:{...a,deck:"pile5"}),pile6:s.splice(0,6).map((a,c)=>c<5?{...a,hidden:!0,deck:"pile6"}:{...a,deck:"pile6"}),pile7:s.splice(0,7).map((a,c)=>c<6?{...a,hidden:!0,deck:"pile7"}:{...a,deck:"pile7"}),stock_closed:s.map(a=>({...a,hidden:!0,deck:"stock_closed"})),stock_open:[],hearts:[],spades:[],diamonds:[],clubs:[]}},Ne=ke("patienceStore",()=>{const s=W(),{personalBest:a,highscorePosition:c}=M(s),{setPreviousHighscores:S,updateHighscores:b,sortHighscores:C}=s,h=k("hard"),v=k(0),A=k(0),u=k(0),i=k(0),d=k(0),N=k(),L=k(!0),n=ge(se()),P=E(()=>Me[h.value]),_=E(()=>Object.keys(n).flatMap(e=>n[e])),te=1e3,Y=10,oe=10,Z=E(()=>{const e=u.value%10===0?u.value:Math.floor(u.value/10)*10,l=A.value*Y,t=d.value*Y,o=e+l+t,r=i.value*oe;return Math.max(0,te-(o-r))}),ae=E(()=>{const e=Math.floor(u.value/60),l=u.value%60;return`${String(e).padStart(2,"0")}:${String(l).padStart(2,"0")}`}),ne=E(()=>n.hearts.length===13&&n.spades.length===13&&n.diamonds.length===13&&n.clubs.length===13);le(()=>{s.$init(m.PATIENCE),u.value&&v.value===1&&G()}),Se(ne,e=>{e&&v.value!==2&&(V(),v.value=2,z(),Q(Ae))});const ce=()=>{V(),A.value=0,u.value=0,i.value=0,d.value=0,v.value=0,Object.assign(n,se()),s.setPreviousHighscores()},re=()=>{u.value=0,G(),v.value=1,setTimeout(()=>{B()},500)},G=()=>{N.value&&V(),N.value=setInterval(()=>{u.value++},1e3)},V=()=>{clearInterval(N.value)},ue=()=>{const e=n.stock_open;e.length&&(e.reverse(),O(e[0],!1,l=>{l.deck="stock_closed",l.hidden=!0,n.stock_closed.push(l)}),e.splice(0,e.length),f(1))},ie=e=>{const l=e.deck,t=_.value.filter(o=>o.selected);if(l==="stock_closed"){const o=n.stock_closed,r=o.indexOf(e);if(r===o.length-1){const I=h.value==="hard"?r-2:r,p=I<0?0:I,F=o.filter((J,me)=>me>=p);K(),x(F,"stock_open",J=>{J.hidden=!1}),f(0)}}else if(l==="stock_open"){const o=n.stock_open;o.indexOf(e)===o.length-1&&(e.selected=!e.selected,t.length&&O(t[0],!1))}else if(t.length){const o=t[0];o===e?O(e,!1):T(l)&&fe(o,e)?e.value===o.value+1&&e.deck!==o.deck&&(x(t,l),o.deck==="stock_open"?f(2):f(4)):t.length===1&&$(l)&&ve(o,e)&&e.value===o.value-1&&(y(o,l),f(3),o.hasBeenHome=!0)}else O(e,!0)},de=e=>{const l=_.value.filter(t=>t.selected);if(l.length){const t=l[0],o=t.deck;t.value===13&&(x(l,e),o==="stock_open"?f(2):T(t.deck)&&n[t.deck].every(r=>!r.hidden)?f(5):f(4))}},pe=e=>{const l=_.value.filter(t=>t.selected);if(l.length===1){const t=l[0],o=t.type;!n[e].length&&o===e&&t.value===1&&(y(t,e),f(3))}},O=(e,l,t)=>{const o=n[e.deck],r=o.indexOf(e);o.filter((p,F)=>F>=r).forEach(p=>{p.selected=l,t==null||t(p)})},K=()=>{_.value.forEach(e=>{e.selected=!1})},y=(e,l)=>{const t=e.deck,o=n[t].indexOf(e);e.deck=l,e.selected=!1,n[l].push(e),n[t].splice(o,1),(T(t)||t==="stock_open")&&U(t)},x=(e,l,t)=>{const o=e[0],r=o.deck,I=n[r].indexOf(o);O(o,!1,p=>{p.deck=l,t==null||t(p),n[l].push(p)}),n[r].splice(I,e.length),$(r)||U(r!=="stock_closed"?r:l)},q=e=>{if(!L.value)return!0;const l=n[e.type],t=l.length?l[l.length-1].value:0;if(e.value===t+1){const o=["hearts","spades","diamonds","clubs"],r=t<=1||o.every(I=>{const p=n[I];return(p.length?p[p.length-1].value:0)>=t});if(t===0||r)return y(e,e.type),e.hasBeenHome=!0,f(3),!0}return!1},B=()=>{if(L.value)for(const e of["stock_open","pile1","pile2","pile3","pile4","pile5","pile6","pile7"]){const l=n[e];if(l.length&&q(l[l.length-1]))return}},U=e=>{const l=n[e];if(l.length){const t=l[l.length-1],o=t.deck;t.hidden=!1,setTimeout(()=>{t.deck===o&&(q(t)||B())},500)}else setTimeout(()=>{B()},500)},f=e=>{switch(e!==5&&A.value++,e){case 0:{d.value+=2*P.value;break}case 1:{d.value+=5*P.value;break}case 2:{i.value+=10*P.value;break}case 3:{i.value+=20*P.value;break}}Q(Ie)},fe=(e,l)=>e.color!==l.color,ve=(e,l)=>e.type===l.type,T=e=>["pile1","pile2","pile3","pile4","pile5","pile6","pile7"].includes(e),$=e=>["hearts","spades","diamonds","clubs"].includes(e),z=()=>{b({difficulty:h.value,score:Z.value,bonus:i.value,time:u.value,turns:A.value,penalty:d.value})};return{difficulty:h,gameStatus:v,score:Z,turns:A,time:u,bonus:i,penalty:d,cards:n,doAutocomplete:L,allCards:_,formattedTime:ae,personalBest:a,highscorePosition:c,$reset:ce,start:re,shuffle:ue,selectCard:ie,selectEmptyDeck:de,selectFinalDeck:pe,deselectAllCards:K,isPlayDeck:T,isFinalDeck:$,setPreviousHighscores:S,updatePatienceHighscore:z,sortHighscores:C}},{persist:{enabled:!0}}),Le=()=>Object.keys(j).flatMap(s=>{const a=s,c=[];for(let S=0;S<13;S++){const b={type:a,label:j[a].label,color:j[a].color,value:S+1,hidden:!1,selected:!1,hasBeenHome:!1};c.push(b)}return c}),xe=Ee({__name:"GameSettingsDialog",props:Ce({gameId:{}},{isOpen:{type:Boolean,required:!0},isOpenModifiers:{}}),emits:["update:isOpen"],setup(s){const a=s,c=_e(s,"isOpen"),S=W(),{useAudio:b,diceRollSpeed:C}=M(W()),{robotSpeed:h}=M(Oe()),{doAutocomplete:v}=M(Ne()),A=E(()=>{switch(a.gameId){case m.YAHTZEE:return"v5 (12-12-2024)";case m.RAINWORMS:return"v5 (12-12-2024)";case m.PATIENCE:return"v2 (16-12-2024)";case m.GUESS_THE_WORD:return"v2 (10-01-2025)"}});return le(()=>{S.$init(a.gameId)}),(u,i)=>(R(),H(he,{isOpen:c.value,title:"Game Settings",description:u.gameId?`Current version: ${A.value}`:"General settings",cancelText:"Close",onCancel:i[4]||(i[4]=d=>c.value=!1)},{default:Pe(()=>[Te(X,{name:"useAudio",label:"Audio",modelValue:g(b),"onUpdate:modelValue":i[0]||(i[0]=d=>D(b)?b.value=d:null)},null,8,["modelValue"]),u.gameId===g(m).PATIENCE?(R(),H(X,{key:0,name:"useAutocomplete",label:"Patience autocomplete",modelValue:g(v),"onUpdate:modelValue":i[1]||(i[1]=d=>D(v)?v.value=d:null)},null,8,["modelValue"])):w("",!0),u.gameId===g(m).YAHTZEE||u.gameId===g(m).RAINWORMS?(R(),H(ee,{key:1,name:"diceSpeed",label:"Dice rolling speed",modelValue:g(C),"onUpdate:modelValue":i[2]||(i[2]=d=>D(C)?C.value=d:null),options:[{value:.5,label:"0.5 seconds"},{value:.75,label:"0.75 seconds"},{value:1,label:"1 second"},{value:1.5,label:"1.5 seconds"},{value:2,label:"2 seconds"},{value:3,label:"3 seconds"},{value:4,label:"4 seconds"},{value:5,label:"5 seconds"}]},null,8,["modelValue"])):w("",!0),u.gameId===g(m).RAINWORMS?(R(),H(ee,{key:2,name:"robotSpeed",label:"Rainworms robot speed",modelValue:g(h),"onUpdate:modelValue":i[3]||(i[3]=d=>D(h)?h.value=d:null),options:[{value:.25,label:"0.25 seconds"},{value:.5,label:"0.5 seconds"},{value:.75,label:"0.75 seconds"},{value:1,label:"1 second"},{value:3,label:"3 seconds"},{value:5,label:"5 seconds"}]},null,8,["modelValue"])):w("",!0)]),_:1},8,["isOpen","description"]))}});export{He as C,Re as D,De as G,xe as _,Ne as u};
