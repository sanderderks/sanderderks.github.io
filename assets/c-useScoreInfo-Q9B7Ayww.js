import{_ as I}from"./c-Bubble.vue_vue_type_script_setup_true_lang-BKzNF-TX.js";import{r as H,c,ax as O,e as q,C as J,aT as R,a9 as X,s as S,o as $,ap as Y,N as K,l as t,m as o,q as n,n as U,k as e,J as a,aR as G,p as w,w as i,x as N,P as Q,H as C,D as W,ac as Z,G as ee,t as A,h as te}from"../bundle.js";import{_ as se}from"./c-_plugin-vue_export-helper-DlAUqK2U.js";const oe=(d,h)=>{const g=H(0),v=c(()=>O(d)),m=c(()=>(g.value+1)*h),p=c(()=>m.value-h),_=c(()=>g.value>0),y=c(()=>v.value.length>m.value),k=c(()=>v.value.filter((b,r)=>r>=p.value&&r<m.value));return{page:g,perPage:h,visibleData:k,hasPrevious:_,hasNext:y}},ne={class:"mt-5 flex justify-center"},ae={class:"w-full overflow-x-auto"},le={class:"w-full mt-5 text-sm md:text-base text-left text-nowrap"},re={key:0},ue={key:0},ie={key:1},ce={key:1},de={key:0},he={key:1},ve={key:2},fe={key:3},ge={key:2},me={key:3},_e={key:0},ye={key:1},pe={key:4},ke={colspan:"100%"},be=q({__name:"Highscores",props:{gameId:{},unit:{}},setup(d){const h=d,g=J(),v=R(),m=X(),{publicUsers:p}=S(g),{allGameData:_,fetchLoading:y}=S(v),{language:k}=S(m),{fetchGameData:b,fetchHighscores:r,fetchScores:T}=v,u=H("highscores"),B=H(),V=c(()=>_.value[h.gameId].gameData[u.value]),{page:D,perPage:j,visibleData:f,hasPrevious:P,hasNext:L}=oe(()=>V.value,10),F=x=>{var l;return((l=p.value.find(s=>s.id===x))==null?void 0:l.displayName)??"Unknown"},z=()=>{u.value==="highscores"?r():T()};return $(()=>{v.$init(h.gameId),b(),B.value=setInterval(()=>{b()},1e3*60*5)}),Y(()=>{clearInterval(B.value)}),K(u,()=>{_.value[h.gameId].gameData[u.value].length||z()}),(x,l)=>(t(),o(N,null,[n("div",ne,[U(I,{class:"w-1/2 md:w-1/4 rounded-r-none",type:"secondary",outlined:u.value==="scores",label:"Highscores",onClick:l[0]||(l[0]=s=>u.value="highscores")},null,8,["outlined"]),U(I,{class:"w-1/2 md:w-1/4 rounded-l-none",type:"secondary",outlined:u.value==="highscores",label:"All Scores",onClick:l[1]||(l[1]=s=>u.value="scores")},null,8,["outlined"])]),n("div",ae,[n("table",le,[e(f).length?(t(),o("thead",re,[n("tr",null,[n("th",null,a(e(G)("Positie","Rank")),1),n("th",null,a(e(G)("Gebruiker","User")),1),l[4]||(l[4]=n("th",null,"Score",-1)),e(f).length&&e(f).some(s=>s.difficulty)?(t(),o("th",ue,a(e(w)("GAMES_DIFFICULTY")),1)):i("",!0),n("th",null,a(e(G)("Datum","Date")),1),e(f).length&&e(f).some(s=>s.bonus)?(t(),o("th",ie,"Bonus")):i("",!0)])])):i("",!0),e(f).length?(t(),o("tbody",ce,[(t(!0),o(N,null,Q(e(f),(s,M)=>(t(),o("tr",null,[n("th",null,a(M+1+e(D)*e(j)),1),n("th",null,a(F(s.userId??s.id)),1),n("td",null,[C(a(s.score)+" ",1),x.unit?(t(),o(N,{key:0},[C(a(x.unit),1),s.score!==1?(t(),o(N,{key:0},[C("s")],64)):i("",!0)],64)):i("",!0)]),s.difficulty?(t(),o("td",de,a(s.difficulty),1)):e(f).some(E=>E.difficulty)?(t(),o("td",he)):i("",!0),n("td",null,a(e(W)(s.date)),1),s.bonus?(t(),o("td",ve,a(s.bonus),1)):e(f).some(E=>E.bonus)?(t(),o("td",fe)):i("",!0)]))),256))])):e(y)?(t(),o("tbody",ge,[n("tr",null,[n("th",null,a(e(w)("GENERAL_LOADING"))+" highscores...",1)])])):(t(),o("tbody",me,[n("tr",null,[e(k)===e(Z).NL?(t(),o("th",_e,"Er zijn nog geen "+a(u.value==="highscores"?"highscores":"scores")+".",1)):(t(),o("th",ye,"There are no "+a(u.value==="highscores"?"highscores":"scores")+" yet.",1))])])),e(P)||e(L)?(t(),o("tfoot",pe,[n("tr",null,[n("td",ke,[n("div",{class:ee(["w-full p-2 flex",[e(P)?"justify-between":"justify-end"]])},[e(P)?(t(),A(I,{key:0,class:"w-fit",label:e(w)("GENERAL_PREVIOUS"),type:"neutral",onClick:l[2]||(l[2]=s=>D.value-=1)},null,8,["label"])):i("",!0),e(L)?(t(),A(I,{key:1,class:"w-fit",label:e(w)("GENERAL_NEXT"),type:"neutral",onClick:l[3]||(l[3]=s=>D.value+=1)},null,8,["label"])):i("",!0)],2)])])])):i("",!0)])])],64))}}),we=se(be,[["__scopeId","data-v-9b031951"]]),Ne=d=>{const h=te(),g=R(),{allGameData:v,highscorePosition:m,personalBest:p}=S(g),{firebaseUser:_}=S(h),y=c(()=>_.value?m.value:null),k=c(()=>{if(!d)return!1;const r=v.value[d].previousHighscorePosition;return y.value&&r?r>y.value:!1}),b=c(()=>{if(!d)return!1;const r=v.value[d].previousPersonalBest;return _.value&&r?r<p.value:!1});return $(()=>{g.$init(d)}),{currentHighscorePosition:y,hasImprovedHighscorePosition:k,hasImprovedPersonalBest:b}};export{we as H,Ne as u};
