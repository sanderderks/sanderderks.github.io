import{d as q,u as E,q as P,s as w,v as C,l as B,g as U,w as d,j as I,b as M,h as o,e as m,x as N,f as r,y as _,i as c,R,_ as T,z as b,A as j,B as A,C as G}from"../bundle.js";import{_ as O,a as z,b as F}from"./c-PasswordField.vue_vue_type_script_setup_true_lang-tE0yoL03.js";import{_ as J}from"./c-Page.vue_vue_type_script_setup_true_lang-j8RYmb9b.js";const h={class:"flex flex-col items-center content-center"},D={class:"grid grid-cols-4 mt-10 gap-3"},X=q({__name:"Login",setup(H){const p=A(),l=I(),y=E(),t=P(),{routeLoading:S}=w(y),{isLoggedIn:L,isLoginLoading:k}=w(t),{initEmail:n,initPassword:i}=l.currentRoute.value.query,u=b(),f=b(),e=C({email:{value:(n==null?void 0:n.toString())||"",error:""},password:{value:(i==null?void 0:i.toString())||"",error:""}}),g=G(()=>p.params.redirect?JSON.parse(p.params.redirect):void 0),x=async()=>{Object.keys(e).forEach(v=>e[v].error=""),await Promise.all([u.value.test(),f.value.test()]),!e.email.error&&!e.password.error&&(await t.login(e.email.value,e.password.value),L.value&&g.value&&l.push(g.value))},V=async()=>{await u.value.test(),e.email.error||t.resetPassword(e.email.value)};return B(()=>{l.replace({query:void 0})}),(v,a)=>{const $=j("RouterLink");return M(),U(J,null,{content:d(()=>[o(T,{class:"!bg-primary-800 !bg-opacity-50 my-5",title:"Login",description:"Please login using your e-mail and password."},{default:d(()=>[m("div",h,[m("form",{class:"w-full lg:w-1/2 xl:w-2/3 px-8 pt-6 pb-8 mb-4",onSubmit:a[4]||(a[4]=N(s=>x(),["prevent"]))},[o(O,{ref_key:"email",ref:u,name:"email",label:"E-mail",modelValue:e.email.value,"onUpdate:modelValue":a[0]||(a[0]=s=>e.email.value=s),error:e.email.error,"onUpdate:error":a[1]||(a[1]=s=>e.email.error=s),rules:[r(_).Required]},null,8,["modelValue","error","rules"]),o(z,{ref_key:"password",ref:f,name:"password",label:"Password",modelValue:e.password.value,"onUpdate:modelValue":a[2]||(a[2]=s=>e.password.value=s),error:e.password.error,"onUpdate:error":a[3]||(a[3]=s=>e.password.error=s),rules:[r(_).Required]},null,8,["modelValue","error","rules"]),m("div",D,[o(c,{class:"col-span-full md:col-span-2",type:"submit",label:"Login",loading:r(k)},null,8,["loading"]),o($,{class:"col-span-full md:col-span-2",to:{name:r(R).REGISTER,query:{initEmail:e.email.value,initPassword:e.password.value}}},{default:d(()=>[o(c,{class:"w-full",outlined:"",label:"Register",loading:r(S)===r(R).REGISTER},null,8,["loading"])]),_:1},8,["to"]),o(c,{class:"col-span-full md:col-span-2 md:col-start-3",outlined:"",variant:"neutral",label:"Forgot Password",onClick:V})])],32),o(F)])]),_:1})]),_:1})}}});export{X as default};
