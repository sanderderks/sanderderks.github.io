import{_ as Be}from"./c-Dialog.vue_vue_type_script_setup_true_lang-gllcCUGl.js";import{_ as Ae}from"./c-Page.vue_vue_type_script_setup_true_lang-BX8gkhZ9.js";import{c as Ne,B as Re,s as je,a as h,o as l,b as C,d as S,m as z,r as Y,e as G,u as Ge,f as Ee,g as be,h as ee,i as ae,j as D,k as _,l as Ie,n as Fe,F as ze,R as J,p as t,q as u,_ as W,t as b,v as F,w as ke,x as r,y as $e,z as fe,A as T,C as Q,D as ie,E as Pe,G as qe,H as Z,I as de,J as He,K as Ce,L as Je,M as ye,N as ne,O as ue,P as We,Q as Te,S as te,T as Ye,U as Ve,V as Qe,W as H,X as ce,Y as Ke,Z as we,$ as pe,a0 as Xe,a1 as he,a2 as Ze,a3 as et,a4 as tt,a5 as me,a6 as ve,a7 as ge,a8 as ot}from"../bundle.js";import{_ as lt}from"./c-BackButton.vue_vue_type_script_setup_true_lang-C4MDoQ1O.js";import{_ as De,a as Se,u as st}from"./c-BlogPost.vue_vue_type_script_setup_true_lang-DbMDEb-x.js";var at=Ne`
    .p-card {
        background: dt('card.background');
        color: dt('card.color');
        box-shadow: dt('card.shadow');
        border-radius: dt('card.border.radius');
        display: flex;
        flex-direction: column;
    }

    .p-card-caption {
        display: flex;
        flex-direction: column;
        gap: dt('card.caption.gap');
    }

    .p-card-body {
        padding: dt('card.body.padding');
        display: flex;
        flex-direction: column;
        gap: dt('card.body.gap');
    }

    .p-card-title {
        font-size: dt('card.title.font.size');
        font-weight: dt('card.title.font.weight');
    }

    .p-card-subtitle {
        color: dt('card.subtitle.color');
    }
`,nt={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},rt=Re.extend({name:"card",style:at,classes:nt}),it={name:"BaseCard",extends:je,style:rt,provide:function(){return{$pcCard:this,$parentInstance:this}}},Le={name:"Card",extends:it,inheritAttrs:!1};function dt(n,p,i,m,k,a){return l(),h("div",z({class:n.cx("root")},n.ptmi("root")),[n.$slots.header?(l(),h("div",z({key:0,class:n.cx("header")},n.ptm("header")),[Y(n.$slots,"header")],16)):C("",!0),S("div",z({class:n.cx("body")},n.ptm("body")),[n.$slots.title||n.$slots.subtitle?(l(),h("div",z({key:0,class:n.cx("caption")},n.ptm("caption")),[n.$slots.title?(l(),h("div",z({key:0,class:n.cx("title")},n.ptm("title")),[Y(n.$slots,"title")],16)):C("",!0),n.$slots.subtitle?(l(),h("div",z({key:1,class:n.cx("subtitle")},n.ptm("subtitle")),[Y(n.$slots,"subtitle")],16)):C("",!0)],16)):C("",!0),S("div",z({class:n.cx("content")},n.ptm("content")),[Y(n.$slots,"content")],16),n.$slots.footer?(l(),h("div",z({key:1,class:n.cx("footer")},n.ptm("footer")),[Y(n.$slots,"footer")],16)):C("",!0)],16)],16)}Le.render=dt;const ut={key:0,class:"flex justify-center mt-5"},ct={key:1,class:"flex flex-col gap-3"},pt=G({__name:"BlogDetails",emits:["createClicked","editClicked","deleteClicked"],setup(n){const p=Ge(),i=Ee(),m=be(),k=ee(),a=ae(),{routeLoading:U}=D(m),{isLoggedIn:E}=D(k),{blogPosts:w,blogReactions:B,isBlogPostsFetchLoading:d}=D(a),{fetchBlogPost:y}=a,v=_(()=>p.params.postId);return Ie(async()=>{var c;if(B.value.unread=[],v.value)if(((c=w.value.data.single)==null?void 0:c.id)!==v.value){const $=await y(v.value);if(Fe($)&&$===ze.PERMISSION_DENIED&&!E.value){i.push({name:J.LOGIN,params:{redirect:JSON.stringify({name:J.BLOG_DETAILS,params:{postId:v.value}})}});return}}else w.value.data.single}),(c,$)=>t(d)?(l(),h("div",ut,[u(W,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:"",label:"Loading..."})])):(l(),h("div",ct,[u(lt,{"back-route":t(J).BLOG,label:"Back to other posts"},null,8,["back-route"]),t(w).data.single?(l(),b(De,{key:0,post:t(w).data.single,onEditClicked:$[0]||($[0]=e=>c.$emit("editClicked",t(w).data.single)),onDeleteClicked:$[1]||($[1]=e=>c.$emit("deleteClicked",t(w).data.single))},null,8,["post"])):C("",!0)]))}}),Ue=G({__name:"BlogPostSectionTitle",props:{class:{},alignment:{},isExpandable:{type:Boolean},isExpanded:{type:Boolean},isSubTitle:{type:Boolean}},emits:["click"],setup(n){const p=n;return(i,m)=>(l(),h("div",{class:F(["font-bold",{"text-lg md:text-2xl":!i.isSubTitle},{"hover:underline cursor-pointer":i.isExpandable},p.class])},[S("div",{class:F({block:!i.alignment,flex:!!i.alignment,"justify-start":i.alignment==="left","justify-center":i.alignment==="center","justify-end":i.alignment==="right"})},[S("span",{class:"flex",onClick:m[0]||(m[0]=k=>i.$emit("click"))},[i.isExpandable&&i.alignment==="right"?(l(),h("i",{key:0,class:F(["pi pi-angle-down animation",{"rotate-180":i.isExpanded}])},null,2)):C("",!0),Y(i.$slots,"default"),i.isExpandable&&(i.alignment==="left"||i.alignment==="center")?(l(),h("i",{key:1,class:F(["pi pi-angle-down animation",{"rotate-180":i.isExpanded}])},null,2)):C("",!0)])],2)],2))}}),mt={class:"flex gap-3"},vt={class:"min-h-[50vh] flex flex-col"},gt={class:"flex justify-between h-fit mt-2 gap-2"},ft={class:"flex flex-wrap gap-3"},yt={class:"relative mt-5 min-h-[20vh] max-h-screen flex flex-col justify-end"},bt={class:"relative min-h-[20vh] max-h-full flex-grow"},kt={class:"w-full"},$t={key:3,class:"w-full"},Pt={class:"flex justify-center mt-5"},Ct={class:"flex justify-center mt-3"},wt=G({__name:"BlogPostOverview",props:{post:{}},emits:["editClicked","deleteClicked"],setup(n){const p=n,i=be(),m=ee(),k=ke(),{routeLoading:a,routeLoadingId:U}=D(i),{publicUsers:E}=D(k),{isOwner:w}=D(m),B=r(p.post.archived),d=_(()=>{var e;return(e=p.post.allowedUserIds)!=null&&e.length?E.value.filter(o=>{var s;return(s=p.post.allowedUserIds)==null?void 0:s.includes(o.id)}):[]}),y=_(()=>{const e=$e(p.post.date);return p.post.dateUpdated?e+` - updated ${$e(p.post.dateUpdated)}`:e}),v=_(()=>{const e=[];return p.post.datePinned&&e.push({value:"Pinned",severity:"success",rounded:!1}),p.post.locked&&e.push({value:"Locked",severity:"danger",rounded:!1,icon:"pi pi-lock"}),p.post.archived&&e.push({value:"Archived",severity:"warning",rounded:!1,icon:"pi pi-file-excel"}),e}),c=_(()=>p.post.sections.length?p.post.sections[0]:null),$=()=>{const e=document.createElement("textarea"),{protocol:o,hostname:s,port:I}=window.location,P=`${o}//${s}`+(s==="localhost"?`:${I}`:"");e.value=`${P}#${Je.BLOG.path}/${p.post.id}`,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),ye.success("Copied link!")};return(e,o)=>(l(),b(fe,{id:e.post.id,class:F([{"min-h-[50vh]":!B.value},"border-4 border-transparent","!rounded-primary",e.post.colorSecondary||e.post.colorPrimary||"bg-secondary-900",e.post.opacitySecondary||"bg-opacity-50"]),title:e.post.title,subTitle:y.value,tags:v.value,loading:e.post.loading,isCollapsed:B.value,clickable:"",route:{name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}},{right:T(()=>[S("div",mt,[B.value?t(w)?(l(),b(Se,{key:1,onEditClicked:o[0]||(o[0]=s=>e.$emit("editClicked")),onDeleteClicked:o[1]||(o[1]=s=>e.$emit("deleteClicked"))})):C("",!0):(l(),b(W,{key:0,class:"border-none h-fit",variant:"neutral",icon:"pi pi-copy",onClick:$}))])]),default:T(()=>{var s;return[S("div",vt,[S("div",gt,[S("div",ft,[d.value.length?(l(),h(Q,{key:0},[u(t(ie),{class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:d.value[0].displayName,rounded:""},null,8,["label"]),d.value.length>1?(l(),b(t(ie),{key:0,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",icon:"pi pi-user",label:"You",rounded:""})):C("",!0),d.value.length>2?(l(),b(t(ie),{key:1,class:"h-fit !p-0 !px-4 !py-1 !bg-red-800 !bg-opacity-50",label:`${d.value.length-2} others`,rounded:""},null,8,["label"])):C("",!0)],64)):C("",!0)]),t(w)?(l(),h("div",{key:0,class:F(["flex justify-end ms-5",(s=e.post.allowedUserIds)!=null&&s.length?"flex-col md:flex-row":"flex-row"])},[u(Se,{onEditClicked:o[2]||(o[2]=I=>e.$emit("editClicked")),onDeleteClicked:o[3]||(o[3]=I=>e.$emit("deleteClicked"))})],2)):C("",!0)]),S("div",yt,[o[6]||(o[6]=S("div",{class:"absolute inset-0 rounded-primary bg-gradient-to-t from-neutral-500 to-transparent"},null,-1)),S("div",bt,[u(t(Le),{class:F(["z-10 min-h-[20vh] p-5 text-neutral-300",e.post.colorPrimary,e.post.opacityPrimary||"bg-opacity-50"])},{header:T(()=>[e.post.coverImageUrl?(l(),b(He,{key:0,post:e.post,"cover-image-url":e.post.coverImageUrl,thumb:""},null,8,["post","cover-image-url"])):C("",!0)]),content:T(()=>[S("div",{class:F(["flex relative",e.post.countdown||e.post.alignment==="center"?"flex justify-between":""])},[S("div",kt,[e.post.countdown?(l(),b(Pe,{key:0,time:new Date(e.post.countdown).getTime(),direction:"down",alignment:e.post.alignment},null,8,["time","alignment"])):C("",!0),e.post.timer?(l(),b(Pe,{key:1,time:new Date(e.post.timer).getTime(),direction:"up",alignment:e.post.alignment},null,8,["time","alignment"])):C("",!0),e.post.description?(l(),b(qe,{key:2,description:e.post.description.substring(0,150)+(e.post.description.length>=150?"...":"")},null,8,["description"])):c.value?(l(),h("div",$t,[c.value.title?(l(),b(Ue,{key:0,alignment:c.value.alignment},{default:T(()=>[Z(de(c.value.subTitle?c.value.title:`${c.value.title}...`),1)]),_:1},8,["alignment"])):C("",!0),c.value.subTitle?(l(),b(Ue,{key:1,alignment:c.value.alignment,"is-sub-title":""},{default:T(()=>[Z(de(c.value.subTitle)+"... ",1)]),_:1},8,["alignment"])):C("",!0)])):C("",!0)])],2)]),_:1},8,["class"])])]),S("div",Pt,[u(W,{class:"w-full md:w-1/2",variant:"neutral",label:"Read more",loading:t(a)===t(J).BLOG_DETAILS&&t(U)===e.post.id,onClick:o[4]||(o[4]=I=>t(Ce).push({name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}))},null,8,["loading"])]),S("div",Ct,[S("p",{class:F(e.post.reactions.length?"text-yellow-400 hover:text-yellow-500 cursor-pointer":"text-neutral-200"),onClick:o[5]||(o[5]=I=>t(Ce).push({name:t(J).BLOG_DETAILS,params:{postId:e.post.id}}))},de(e.post.reactions.length)+" replies ",3)])])]}),_:1},8,["id","class","title","subTitle","tags","loading","isCollapsed","route"]))}}),ht={class:"w-full grid gap-4 md:gap-10 xl:gap-20"},St={key:2,class:"w-full flex justify-center mt-5"},Ut=G({__name:"BlogPosts",props:{single:{type:Boolean}},emits:["createClicked","editClicked","deleteClicked"],setup(n){const p=ee(),i=ae(),{blogPosts:m,visibleBlogPosts:k,isBlogPostsFetchLoading:a}=D(i),{firebaseUser:U,isLoggedIn:E,isOwner:w}=D(p),{fetchBlogPosts:B}=i;st();const d=r(),y=r(),v=r(),c=async e=>{var o;m.value.visibility!==e&&(m.value.data[e].length||await B((o=U.value)==null?void 0:o.uid,{visibility:e}),m.value.visibility=e,m.value.isLastPage=!1,ue(d.value))},$=async()=>{var o;const e=k.value.length;await B((o=U.value)==null?void 0:o.uid),k.value[e]&&ue(y.value[e])};return Ie(()=>{m.value.loadedOnce||(E.value?c("private"):m.value.visibility!=="public"&&c("public"),m.value.loadedOnce=!0)}),ne(()=>{var e;return(e=y.value)==null?void 0:e.length},()=>{var e;if((e=y.value)!=null&&e.length&&v.value){const o=k.value.find(s=>s.id===v.value);if(o){const s=k.value.indexOf(o);ue(y.value[s]),v.value=void 0}}}),(e,o)=>(l(),h("div",{ref_key:"container",ref:d,class:"flex flex-col gap-5 items-center"},[t(w)?(l(),b(W,{key:0,class:"w-full md:w-1/2",variant:"tertiary",label:"New Post",onClick:o[0]||(o[0]=s=>e.$emit("createClicked"))})):C("",!0),t(E)?(l(),b(t(We),{key:1,class:"w-full md:w-1/2"},{default:T(()=>[u(W,{class:"w-full",variant:"secondary",outlined:t(m).visibility!=="public",loading:t(m).isLoading.public.fetch,label:"Public Posts",onClick:o[1]||(o[1]=s=>c("public"))},null,8,["outlined","loading"]),u(W,{class:"w-full",variant:"secondary",outlined:t(m).visibility!=="private",loading:t(m).isLoading.private.fetch,label:"Private Posts",onClick:o[2]||(o[2]=s=>c("private"))},null,8,["outlined","loading"])]),_:1})):C("",!0),S("div",ht,[t(k).length?(l(!0),h(Q,{key:0},Te(t(k),(s,I)=>(l(),h("div",{key:s.id,ref_for:!0,ref_key:"posts",ref:y},[I===0||s.datePinned?(l(),b(De,{key:0,post:s,onEditClicked:P=>e.$emit("editClicked",s),onDeleteClicked:P=>e.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"])):(l(),b(wt,{key:1,post:s,onEditClicked:P=>e.$emit("editClicked",s),onDeleteClicked:P=>e.$emit("deleteClicked",s)},null,8,["post","onEditClicked","onDeleteClicked"]))]))),128)):t(a)?(l(),b(fe,{key:1,class:"!bg-neutral-600 !bg-opacity-40 !rounded-primary",title:"Loading..."})):(l(),b(fe,{key:2,class:"!bg-red-900 !bg-opacity-40 !rounded-primary",title:"No posts"}))]),t(m).isLastPage?C("",!0):(l(),h("div",St,[u(W,{class:"w-full md:w-1/2 xl:w-1/4",outlined:"",loading:t(k).length>0&&t(a),label:"Load more posts",onClick:$},null,8,["loading"])]))],512))}}),Bt=G({__name:"BlogPostContentDialog",emits:["update:selected","error"],setup(n,{expose:p,emit:i}){const m=i,k=te(),{blogPostMutation:a}=D(k),U=r(),E=r(),w=_(()=>[E.value].some(d=>!!d));return p({test:async()=>{await Promise.all([U.value.test()]),m("error",w.value)}}),(d,y)=>(l(),h(Q,null,[u(Ye,{ref_key:"title",ref:U,name:"title",label:"Title",placeholder:"Amazing Post",modelValue:t(a).title,"onUpdate:modelValue":y[0]||(y[0]=v=>t(a).title=v),error:E.value,"onUpdate:error":y[1]||(y[1]=v=>E.value=v),rules:[t(Ve).Required],"min-length":3,"max-length":50},null,8,["modelValue","error","rules"]),u(Qe,{modelValue:t(a).content,"onUpdate:modelValue":y[2]||(y[2]=v=>t(a).content=v)},null,8,["modelValue"])],64))}}),Et=G({__name:"BlogPostSettingsDialog",emits:["error"],setup(n,{expose:p,emit:i}){const m=i,k=ee(),a=ke(),U=te(),{publicUser:E,publicUsers:w}=D(a),{firebaseUser:B}=D(k),{blogPostMutation:d}=D(U),{allowedPublicUsers:y}=a,v=r(),c=r(),$=r(),e=r(),o=_({get(){return!!d.value.datePinned},set(M){d.value.datePinned=M?new Date:null}}),s=r(),I=r(),P=r(),L=r(),O=_(()=>[s.value,I.value,P.value,L.value].some(M=>!!M)),f=_(()=>w.value.map(({id:M,displayName:x})=>({value:M,label:x}))),g=r([]),oe=M=>{d.value.allowedUserIds=M},le=async()=>{d.value.allowedUserIds.length&&!g.value.length&&(s.value="Invalid user ID's"),await Promise.all([c.value.test(),$.value.test(),e.value.test()]),m("error",O.value)};return ne(()=>d.value.allowedUserIds,async M=>{g.value=await y(M)},{immediate:!0}),p({test:le}),(M,x)=>(l(),h(Q,null,[u(H,{ref_key:"allowedUsers",ref:v,name:"allowedUserIds",label:"Allowed users",placeholder:"This post is public","model-value":t(d).allowedUserIds,error:s.value,"onUpdate:error":x[0]||(x[0]=A=>s.value=A),"onUpdate:arrayValue":oe,options:[{value:t(B).uid,label:t(E).displayName},...f.value.filter(({value:A})=>{var se;return A!==((se=t(B))==null?void 0:se.uid)})],multiple:""},null,8,["model-value","error","options"]),u(ce,{ref_key:"pinned",ref:e,name:"pinned",label:"Pinned",modelValue:o.value,"onUpdate:modelValue":x[1]||(x[1]=A=>o.value=A)},null,8,["modelValue"]),u(ce,{ref_key:"locked",ref:c,name:"locked",label:"Locked for commenting",modelValue:t(d).locked,"onUpdate:modelValue":x[2]||(x[2]=A=>t(d).locked=A)},null,8,["modelValue"]),u(ce,{ref_key:"archived",ref:$,name:"archived",label:"Archived",modelValue:t(d).archived,"onUpdate:modelValue":x[3]||(x[3]=A=>t(d).archived=A)},null,8,["modelValue"])],64))}}),It=G({__name:"BlogPostStylingDialog",emits:["error"],setup(n,{expose:p,emit:i}){const m=i,k=te(),{blogPostMutation:a}=D(k),U=r(),E=r(),w=r(),B=r(),d=r(),y=r(),v=r(),c=r(),$=r(),e=r(),o=r(),s=r(),I=_(()=>[v.value,c.value,$.value,e.value,o.value,s.value].some(O=>!!O)),P=_(()=>Ke(we.find(O=>O.value===a.value.colorPrimary)));return p({test:async()=>{await Promise.all([U.value.test(),E.value.test(),w.value.test(),B.value.test(),d.value.test(),y.value.test()]),m("error",I.value)}}),(O,f)=>(l(),h(Q,null,[u(H,{ref_key:"colorPrimary",ref:U,name:"colorPrimary",label:"Primary Style",modelValue:t(a).colorPrimary,"onUpdate:modelValue":f[0]||(f[0]=g=>t(a).colorPrimary=g),error:v.value,"onUpdate:error":f[1]||(f[1]=g=>v.value=g),options:t(we),rules:[t(Ve).Required]},null,8,["modelValue","error","options","rules"]),u(H,{ref_key:"opacityPrimary",ref:B,name:"opacityPrimary",label:"Primary Opacity",modelValue:t(a).opacityPrimary,"onUpdate:modelValue":f[2]||(f[2]=g=>t(a).opacityPrimary=g),error:e.value,"onUpdate:error":f[3]||(f[3]=g=>e.value=g),options:t(pe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"colorSecondary",ref:E,name:"colorSecondary",label:"Secondary Style",modelValue:t(a).colorSecondary,"onUpdate:modelValue":f[4]||(f[4]=g=>t(a).colorSecondary=g),error:c.value,"onUpdate:error":f[5]||(f[5]=g=>c.value=g),options:P.value},null,8,["modelValue","error","options"]),u(H,{ref_key:"opacitySecondary",ref:d,name:"opacitySecondary",label:"Secondary Opacity",modelValue:t(a).opacitySecondary,"onUpdate:modelValue":f[6]||(f[6]=g=>t(a).opacitySecondary=g),error:o.value,"onUpdate:error":f[7]||(f[7]=g=>o.value=g),options:t(pe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"colorTertiary",ref:w,name:"colorTertiary",label:"Tertiary Style",modelValue:t(a).colorTertiary,"onUpdate:modelValue":f[8]||(f[8]=g=>t(a).colorTertiary=g),error:$.value,"onUpdate:error":f[9]||(f[9]=g=>$.value=g),options:t(Xe)},null,8,["modelValue","error","options"]),u(H,{ref_key:"opacityTertiary",ref:y,name:"opacityTertiary",label:"Tertiary Opacity",modelValue:t(a).opacityTertiary,"onUpdate:modelValue":f[10]||(f[10]=g=>t(a).opacityTertiary=g),error:s.value,"onUpdate:error":f[11]||(f[11]=g=>s.value=g),options:t(pe)},null,8,["modelValue","error","options"])],64))}}),Tt=G({__name:"BlogPostDialog",emits:["scroll-to-updated"],setup(n,{emit:p}){const i=p,m=ee(),k=ae(),a=te(),{firebaseUser:U}=D(m),{isBlogPostsMutationLoading:E}=D(k),{createBlogPost:w,updateBlogPost:B,deleteFilesOfBlogPost:d,toggleBlogPostVisibility:y}=k,{getBlogPostMutationContent:v,getBlogPostMutationStyling:c,getBlogPostMutationSettings:$}=a,{isOpen:e,blogPostOriginal:o,blogPostMutationId:s,blogPostMutation:I,hasBlogPostMutationContentChanges:P,hasBlogPostMutationStylingChanges:L,hasBlogPostMutationSettingsChanges:O}=D(a),f=r(),g=r(),oe=r(),le=r(),M=r(!1),x=r(!1),A=r(!1),se=_(()=>{var N,V,R,K,X,j;return!!((V=(N=o.value)==null?void 0:N.allowedUserIds)!=null&&V.length)&&!((R=$().allowedUserIds)!=null&&R.length)||!((X=(K=o.value)==null?void 0:K.allowedUserIds)!=null&&X.length)&&!!((j=$().allowedUserIds)!=null&&j.length)}),Oe=_(()=>{const N=[];return P.value&&N.push("Content"),L.value&&N.push("Styling"),O.value&&N.push("Settings"),N.length?"Update "+he(N):void 0}),re=_(()=>Ze(o.value)),_e=async()=>{var N,V,R,K,X;if(await Promise.all([g.value.test(),oe.value.test(),le.value.test()]),!(M.value||x.value||A.value))if(!o.value)await w(s.value,I.value,(N=U.value)==null?void 0:N.uid)&&(a.close(),i("scroll-to-updated",s.value));else if(se.value){const j=s.value;a.isOpen=!1,await y(j,ot.convert(I.value),o.value.reactions,I.value.allowedUserIds.length?"private":"public",(V=U.value)==null?void 0:V.uid)&&(a.close(),ye.success("Successfully updated Post Visibility"),i("scroll-to-updated",j))}else{const j=s.value;let q=[];P.value&&q.push(await B(j,v(),re.value,(R=U.value)==null?void 0:R.uid)),L.value&&q.push(await B(j,c(),re.value,(K=U.value)==null?void 0:K.uid)),O.value&&(q.push(await B(j,$(),re.value,(X=U.value)==null?void 0:X.uid)),i("scroll-to-updated",j)),q=q.filter(xe=>typeof xe=="string"),q.length&&(ye.success(`Successfully updated Post ${he(q)}`),a.close())}},Me=async()=>{d(I.value,o.value??void 0),a.close()};return ne(I,()=>{a.isMutationEqual()},{deep:!0}),(N,V)=>(l(),b(Be,{isOpen:t(e),title:t(o)?"Update Post":"Create Post",description:t(o)?"Update this post":"Create a new post","confirm-text":t(o)?Oe.value:"Create","confirm-loading":t(E),onConfirm:_e,onCancel:Me},{default:T(()=>[S("form",{ref_key:"dialog",ref:f,class:"pt-6 mb-4 xl:px-16"},[t(e)?(l(),b(t(et),{key:0,"active-index":0,onTabOpen:t(tt)},{default:T(()=>[u(t(ge),{value:"content"},{default:T(()=>[u(t(me),null,{default:T(()=>V[3]||(V[3]=[Z(" Content ")])),_:1,__:[3]}),u(t(ve),null,{default:T(()=>[u(Bt,{ref_key:"content",ref:g,onError:V[0]||(V[0]=R=>M.value=R)},null,512)]),_:1})]),_:1}),u(t(ge),{value:"styling"},{default:T(()=>[u(t(me),null,{default:T(()=>V[4]||(V[4]=[Z(" Styling ")])),_:1,__:[4]}),u(t(ve),null,{default:T(()=>[u(It,{ref_key:"styling",ref:oe,onError:V[1]||(V[1]=R=>x.value=R)},null,512)]),_:1})]),_:1}),u(t(ge),{value:"settings"},{default:T(()=>[u(t(me),null,{default:T(()=>V[5]||(V[5]=[Z(" Settings ")])),_:1,__:[5]}),u(t(ve),null,{default:T(()=>[u(Et,{ref_key:"settings",ref:le,onError:V[2]||(V[2]=R=>A.value=R)},null,512)]),_:1})]),_:1})]),_:1},8,["onTabOpen"])):C("",!0)],512)]),_:1},8,["isOpen","title","description","confirm-text","confirm-loading"]))}}),Vt={class:"grid mt-10 md:mt-15"},Dt={class:"grid justify-center"},Lt={class:"text-lg md:text-xl text-white"},Ot=["innerHTML"],_t={class:"grid my-5 xl:px-20"},Mt=G({__name:"Blog",setup(n){const p=Ee(),i=be(),m=ke(),k=ae(),a=te(),{menuItems:U,content:E}=D(i),{publicUser:w}=D(m),{deleteBlogPost:B}=k,d=r(null),y=r(),v=r(!1),c=r(p.currentRoute.value.params.postId),$=_(()=>{var P;return w.value?[...E.value.blogDescriptionUser.map(L=>L.replace("%USER%",w.value.displayName||"Unknown user")),...((P=U.value.find(L=>L.id==="nfNQM4SMESU2VOkJtcgY"))==null?void 0:P.description)||[]]:E.value.blogDescriptionGuest}),e=()=>{a.openWith(null)},o=P=>{a.openWith(P)},s=P=>{d.value=P,v.value=!0},I=async P=>{await B(P)&&(v.value=!1,d.value=null)};return ne(p.currentRoute,P=>{c.value=P.params.postId}),(P,L)=>(l(),b(Ae,null,{content:T(()=>[S("div",Vt,[S("div",Dt,[(l(!0),h(Q,null,Te($.value,O=>(l(),h("h1",Lt,[S("span",{innerHTML:O},null,8,Ot)]))),256))]),S("div",_t,[c.value?(l(),b(pt,{key:0,onEditClicked:o,onDeleteClicked:s})):(l(),b(Ut,{key:1,onCreateClicked:e,onEditClicked:o,onDeleteClicked:s})),u(Tt,{onScrollToUpdated:L[0]||(L[0]=O=>y.value=O)}),d.value?(l(),b(Be,{key:2,title:"Delete Post",isOpen:v.value,description:[` Are you sure you want to delete this post called ' ${d.value.title}'?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},onConfirm:L[1]||(L[1]=O=>I(d.value.id)),onCancel:L[2]||(L[2]=O=>v.value=!1)},null,8,["isOpen","description"])):C("",!0)])])]),_:1}))}}),Gt=G({__name:"Blog",setup(n){return(p,i)=>(l(),b(Mt))}});export{Gt as default};
