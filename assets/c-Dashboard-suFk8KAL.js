import{e as Q,f as de,h as me,g as ve,C as pe,a9 as fe,s as S,r as m,a as _e,c as p,b as V,aa as Ne,ab as Ae,p as s,ac as we,a3 as Y,ad as Pe,l as t,t as u,E as z,k as r,q as v,ae as De,n,w as i,af as J,m as be,R}from"../bundle.js";import{u as Oe,b as Ee,a as Se,_ as f}from"./c-Bubble.vue_vue_type_script_setup_true_lang-DwnbaZC0.js";import{_ as K,a as Re}from"./c-SwitchField.vue_vue_type_script_setup_true_lang-lxypY4ur.js";import{_ as Te,a as T,b as Ue}from"./c-PasswordField.vue_vue_type_script_setup_true_lang-DZJwGAom.js";import{_ as ce}from"./c-FileUpload.vue_vue_type_script_setup_true_lang-D8Ln9Mzp.js";import{_ as U}from"./c-TextField.vue_vue_type_script_setup_true_lang-BCXugEY6.js";import{_ as ge}from"./c-Page.vue_vue_type_script_setup_true_lang-BdVWSpbl.js";import{R as _}from"./c-validation-CO90d-7g.js";import"./c-_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"flex flex-wrap pt-6 pb-8 mb-4"},ye={class:"basis-full lg:basis-1/2"},Ie={class:"flex gap-3 mt-10 flex-wrap"},Be={class:"basis-full lg:basis-1/2"},ke={key:0,class:"basis-full lg:basis-1/2 flex gap-3 mt-10 flex-wrap"},Ce={class:"flex flex-col items-center content-center"},Le={class:"flex flex-col gap-3 items-center content-center"},He=Q({__name:"Dashboard",setup(X){const y=de(),h=Oe(Ee).greaterOrEqual("md"),A=me(),I=ve(),B=pe(),ee=fe(),{isOnline:c,debug:g,language:ae}=S(ee),{routeLoading:k}=S(I),{currentUser:d,publicUser:w,isMutationLoading:C}=S(B),{firebaseUser:P,isOwner:N,isLogoutLoading:re}=S(A),{fetchAll:le}=I,{updateUser:se,updatePublicUser:oe}=B,D=m(!1),L=m(),H=m(),$=m(),x=m(),M=m(),b=m(),W=m(),te=m(),e=_e({firstName:{value:"",error:""},lastName:{value:"",error:""},displayName:{value:"",error:""},email:{value:"",error:""},newPassword:{value:"",error:""},currentPassword:{value:"",error:""},repeatPassword:{value:"",error:""},avatar:{value:"",error:""}}),G=p(()=>({firstName:e.firstName.value,lastName:e.lastName.value})),ue=p(()=>({displayName:e.displayName.value,avatar:e.avatar.value})),ne=p(()=>!!d.value&&!V(Ne.convert(d.value),G.value)),q=p(()=>!!w.value&&!V(Ae.convert(w.value),ue.value)),O=p(()=>{var o;return e.email.value!==((o=P.value)==null?void 0:o.email)}),E=p(()=>{const o=[];if(ne.value&&o.push(s("DASHBOARD_BUTTON_SAVE_DETAILS")),q.value&&o.push(s("DASHBOARD_BUTTON_SAVE_PUBLIC_PROFILE")),O.value&&o.push(s("DASHBOARD_BUTTON_SAVE_EMAIL")),e.newPassword.value&&o.push(s("DASHBOARD_BUTTON_SAVE_PASSWORD")),o.length)return ae.value===we.NL?`${Y(o)} ${s("GENERAL_DIALOG_SAVE")}`:`${s("GENERAL_DIALOG_SAVE")} ${Y(o)}`}),ie=async()=>{var o;Object.keys(e).forEach(a=>e[a].error=""),e.newPassword.value&&(await Promise.all([M.value.test(),b.value.test(),W.value.test()]),!e.newPassword.error&&!e.currentPassword.error&&!e.repeatPassword.error&&(await A.updatePassword(e.newPassword.value,e.currentPassword.value),e.newPassword.value="",e.currentPassword.value="")),q.value&&(await $.value.test(),!e.displayName.error&&!e.avatar.error&&oe({displayName:e.displayName.value,avatar:e.avatar.value})),O.value&&(await Promise.all([x.value.test(),b.value.test()]),!e.email.error&&!e.currentPassword.error&&(await A.updateMail(e.email.value,e.currentPassword.value),e.currentPassword.value="")),V(d.value,G.value)||(await Promise.all([L.value.test(),H.value.test()]),!e.firstName.error&&!e.lastName.error&&se({firstName:e.firstName.value,lastName:e.lastName.value})),await le((o=P.value)==null?void 0:o.uid,!0)};return Pe(()=>{var o,a,l,F,j;e.firstName.value=((o=d.value)==null?void 0:o.firstName)||"",e.lastName.value=((a=d.value)==null?void 0:a.lastName)||"",e.displayName.value=((l=w.value)==null?void 0:l.displayName)||"",e.email.value=((F=P.value)==null?void 0:F.email)||"",e.avatar.value=((j=w.value)==null?void 0:j.avatar)||""}),(o,a)=>(t(),u(ge,null,{content:z(()=>[r(d)&&r(P)?(t(),u(Se,{key:0,class:"!bg-secondary-500 !bg-opacity-35 my-5",title:`${r(s)("NAVIGATION_WELCOME_1")} `+r(d).firstName+(r(d).lastName?" "+r(d).lastName:""),description:r(s)("DASHBOARD_DESCRIPTION")},{default:z(()=>[v("div",Ve,[v("div",ye,[v("form",{id:"accountForm",onSubmit:a[19]||(a[19]=De(l=>ie(),["prevent"]))},[n(U,{name:"accountType",label:r(s)("DASHBOARD_INPUT_ACCOUNT_TYPE"),"model-value":r(N)?"Owner":"Member","input-props":{disabled:!0}},null,8,["label","model-value"]),n(U,{ref_key:"firstName",ref:L,name:"firstName",label:r(s)("DASHBOARD_INPUT_FIRST_NAME"),placeholder:"Someone",modelValue:e.firstName.value,"onUpdate:modelValue":a[0]||(a[0]=l=>e.firstName.value=l),error:e.firstName.error,"onUpdate:error":a[1]||(a[1]=l=>e.firstName.error=l),rules:[r(_).Required],"min-length":3,"max-length":50},null,8,["label","modelValue","error","rules"]),n(U,{ref_key:"lastName",ref:H,name:"lastName",label:r(s)("DASHBOARD_INPUT_LAST_NAME"),modelValue:e.lastName.value,"onUpdate:modelValue":a[2]||(a[2]=l=>e.lastName.value=l),error:e.lastName.error,"onUpdate:error":a[3]||(a[3]=l=>e.lastName.error=l),"min-length":3,"max-length":50},null,8,["label","modelValue","error"]),n(U,{ref_key:"displayName",ref:$,name:"displayName",label:r(s)("DASHBOARD_INPUT_USERNAME"),modelValue:e.displayName.value,"onUpdate:modelValue":a[4]||(a[4]=l=>e.displayName.value=l),error:e.displayName.error,"onUpdate:error":a[5]||(a[5]=l=>e.displayName.error=l),rules:[r(_).MinLength],"min-length":3,"max-length":50},null,8,["label","modelValue","error","rules"]),n(Te,{ref_key:"email",ref:x,name:"email",label:r(s)("DASHBOARD_INPUT_EMAIL"),modelValue:e.email.value,"onUpdate:modelValue":a[6]||(a[6]=l=>e.email.value=l),error:e.email.error,"onUpdate:error":a[7]||(a[7]=l=>e.email.error=l),rules:[r(_).Required]},null,8,["label","modelValue","error","rules"]),O.value?(t(),u(T,{key:0,ref_key:"currentPassword",ref:b,name:"currentPassword",label:r(s)("DASHBOARD_INPUT_PASSWORD_CURRENT"),modelValue:e.currentPassword.value,"onUpdate:modelValue":a[8]||(a[8]=l=>e.currentPassword.value=l),error:e.currentPassword.error,"onUpdate:error":a[9]||(a[9]=l=>e.currentPassword.error=l),rules:[r(_).Required]},null,8,["label","modelValue","error","rules"])):i("",!0),n(T,{ref_key:"newPassword",ref:M,name:"newPassword",label:r(s)("DASHBOARD_INPUT_PASSWORD_NEW"),modelValue:e.newPassword.value,"onUpdate:modelValue":a[10]||(a[10]=l=>e.newPassword.value=l),error:e.newPassword.error,"onUpdate:error":a[11]||(a[11]=l=>e.newPassword.error=l),min:6,max:50},null,8,["label","modelValue","error"]),e.newPassword.value?(t(),u(T,{key:1,ref_key:"repeatPassword",ref:W,name:"repeatPassword",label:r(s)("DASHBOARD_INPUT_PASSWORD_NEW_REPEAT"),modelValue:e.repeatPassword.value,"onUpdate:modelValue":a[12]||(a[12]=l=>e.repeatPassword.value=l),error:e.repeatPassword.error,"onUpdate:error":a[13]||(a[13]=l=>e.repeatPassword.error=l),rules:[r(_).Required],compare:{value:e.newPassword.value,name:r(s)("DASHBOARD_INPUT_PASSWORD_NEW")}},null,8,["label","modelValue","error","rules","compare"])):i("",!0),e.newPassword.value&&!O.value?(t(),u(T,{key:2,ref_key:"currentPassword",ref:b,name:"currentPassword",label:r(s)("DASHBOARD_INPUT_PASSWORD_CURRENT"),modelValue:e.currentPassword.value,"onUpdate:modelValue":a[14]||(a[14]=l=>e.currentPassword.value=l),error:e.currentPassword.error,"onUpdate:error":a[15]||(a[15]=l=>e.currentPassword.error=l),rules:[r(_).Required]},null,8,["label","modelValue","error","rules"])):i("",!0),v("div",Ie,[E.value?(t(),u(f,{key:0,class:"w-full",action:"submit",loading:r(C),label:E.value},null,8,["loading","label"])):i("",!0),r(N)?i("",!0):(t(),u(f,{key:1,class:"w-full",type:"danger",outlined:"",label:r(s)("DASHBOARD_BUTTON_DELETE_ACCOUNT"),onClick:a[16]||(a[16]=l=>D.value=!0)},null,8,["label"]))]),r(N)?(t(),u(K,{key:3,name:"isOnline",label:"Online",modelValue:r(c),"onUpdate:modelValue":a[17]||(a[17]=l=>J(c)?c.value=l:null)},null,8,["modelValue"])):i("",!0),r(N)?(t(),u(K,{key:4,name:"debug",label:"Debug",modelValue:r(g),"onUpdate:modelValue":a[18]||(a[18]=l=>J(g)?g.value=l:null)},null,8,["modelValue"])):i("",!0)],32)]),v("div",Be,[n(ce,{ref_key:"avatar",ref:te,id:"avatar",name:"avatar",label:r(s)("DASHBOARD_INPUT_AVATAR"),modelValue:e.avatar.value,"onUpdate:modelValue":a[20]||(a[20]=l=>e.avatar.value=l),error:e.avatar.error,"onUpdate:error":a[21]||(a[21]=l=>e.avatar.error=l),"is-public":"","image-props":{class:"rounded-full"},"image-container-props":{class:"!h-64 !w-64"}},null,8,["label","modelValue","error"])]),r(h)?i("",!0):(t(),be("div",ke,[E.value?(t(),u(f,{key:0,class:"w-full",action:"submit",form:"accountForm",loading:r(C),label:E.value},null,8,["loading","label"])):i("",!0),r(N)?i("",!0):(t(),u(f,{key:1,class:"w-full",type:"danger",outlined:"",label:r(s)("DASHBOARD_BUTTON_DELETE_ACCOUNT"),onClick:a[22]||(a[22]=l=>D.value=!0)},null,8,["label"]))]))]),v("div",Ce,[n(Ue)]),v("div",Le,[n(f,{class:"w-full md:w-1/2",label:r(s)("DASHBOARD_BUTTON_PROFILE"),type:"purple",loading:r(k)===r(R).USER_DETAILS,onClick:a[23]||(a[23]=l=>r(y).push({name:r(R).USER_DETAILS,params:{userId:r(d).id}}))},null,8,["label","loading"]),n(f,{class:"w-full md:w-1/2",label:r(s)("DASHBOARD_BUTTON_PETS"),loading:r(k)===r(R).PET_OVERVIEW,route:r(R).PET_OVERVIEW},null,8,["label","loading","route"])])]),_:1},8,["title","description"])):i("",!0),n(Re,{title:r(s)("DASHBOARD_DIALOG_DELETE_ACCOUNT_TITLE"),isOpen:D.value,description:[r(s)("DASHBOARD_DIALOG_DELETE_ACCOUNT_DESCRIPTION_1"),r(s)("DASHBOARD_DIALOG_DELETE_ACCOUNT_DESCRIPTION_2")],"confirm-text":r(s)("GENERAL_DIALOG_CONFIRM"),"confirm-props":{type:"danger",outlined:!0},"confirm-loading":r(re),onConfirm:a[24]||(a[24]=l=>r(A).deleteAccount()),onCancel:a[25]||(a[25]=l=>D.value=!1)},null,8,["title","isOpen","description","confirm-text","confirm-loading"])]),_:1}))}}),ze=Q({__name:"Dashboard",setup(X){return(y,Z)=>(t(),u(He))}});export{ze as default};
