import{d as P,q as T,ag as x,u as M,F as B,G as V,ah as F,s as i,c as j,h as t,w as s,f as e,O as q,z as U,C as S,b as d,_ as z,ai as G,aj as o,g,e as J,n as H,R as c,J as y,k as b,t as C,$ as K,A as Q,i as W}from"../bundle.js";import{_ as X}from"./c-Dialog.vue_vue_type_script_setup_true_lang-BvpiYg2Q.js";import{_ as Y}from"./c-Page.vue_vue_type_script_setup_true_lang-C2l5ciLA.js";const Z=["src"],oe=P({__name:"Users",setup(ee){const h=T(),k=x(),L=M(),m=B(),f=V(),$=F(),{firebaseUser:w}=i(h),{combinedUsers:p}=i(k),{isMutationLoading:D}=i(m),{isMutationLoading:N}=i(f),{routeLoading:O,routeLoadingId:R}=i(L),r=U(!1),n=U(null),l=S(()=>p.value.find(u=>u.id===n.value)),E=S(()=>l.value?`${l.value.id} ${l.value.firstName??""} ${l.value.lastName??""}`:"Unknown user");function I(u){n.value=u,r.value=!0}async function A(){n.value&&(await $.deleteOnlineUser(n.value),await m.deletePrivateUser(n.value),await f.deletePublicUser(n.value)),r.value=!1}return(u,_)=>{const v=Q("RouterLink");return d(),j(q,null,[t(Y,null,{content:s(()=>[t(z,{class:"!bg-primary-500 !bg-opacity-35 my-5",title:"Users"},{default:s(()=>[t(e(G),{value:e(p),tableStyle:"min-width: 50rem"},{default:s(()=>[t(e(o),null,{body:s(({data:a})=>[a.avatar?(d(),g(v,{key:0,to:{name:e(c).USER_DETAILS,params:{userId:a.id}}},{default:s(()=>[J("img",{class:H(["rounded-full h-12 w-12 min-w-12 aspect-square object-cover",{"animate-spin":e(O)===e(c).USER_DETAILS&&e(R)===a.id}]),src:a.avatar},null,10,Z)]),_:2},1032,["to"])):y("",!0)]),_:1}),t(e(o),{header:"Displayname"},{body:s(({data:a})=>[t(v,{to:{name:e(c).USER_DETAILS,params:{userId:a.id}}},{default:s(()=>[b(C(a.displayName),1)]),_:2},1032,["to"])]),_:1}),t(e(o),{field:"firstName",header:"First name"}),t(e(o),{field:"lastName",header:"Last name"}),t(e(o),{header:"Last online"},{body:s(({data:a})=>[b(C(a?.lastOnline?e(K)(a.lastOnline):""),1)]),_:1}),t(e(o),null,{body:s(({data:a})=>[a.id!==e(w)?.uid?(d(),g(W,{key:0,variant:"danger",icon:"pi pi-trash",onClick:ae=>I(a.id)},null,8,["onClick"])):y("",!0)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(X,{title:"Delete User",isOpen:r.value,description:[`Are you sure you want to delete user ${E.value}?`,"This cannot be undone."],"confirm-text":"Confirm","confirm-props":{variant:"danger",outlined:!0},"confirm-loading":e(D)||e(N),onConfirm:A,onCancel:_[0]||(_[0]=a=>r.value=!1)},null,8,["isOpen","description","confirm-loading"])],64)}}});export{oe as default};
