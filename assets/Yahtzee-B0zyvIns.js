import{_ as k,a as ee}from"./Bubble.vue_vue_type_script_setup_true_lang-Dk_z7oWH.js";import{cG as ye,c1 as be,cH as se,cI as X,cJ as ke,cw as te,cv as le,cK as He,b$ as oe,cL as Ee,cM as $e,cN as re,M as O,aK as i,u,v as o,s as d,bi as t,aZ as xe,at as N,bQ as R,aS as U,q as p,bC as ue,b9 as x,I as f,bH as m,H as _,bR as ce,aC as Oe,aH as Te,F as he,t as H,bP as Ae,aV as Ce,bV as De,cn as Se}from"../bundle.js";import{_ as Fe}from"./Dice6.vue_vue_type_script_setup_true_lang-lzciAH4f.js";import{H as Ve}from"./Highscores-BFxOSbvL.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Pe}from"./GameSettingsDialog.vue_vue_type_script_setup_true_lang-B_Lk_geX.js";import"./SwitchField.vue_vue_type_script_setup_true_lang-PInLX98O.js";import"./SelectField.vue_vue_type_script_setup_true_lang-DmhzIFzD.js";import"./validation-Bf-E2UlI.js";var v=(e=>(e[e.ONES=0]="ONES",e[e.TWOS=1]="TWOS",e[e.THREES=2]="THREES",e[e.FOURS=3]="FOURS",e[e.FIVES=4]="FIVES",e[e.SIXES=5]="SIXES",e[e.THREE_OF_A_KIND=6]="THREE_OF_A_KIND",e[e.FOUR_OF_A_KIND=7]="FOUR_OF_A_KIND",e[e.FULL_HOUSE=8]="FULL_HOUSE",e[e.SMALL_STRAIGHT=9]="SMALL_STRAIGHT",e[e.LARGE_STRAIGHT=10]="LARGE_STRAIGHT",e[e.YAHTZEE=11]="YAHTZEE",e[e.CHANCE=12]="CHANCE",e))(v||{});const S={0:{title:"Ones",section:"top"},1:{title:"Twos",section:"top",multiplier:2},2:{title:"Threes",section:"top",multiplier:3},3:{title:"Fours",section:"top",multiplier:4},4:{title:"Fives",section:"top",multiplier:5},5:{title:"Sixes",section:"top",multiplier:6},6:{title:"Three of a Kind",section:"bottom"},7:{title:"Four of a Kind",section:"bottom"},8:{title:"Full House",section:"bottom",trueValue:25},9:{title:"Small Straight",section:"bottom",trueValue:30},10:{title:"Large Straight",section:"bottom",trueValue:40},11:{title:"Yahtzee",section:"bottom",trueValue:50},12:{title:"Chance",section:"bottom"}},Z=e=>({score:[],bonus:0,finalScore:null,round:-1,reroll:-1,dices:[{id:1,value:1,selected:!1,isRolling:!1},{id:2,value:2,selected:!1,isRolling:!1},{id:3,value:3,selected:!1,isRolling:!1},{id:4,value:4,selected:!1,isRolling:!1},{id:5,value:5,selected:!1,isRolling:!1}],gameData:(e==null?void 0:e.gameData)??{highscores:{}},previousPersonalBest:(e==null?void 0:e.previousPersonalBest)??null,previousHighscorePosition:(e==null?void 0:e.previousHighscorePosition)??null}),ae=(e,s)=>{for(let l=1;l<=6;l++)if(e.dices.filter(a=>a.value===l).length>=s){let a=0;return e.dices.forEach(n=>{a+=n.value}),a}return!1},W=(e,s)=>{for(let l=1;l<=6;l++)if(e.dices.filter(a=>a.value===l).length===s)return!0;return!1},ie=(e,s)=>{let l=0,a=s;do{e:for(let n=a-s+1;n<=a;n++)if(e.dices.some(c=>c.value===n))l++;else break e;if(l===s)return!0;l=0,a++}while(a<=6);return!1},ne=ye(),Y=be("yahtzeeStore",{state:()=>Z(),getters:{hasStarted:e=>e.round>=0,hasFinished:e=>e.score.length===13,isRolling:e=>e.dices.some(s=>s.isRolling),hasOfValue:e=>s=>e.dices.filter(l=>l.value===s).length,hasThreeOfAKind:e=>ae(e,3),hasFourOfAKind:e=>ae(e,4),hasFullHouse:e=>W(e,2)&&W(e,3)?S[8].trueValue??!1:!1,hasSmallStraight:e=>ie(e,4)?S[9].trueValue??!1:!1,hasLargeStraight:e=>ie(e,5)?S[10].trueValue??!1:!1,hasYahtzee:e=>W(e,5)?S[11].trueValue??!1:!1,diceTotal:e=>{let s=0;return e.dices.forEach(l=>{s+=l.value}),s},scoreTotalOf:e=>s=>{let l=0;return e.score.filter(a=>S[a.row].section===s).forEach(a=>{a.value!==!1&&(l+=a.value)}),l},personalBest:e=>s=>{var l;return((l=e.gameData.highscores[s])==null?void 0:l.score)??0},highscorePosition:e=>s=>Object.keys(e.gameData.highscores).indexOf(s)+1},actions:{reset(e){this.$patch(Z(this)),this.setPreviousHighscores(e)},start(){this.round=0},async roll(){this.reroll++,this.dices.forEach(e=>{e.selected||(e.isRolling=!0,setTimeout(()=>{e.value=se(6),e.isRolling=!1,this.reroll===2&&(e.selected=!0),this.dices.sort((s,l)=>s.value-l.value)},se(1500,500)))}),X($e)},getScore(e){return this.score.find(s=>s.row===e)},getActualValue(e,s){let l=s;if(l===!1)return!1;const a=S[e];return a.multiplier?l*=a.multiplier:a.trueValue&&(l=a.trueValue),l},selectDice(e){this.reroll>=0&&this.reroll<2&&(e.selected=!e.selected,X(re))},selectScore(e,s){if(!this.isRolling){if(this.hasYahtzee){const l=this.score.find(a=>a.row===11);l&&l.value!==!1&&(this.bonus+=100)}this.score.push({row:e,value:s}),this.round++,this.reroll=Z().reroll,this.dices.forEach(l=>{l.selected=!1}),X(re)}},setPreviousHighscores(e,s=!1){e&&((!s||this.previousPersonalBest===null)&&(this.previousPersonalBest=this.personalBest(e)),(!s||this.previousHighscorePosition===null)&&(this.previousHighscorePosition=this.highscorePosition(e)))},async fetchHighscores(e){try{const s=await ke(te(ne,le.gameData.id,"yahtzee"));s&&(this.gameData=await He.mapIncoming(s),this.sortHighscores(),this.setPreviousHighscores(e,!0))}catch(s){oe.firebaseError(!0,s)}},async updateHighscores(e){try{if(this.gameData&&this.finalScore){const s=this.gameData.highscores;if(!s[e]||s[e].score<this.finalScore)return await this.fetchHighscores(e),this.setPreviousHighscores(e),this.gameData.highscores[e]={score:this.finalScore,bonus:this.bonus,date:new Date},await Ee(te(ne,le.gameData.path,"yahtzee"),{highscores:this.gameData.highscores}),this.sortHighscores(),!0}return!1}catch(s){return oe.firebaseError(!0,s),!1}},sortHighscores(){this.gameData.highscores=Object.fromEntries(Object.entries(this.gameData.highscores).sort(([,e],[,s])=>s.score-e.score))}},persist:{enabled:!0}}),Be={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Le=["fill"],Ie=["fill"],Ne=O({__name:"Dice1",props:{color:{},backgroundColor:{}},setup(e){return(s,l)=>(i(),u("svg",Be,[o("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Le),o("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,Ie)]))}}),Re={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},Ue=["fill"],Ge=["fill"],Ye=["fill"],ze=O({__name:"Dice2",props:{color:{},backgroundColor:{}},setup(e){return(s,l)=>(i(),u("svg",Re,[o("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,Ue),o("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,Ge),o("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,Ye)]))}}),Me={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},je=["fill"],Xe=["fill"],Ze=["fill"],We=["fill"],Je=["fill"],qe=["fill"],Qe=O({__name:"Dice5",props:{color:{},backgroundColor:{}},setup(e){return(s,l)=>(i(),u("svg",Me,[o("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,je),o("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,Xe),o("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,Ze),o("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,We),o("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,Je),o("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,qe)]))}}),Ke={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},es=["fill"],ss=["fill"],ts=["fill"],ls=["fill"],os=["fill"],rs=O({__name:"Dice4",props:{color:{},backgroundColor:{}},setup(e){return(s,l)=>(i(),u("svg",Ke,[o("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,es),o("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,ss),o("circle",{cx:"25",cy:"75",r:"10",fill:s.color},null,8,ts),o("circle",{cx:"75",cy:"25",r:"10",fill:s.color},null,8,ls),o("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,os)]))}}),as={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},is=["fill"],ns=["fill"],us=["fill"],cs=["fill"],hs=O({__name:"Dice3",props:{color:{},backgroundColor:{}},setup(e){return(s,l)=>(i(),u("svg",as,[o("rect",{width:"100",height:"100",rx:"10",ry:"10",fill:s.backgroundColor,stroke:"#000000","stroke-width":"5"},null,8,is),o("circle",{cx:"25",cy:"25",r:"10",fill:s.color},null,8,ns),o("circle",{cx:"50",cy:"50",r:"10",fill:s.color},null,8,us),o("circle",{cx:"75",cy:"75",r:"10",fill:s.color},null,8,cs)]))}}),fs=O({__name:"Dice",props:{dice:{}},setup(e){const{selectDice:s}=Y(),l={1:Ne,2:ze,3:hs,4:rs,5:Qe,6:Fe};return(a,n)=>(i(),u("div",{class:N(["cursor-pointer",{"animate-spin":a.dice.isRolling}])},[(i(),d(xe(l[a.dice.value]),{color:"black",backgroundColor:a.dice.selected?"#2563eb":"white",width:"40",height:"40",onClick:n[0]||(n[0]=c=>t(s)(a.dice))},null,8,["backgroundColor"]))],2))}}),ds={class:"h-12 md:h-auto"},vs={class:"w-1/2 md:w-1/3"},ps={key:0},gs={key:1,class:"!ps-1 md:ps-1"},ms={key:2},_s=O({__name:"ScoreCell",props:{row:{},hasValue:{type:[Number,Boolean]}},setup(e){const s=e,l=Y(),{reroll:a}=R(l),{selectScore:n,getScore:c,getActualValue:y}=l,A=U(!1),P=S[s.row],T=p(()=>c(s.row)),E=p(()=>y(s.row,s.hasValue)),B=p(()=>E.value===!1?"X":E.value);return ue(()=>E.value,()=>{A.value=!0,setTimeout(()=>{A.value=!1})}),(L,C)=>(i(),u("tr",ds,[o("th",vs,x(t(P).title),1),T.value?(i(),u("td",ps,x(T.value.value===!1?"X":T.value.value),1)):t(a)>=0&&!A.value?(i(),u("td",gs,[f(k,{class:"!p-0 !h-10 md:!h-auto",type:E.value===!1||E.value===0?"neutral":void 0,onClick:C[0]||(C[0]=F=>t(n)(L.row,E.value))},{default:m(()=>[_(x(B.value),1)]),_:1},8,["type"])])):(i(),u("td",ms))]))}}),g=fe(_s,[["__scopeId","data-v-5f14174f"]]),ws={key:0,class:"h-12 md:h-auto text-red-500"},ys={class:"h-12 md:h-auto text-pink-500"},bs={key:0,class:"text-purple-500 font-bold"},ks={key:1,class:"text-red-500 font-bold"},Hs={key:2,class:"text-green-500 font-bold"},Es=O({__name:"Scoreboard",setup(e){const s=Y(),{bonus:l,hasStarted:a,hasFinished:n,hasOfValue:c,hasThreeOfAKind:y,hasFourOfAKind:A,hasFullHouse:P,hasSmallStraight:T,hasLargeStraight:E,hasYahtzee:B,diceTotal:L,scoreTotalOf:C,finalScore:F,previousPersonalBest:D,previousHighscorePosition:V,personalBest:b,highscorePosition:z}=R(s),{updateHighscores:G}=s,{firebaseUser:$}=R(ce()),r=U(),h=U(!1),de=p(()=>c.value(1)),ve=p(()=>c.value(2)),pe=p(()=>c.value(3)),ge=p(()=>c.value(4)),me=p(()=>c.value(5)),_e=p(()=>c.value(6)),I=p(()=>C.value("top")),J=p(()=>C.value("bottom")),M=p(()=>$.value?z.value($.value.uid):null),q=p(()=>M.value&&V.value?V.value>M.value:!1),we=p(()=>$.value&&D.value?D.value<b.value($.value.uid):!1);return Oe(()=>{r.value=setInterval(()=>{h.value=!h.value},500)}),Te(()=>{clearInterval(r.value)}),ue(n,(j,w)=>{var Q,K;j&&j!==w&&(F.value=I.value+(I.value>=63?35:0)+J.value+l.value,(Q=$.value)!=null&&Q.uid&&G((K=$.value)==null?void 0:K.uid),new Audio("/sounds/applause-and-cheer.mp3").play())}),(j,w)=>(i(),u("table",{class:N(["w-full mt-5 text-sm md:text-base text-left",t(n)?"text-neutral-500":"text-white",t(a)?void 0:h.value?"even":"odd"])},[o("tbody",null,[f(g,{row:t(v).ONES,"has-value":de.value},null,8,["row","has-value"]),f(g,{row:t(v).TWOS,"has-value":ve.value},null,8,["row","has-value"]),f(g,{row:t(v).THREES,"has-value":pe.value},null,8,["row","has-value"]),f(g,{row:t(v).FOURS,"has-value":ge.value},null,8,["row","has-value"]),f(g,{row:t(v).FIVES,"has-value":me.value},null,8,["row","has-value"]),f(g,{row:t(v).SIXES,"has-value":_e.value},null,8,["row","has-value"]),o("tr",{class:N(["h-12 md:h-auto",t(n)?"text-white":"text-neutral-500"])},[w[0]||(w[0]=o("th",null,"TOP",-1)),o("td",null,x(t(a)?I.value:""),1)],2),o("tr",{class:N(["h-12 md:h-auto",t(n)?I.value>=63?"text-yellow-500":"text-white":"text-neutral-500"])},[w[1]||(w[1]=o("th",null,"BONUS",-1)),o("td",null,x(I.value>=63?35:t(n)?"X":""),1)],2),f(g,{row:t(v).THREE_OF_A_KIND,"has-value":t(y)},null,8,["row","has-value"]),f(g,{row:t(v).FOUR_OF_A_KIND,"has-value":t(A)},null,8,["row","has-value"]),f(g,{row:t(v).FULL_HOUSE,"has-value":t(P)},null,8,["row","has-value"]),f(g,{row:t(v).SMALL_STRAIGHT,"has-value":t(T)},null,8,["row","has-value"]),f(g,{row:t(v).LARGE_STRAIGHT,"has-value":t(E)},null,8,["row","has-value"]),f(g,{row:t(v).YAHTZEE,"has-value":t(B)},null,8,["row","has-value"]),f(g,{row:t(v).CHANCE,"has-value":t(L)},null,8,["row","has-value"]),o("tr",{class:N(["h-12 md:h-auto",t(n)?"text-white":"text-neutral-500"])},[w[2]||(w[2]=o("th",null,"BOTTOM",-1)),o("td",null,x(t(a)?J.value:""),1)],2),t(n)&&t(F)?(i(),u(he,{key:0},[t(l)?(i(),u("tr",ws,[w[3]||(w[3]=o("th",null,"YAHTZEE BONUS",-1)),o("td",null,x(t(l)),1)])):H("",!0),o("tr",ys,[w[4]||(w[4]=o("th",null,"TOTAL",-1)),o("td",null,[_(x(t(F))+" ",1),q.value&&M.value===1?(i(),u("span",bs," HIGHSCORE! ")):q.value?(i(),u("span",ks," LEADERBOARD IMPROVEMENT! ")):we.value?(i(),u("span",Hs," PERSONAL BEST! ")):H("",!0)])])],64)):H("",!0)])],2))}}),$s=fe(Es,[["__scopeId","data-v-9ebebb7c"]]),xs={class:"flex flex-wrap justify-center gap-3"},Os={key:3,class:"w-full flex flex-col md:flex-row gap-3 justify-center"},Ts={class:"w-full md:w-1/2 flex justify-center gap-3"},As={class:"w-full md:w-1/2 flex justify-center gap-3"},Cs={class:"mt-5 flex flex-col md:flex-row gap-3 justify-center"},Ds={key:2,class:"flex flex-wrap gap-3 mt-3 justify-center"},Gs=O({__name:"Yahtzee",setup(e){const s=Ae(),l=Y(),{reroll:a,dices:n,hasStarted:c,hasFinished:y,gameData:A,personalBest:P,finalScore:T}=R(l),{start:E,reset:B,roll:L,fetchHighscores:C,updateHighscores:F}=l,{firebaseUser:D}=R(ce()),V=U(!1),b=U(!1),z=()=>{b.value=!1,E()},G=()=>{var $;b.value=!1,B(($=D.value)==null?void 0:$.uid)};return($,r)=>(i(),d(ee,{class:"!bg-cyan-800 !bg-opacity-50 my-5 !rounded-secondary",title:"Yahtzee",description:"Play solo."},{right:m(()=>[f(k,{class:"border-none h-fit",type:"neutral",icon:"pi pi-cog",onClick:r[0]||(r[0]=h=>V.value=!0)})]),default:m(()=>[o("div",xs,[t(c)?H("",!0):(i(),d(k,{key:0,class:"w-full md:w-1/2",onClick:z},{default:m(()=>r[8]||(r[8]=[_(" Start ")])),_:1})),!t(c)&&!b.value?(i(),d(k,{key:1,class:"w-full md:w-1/2",type:"neutral",onClick:r[1]||(r[1]=h=>b.value=!0)},{default:m(()=>r[9]||(r[9]=[_(" View Highscores ")])),_:1})):t(c)?t(y)?H("",!0):(i(),u("div",Os,[o("div",Ts,[!t(y)&&t(a)<2?(i(),d(k,{key:0,class:"w-full",type:"tertiary",disabled:t(n).every(h=>h.selected),onClick:t(L)},{default:m(()=>[_(x(t(a)>=0?"Reroll":"Roll"),1)]),_:1},8,["disabled","onClick"])):H("",!0)]),o("div",As,[(i(!0),u(he,null,Ce(t(n),h=>(i(),d(fs,{dice:h},null,8,["dice"]))),256))])])):(i(),d(k,{key:2,class:"w-full md:w-1/2",type:"neutral",onClick:r[2]||(r[2]=h=>b.value=!1)},{default:m(()=>r[10]||(r[10]=[_(" Go Back ")])),_:1}))]),b.value?(i(),d(Ve,{key:0,"game-data":t(A),onFetchHighscores:t(C)},null,8,["game-data","onFetchHighscores"])):(i(),d($s,{key:1})),o("div",Cs,[t(c)&&!t(y)?(i(),d(k,{key:0,class:"w-full md:w-1/2",type:"neutral",onClick:G},{default:m(()=>r[11]||(r[11]=[_(" Restart ")])),_:1})):H("",!0),t(y)?(i(),d(k,{key:1,class:"w-full md:w-1/2",type:"secondary",onClick:G},{default:m(()=>r[12]||(r[12]=[_(" Play Again ")])),_:1})):H("",!0),t(y)&&!b.value?(i(),d(k,{key:2,class:"w-full md:w-1/2",type:"neutral",onClick:r[3]||(r[3]=h=>b.value=!0)},{default:m(()=>r[13]||(r[13]=[_(" View Highscores ")])),_:1})):t(y)?(i(),d(k,{key:3,class:"w-full md:w-1/2",type:"neutral",onClick:r[4]||(r[4]=h=>b.value=!1)},{default:m(()=>r[14]||(r[14]=[_(" View Your Score ")])),_:1})):H("",!0)]),t(y)?(i(),u("div",Ds,[t(D)?t(T)&&t(P)(t(D).uid)<t(T)?(i(),d(k,{key:1,class:"w-full md:w-1/2",type:"primary",onClick:r[6]||(r[6]=h=>t(F)(t(D).uid))},{default:m(()=>r[17]||(r[17]=[_(" Add To Leaderboard ")])),_:1})):H("",!0):(i(),d(ee,{key:0,class:"w-full md:w-1/2 bg-primary-500 bg-opacity-50 !rounded-primary"},{default:m(()=>[r[15]||(r[15]=_(" Please ")),o("a",{class:"cursor-pointer",onClick:r[5]||(r[5]=h=>t(s).push({name:t(De).LOGIN,params:{redirect:JSON.stringify({name:t(Se).GAMES_YAHTZEE})}}))}," Login "),r[16]||(r[16]=_(" to add your score to the leaderboard. "))]),_:1}))])):H("",!0),f(Pe,{"is-open":V.value,"onUpdate:isOpen":r[7]||(r[7]=h=>V.value=h)},null,8,["is-open"])]),_:1}))}});export{Gs as default};
